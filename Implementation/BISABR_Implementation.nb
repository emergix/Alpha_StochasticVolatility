(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    408575,      10763]
NotebookOptionsPosition[    395615,      10375]
NotebookOutlinePosition[    396140,      10399]
CellTagsIndexPosition[    396068,      10394]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/oliviercroissant/Documents/Math/NumericalIntegration.m\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438084708463805*^9, 3.438084723338635*^9}, 
   3.4380853908756237`*^9}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/oliviercroissant/Documents/Math/BS.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.438084743764517*^9, 3.4380853936989517`*^9}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/oliviercroissant/Documents/Math/SABR.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.4380847512765102`*^9, 3.438085396765018*^9}],

Cell[BoxData[
 RowBox[{"<<", " ", 
  "\"\</Users/oliviercroissant/Documents/Math/Heston_Definitif5.m\>\""}]], \
"Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380811045644245`*^9, 3.4380811183502607`*^9}, 
   3.438084760604393*^9, 3.438085401474907*^9}],

Cell[BoxData[
 RowBox[{"<<", "\"\<MultivariateStatistics`\>\""}]], "Input",
 InitializationCell->True,
 CellTags->"S6.6.1"],

Cell[BoxData[
 RowBox[{"<<", "\"\<ErrorBarPlots`\>\""}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Directory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.438084654820359*^9, 3.438084667410611*^9}}],

Cell[BoxData["\<\"/Users/oliviercroissant\"\>"], "Output",
 CellChangeTimes->{3.438084673418634*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Fonctions", " ", "utiles"}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Performs", " ", "the", " ", 
   RowBox[{"integral", " ", ":", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "x"], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], 
         SuperscriptBox["s", "2"]}], "-", 
        FractionBox[
         SuperscriptBox["b", "2"], 
         SuperscriptBox["s", "2"]]}]], 
      RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "=", 
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a", ",", "b", ",", "x"}], "]"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SqrtBox["\[Pi]"], 
            RowBox[{" ", 
             RowBox[{"4", "a"}]}]], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", " ", "2"}], "a", "  ", "b"}]], "  ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"4", "  ", "a", " ", "b"}]], "+", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"4", "  ", "a", " ", "b"}]], " ", 
                RowBox[{"Erf", "[", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], "]"}]}], "-", 
               RowBox[{"Erf", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{" ", "b"}], 
                  RowBox[{" ", "x"}]], "-", 
                 RowBox[{"a", " ", "x"}]}], "]"}]}], ")"}]}], ")"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "b"}], " ", 
              SqrtBox["\[Pi]"]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]}]], " ", "x"}], "+", 
             RowBox[{"b", " ", 
              SqrtBox["\[Pi]"], " ", 
              RowBox[{"Erf", "[", 
               FractionBox["b", "x"], "]"}]}]}], ")"}], "+", 
           RowBox[{
            FractionBox["1", "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", 
                  FractionBox[
                   SuperscriptBox["b", "2"], 
                   SuperscriptBox["x", "2"]]}]]}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["b", "3"], " ", 
                  SuperscriptBox["\[ExponentialE]", 
                   FractionBox[
                    SuperscriptBox["b", "2"], 
                    SuperscriptBox["x", "2"]]], " ", 
                  SqrtBox["\[Pi]"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", "x"}], "+", 
                 SuperscriptBox["x", "3"]}], ")"}]}], "+", 
              RowBox[{"2", 
               SuperscriptBox["b", "3"], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "2"]}], "+", 
           RowBox[{
            FractionBox["1", "30"], " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "4"], " ", "x"}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["b", "2"], " ", 
               SuperscriptBox["x", "3"]}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["x", "5"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["b", "5"], " ", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 SuperscriptBox["b", "2"], 
                 SuperscriptBox["x", "2"]]], " ", 
               SqrtBox["\[Pi]"], " ", 
               RowBox[{"Erf", "[", 
                FractionBox["b", "x"], "]"}]}]}], ")"}], " ", 
            SuperscriptBox["a", "4"]}]}], ")"}]}]}], "\[IndentingNewLine]", 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "If", " ", "we", " ", "use", " ", "the", " ", "No", " ", "function", " ", 
   "defined", " ", "by", "  ", 
   RowBox[{"No", "[", "x", "]"}]}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"Erf", "[", 
     FractionBox["x", 
      SqrtBox["2"]], "]"}]}], "+", 
   FractionBox["1", "2"]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"the", " ", "ATM", " ", "is", " ", "caracterized", " ", 
   RowBox[{"by", " ", ":", " ", "b1"}]}], "=", "0"}]], "Input"],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "GIntegralAnalytical", "  ", 
  "using", " ", "NormalCDF", " ", "function"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"GIntegralAnalytical1", "[", 
   RowBox[{"a1_", ",", "b1_", ",", "x1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"Abs", "[", "x1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"Abs", "[", "b1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Abs", "[", "a1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "a", "]"}], ">", "0.001"}], ",", 
        RowBox[{
         RowBox[{"Sign", "[", "x1", "]"}], 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", "a", " ", "b"}]], " ", 
           SqrtBox["\[Pi]"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"4", " ", "a", " ", "b"}]], "-", 
             RowBox[{"NormalCDF", "[", 
              RowBox[{
               SqrtBox["2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["b", "x"], "-", 
                 RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"4", " ", "a", " ", "b"}]], " ", 
              RowBox[{"NormalCDF", "[", 
               RowBox[{
                SqrtBox["2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["b", "x"], "+", 
                  RowBox[{"a", " ", "x"}]}], ")"}]}], "]"}]}]}], ")"}], " "}], 
          RowBox[{"2", " ", "a"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"Sign", "[", "x1", "]"}], "30"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["b", "2"], 
               SuperscriptBox["x", "2"]]}]], " ", "x", " ", 
            RowBox[{"(", 
             RowBox[{"30", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"]}], "-", 
                 SuperscriptBox["x", "2"]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["a", "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["b", "4"]}], "-", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["b", "2"], " ", 
                  SuperscriptBox["x", "2"]}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["x", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"4", " ", "b", " ", 
            RowBox[{"(", 
             RowBox[{"15", "+", 
              RowBox[{"10", " ", 
               SuperscriptBox["a", "2"], " ", 
               SuperscriptBox["b", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["a", "4"], " ", 
               SuperscriptBox["b", "4"]}]}], ")"}], " ", 
            SqrtBox["\[Pi]"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"NormalCDF", "[", 
               FractionBox[
                RowBox[{
                 SqrtBox["2"], " ", "b"}], "x"], "]"}]}], ")"}]}]}], 
          ")"}]}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Computes", "  ", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "A", "B"], 
   RowBox[{
    FractionBox[
     SuperscriptBox["r", "\[Gamma]"], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["r", 
        RowBox[{"2", " "}]], "-", " ", 
       RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
    RowBox[{"\[DifferentialD]", "r"}]}]}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", " ", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<A=\>\"", ",", "A", ",", "\"\< B=\>\"", ",", "B", ",", 
       "\"\< G=\>\"", ",", "G", ",", "\"\< F=\>\"", ",", "F", ",", 
       "\"\< \[Gamma]=\>\"", ",", "\[Gamma]", ",", "\"\< roots=\>\"", ",", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["r", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"r", " ", "G"}], " ", "+", "F"}], "\[Equal]", "0"}], ",", 
         "r"}], "]"}], ",", "\[IndentingNewLine]", "\"\< X1=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "A"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}], ",", 
       "\[IndentingNewLine]", "\"\< X2=\>\"", ",", 
       RowBox[{"AppellF1", "[", 
        RowBox[{
         RowBox[{"1", "+", "\[Gamma]"}], ",", 
         FractionBox["1", "2"], ",", 
         FractionBox["1", "2"], ",", 
         RowBox[{"2", "+", "\[Gamma]"}], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "-", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]], ",", 
         FractionBox[
          RowBox[{"2", " ", "B"}], 
          RowBox[{"G", "+", 
           SqrtBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", "F"}], "+", 
             SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SqrtBox["F"], "  ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Gamma]"}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["A", 
           RowBox[{"1", "+", "\[Gamma]"}]]}], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "A"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["B", 
          RowBox[{"1", "+", "\[Gamma]"}]], "  ", 
         RowBox[{"AppellF1", "[", 
          RowBox[{
           RowBox[{"1", "+", "\[Gamma]"}], ",", 
           FractionBox["1", "2"], ",", 
           FractionBox["1", "2"], ",", 
           RowBox[{"2", "+", "\[Gamma]"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "-", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]], ",", 
           FractionBox[
            RowBox[{"2", " ", "B"}], 
            RowBox[{"G", "+", 
             SqrtBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "4"}], " ", "F"}], "+", 
               SuperscriptBox["G", "2"]}]]}]]}], "]"}]}]}], ")"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegral", "[", 
   RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}], "}"}], ",", 
    RowBox[{"BiSABRIntegralN", "[", 
     RowBox[{
     "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", "legendrelst"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRIntegralN", "[", 
   RowBox[{
   "A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_", ",", 
    "legendrelst_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CoeffBasedIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         SuperscriptBox["#", "\[Gamma]"], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["#", 
            RowBox[{"2", " "}]], "-", " ", 
           RowBox[{"#", "G"}], " ", "+", "F"}]]], ")"}], "&"}], ",", 
      RowBox[{"LegendreCoeffsFromLegendre", "[", 
       RowBox[{"legendrelst", ",", "A", ",", "B"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "1.2"}], ",", 
     RowBox[{"B", "=", "3.5"}], ",", 
     RowBox[{"F", "=", "3.4"}], ",", 
     RowBox[{"G", "=", "0.9"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.54"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3668051250803241`", ",", 
   RowBox[{"1.3668051250802853`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\"\<A=\>\"", "\[InvisibleSpace]", "0.1445206290517883`", 
  "\[InvisibleSpace]", "\"\< B=\>\"", "\[InvisibleSpace]", 
  "0.14883523895735173`", "\[InvisibleSpace]", "\"\< G=\>\"", 
  "\[InvisibleSpace]", "0.24226344208464132`", "\[InvisibleSpace]", 
  "\"\< F=\>\"", "\[InvisibleSpace]", "0.022926396629179044`", 
  "\[InvisibleSpace]", "\"\< \[Gamma]=\>\"", "\[InvisibleSpace]", 
  "0.6666666666666667`", "\[InvisibleSpace]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Computation", " ", 
  RowBox[{"of", " ", ":"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BiSABRIntegralN", "[", 
      RowBox[{
      "A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]", ",", 
       "legendrelst"}], "]"}], ",", 
     RowBox[{"BiSABRIntegral", "[", 
      RowBox[{"A", ",", "B", ",", "G", ",", "F", ",", "\[Gamma]"}], "]"}]}], 
    "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"A=\"\>", "\[InvisibleSpace]", "0.1445206290517883`", 
   "\[InvisibleSpace]", "\<\" B=\"\>", "\[InvisibleSpace]", 
   "0.14883523895735173`", "\[InvisibleSpace]", "\<\" G=\"\>", 
   "\[InvisibleSpace]", "0.24226344208464132`", 
   "\[InvisibleSpace]", "\<\" F=\"\>", "\[InvisibleSpace]", 
   "0.022926396629179044`", "\[InvisibleSpace]", "\<\" \[Gamma]=\"\>", 
   "\[InvisibleSpace]", "0.6666666666666667`", 
   "\[InvisibleSpace]", "\<\" roots=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r$4102", "\[Rule]", 
       RowBox[{"0.12113172104232066`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.09084879078174048`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"r$4102", "\[Rule]", 
       RowBox[{"0.12113172104232066`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.09084879078174048`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], "\[InvisibleSpace]", "\<\" X1=\"\>", "\[InvisibleSpace]", 
   RowBox[{"1.5126423159212040549828694495`14.438555256080367", "+", 
    RowBox[{"0``14.258819010540044", " ", "\[ImaginaryI]"}]}], 
   "\[InvisibleSpace]", "\<\" X2=\"\>", "\[InvisibleSpace]", 
   RowBox[{"1.5170278437152437483256073212`14.075631890489461", "+", 
    RowBox[{"0``13.89463833853828", " ", "\[ImaginaryI]"}]}]}],
  SequenceForm[
  "A=", 0.1445206290517883, " B=", 0.14883523895735173`, " G=", 
   0.24226344208464132`, " F=", 0.022926396629179044`, " \[Gamma]=", 
   0.6666666666666667, 
   " roots=", {{
    r$4102 -> Complex[0.12113172104232066`, -0.09084879078174048]}, {
    r$4102 -> Complex[0.12113172104232066`, 0.09084879078174048]}}, " X1=", 
   Complex[1.5126423159212`14.438555256080367, 0``14.258819010540044], " X2=", 
   Complex[1.5170278437152`14.075631890489461, 0``13.89463833853828]],
  Editable->False]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.012714488324704634`", ",", 
   RowBox[{"0.012714488324704693`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "=", "\[InvisibleSpace]", "0.1445206290517883"}], ",", 
     RowBox[{"B", "=", "\[InvisibleSpace]", "0.14883523895735173"}], ",", 
     RowBox[{"F", "=", "\[InvisibleSpace]", "0.022926396629179044"}], ",", 
     RowBox[{"G", "=", "0.24226344208464132"}], ",", 
     RowBox[{"\[Gamma]", "=", "0.66666666666666674"}]}], "}"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "A", ",", "B"}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
-31.8768 220.734 -80.9721 27.5877 [
[.35036 .1233 -15 -9 ]
[.35036 .1233 15 0 ]
[.57109 .1233 -15 -9 ]
[.57109 .1233 15 0 ]
[.79182 .1233 -15 -9 ]
[.79182 .1233 15 0 ]
[.11712 .27374 -30 -4.5 ]
[.11712 .27374 0 4.5 ]
[.11712 .41168 -24 -4.5 ]
[.11712 .41168 0 4.5 ]
[.11712 .54962 -30 -4.5 ]
[.11712 .54962 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.35036 .1358 m
.35036 .14205 L
s
[(0.146)] .35036 .1233 0 1 Mshowa
.57109 .1358 m
.57109 .14205 L
s
[(0.147)] .57109 .1233 0 1 Mshowa
.79182 .1358 m
.79182 .14205 L
s
[(0.148)] .79182 .1233 0 1 Mshowa
.125 Mabswid
.17377 .1358 m
.17377 .13955 L
s
.21792 .1358 m
.21792 .13955 L
s
.26206 .1358 m
.26206 .13955 L
s
.30621 .1358 m
.30621 .13955 L
s
.3945 .1358 m
.3945 .13955 L
s
.43865 .1358 m
.43865 .13955 L
s
.4828 .1358 m
.4828 .13955 L
s
.52694 .1358 m
.52694 .13955 L
s
.61524 .1358 m
.61524 .13955 L
s
.65938 .1358 m
.65938 .13955 L
s
.70353 .1358 m
.70353 .13955 L
s
.74768 .1358 m
.74768 .13955 L
s
.08548 .1358 m
.08548 .13955 L
s
.04133 .1358 m
.04133 .13955 L
s
.83597 .1358 m
.83597 .13955 L
s
.88012 .1358 m
.88012 .13955 L
s
.92427 .1358 m
.92427 .13955 L
s
.96841 .1358 m
.96841 .13955 L
s
.25 Mabswid
0 .1358 m
1 .1358 L
s
.12962 .27374 m
.13587 .27374 L
s
[(2.945)] .11712 .27374 1 0 Mshowa
.12962 .41168 m
.13587 .41168 L
s
[(2.95)] .11712 .41168 1 0 Mshowa
.12962 .54962 m
.13587 .54962 L
s
[(2.955)] .11712 .54962 1 0 Mshowa
.125 Mabswid
.12962 .02545 m
.13337 .02545 L
s
.12962 .05304 m
.13337 .05304 L
s
.12962 .08063 m
.13337 .08063 L
s
.12962 .10822 m
.13337 .10822 L
s
.12962 .16339 m
.13337 .16339 L
s
.12962 .19098 m
.13337 .19098 L
s
.12962 .21857 m
.13337 .21857 L
s
.12962 .24615 m
.13337 .24615 L
s
.12962 .30133 m
.13337 .30133 L
s
.12962 .32892 m
.13337 .32892 L
s
.12962 .35651 m
.13337 .35651 L
s
.12962 .38409 m
.13337 .38409 L
s
.12962 .43927 m
.13337 .43927 L
s
.12962 .46686 m
.13337 .46686 L
s
.12962 .49444 m
.13337 .49444 L
s
.12962 .52203 m
.13337 .52203 L
s
.12962 .57721 m
.13337 .57721 L
s
.12962 .60479 m
.13337 .60479 L
s
.25 Mabswid
.12962 0 m
.12962 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .01472 m
.06244 .04227 L
.10458 .07197 L
.14415 .09951 L
.18221 .12569 L
.22272 .15323 L
.26171 .1794 L
.30316 .20688 L
.34309 .23301 L
.3815 .25783 L
.42237 .2839 L
.46172 .30868 L
.49955 .33219 L
.53984 .35691 L
.57861 .38038 L
.61984 .405 L
.65954 .42838 L
.69774 .45056 L
.73838 .47384 L
.77751 .49594 L
.81909 .51907 L
.85916 .54103 L
.89771 .56186 L
.93871 .58367 L
.97619 .60332 L
s
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzdmHtsFFUYxac7u3RbCzYWrQ+wLS2gCIIPgkrQWAP4QoJKNGgjBdSCEgit
IQTJRIg1qCFiCPGtRA2+lRARQ9QQfISoadSggfggGo0a9G/xn3XmTO/OmfPt
sJXEfyTl9vR3vu/e+92ZuXN353T39dy+vLtv6eLu1tmrulf2LF3c2zprxaoQ
+TWeV9Pqed6ORi/U93r+Ya9lbFDyfM8LSuHvv8L/3nGAWgJnqFkMSjnP4noC
p6p5AoFm5B+NcANks0aPIDBSzRMJNKnZiA4NPolAo5pNyDH4ZALD1TwFOcOT
Srjieo0+DXEG8xLWqjkKOQafSSCvZgtyDG4Lm0IMoj+9v6N2DEW5ItqDkj9o
V7pHXFjk5SMv7Ms7140Ztn5QKqANMzEN/BubEeHTEB0ZMTmQKW5UrmKim4Xe
fHk2cmS0HSujvBak2//1EJN07eICJmhHeVdIWJFXiOhgVWZIjvSPNbfMLifr
nLjc8doNLzFXFv7uGHIs6THVksrzpgsdymHUx7is61Ae1KuyOJUSchxkaqua
YZZ1GOY93j3rOVyFnLuTOwwPe8u7aiWe73nXfZH0H2rWkT6iZty5wQ2kf1Mz
3tqAw5/wHVMTxPt1xSHrM3TWg5UVn9XnUMb6r2OyePF4FqZ8B/x/l4TvppEo
90fF8Vv0sGJ+l36nZvwuNZjfpYeC8i4ymvBBzRmNEINbSH+tZivpA2q2oUOD
20l/qWa8Lxg8jvRAUs9ZaAc0+mzSn6k5ATkGTyS9X81JyDF4MumP1ZyCHIPP
J70vqeRCtPs0eirwXsXTSL+v5kXIMfgS0nvUnI4cg2eQ3q3mpcjZndRwOdpd
GtdJeqeaVyDH4Jmk31JzFnIMvpL065GZxxvFp7dOgU5R/Ea9CsQllTEf0zPP
OPyivYb0K1FggUCdG7yQHiWe2rWYApJ4ZrU6bPkP31RxHentrpZyfFGSK54U
eL5zMcD2wTLit7JPp1I/Xd480i/otbkeSQbfSHqbmvORY/BNwM8mt90CMp/S
6AUIMfhW0o+r2YUcg28jvVXNhcgxeBHwFsVLSG9OKrkD7WaNvpP0JjV7kGPw
MtIPqXkXcgxeDrxR8QrS/WquRE5/UkMvmRs0uhchBt8DfJ/i1cCB4jXA6xSv
BV6reB3wGsUB8Opk3uvJ7NPo9eka0uaGct0pfH96ldJmv6xv9GzJXpU3z/cD
IC48tUsN5aPHRtJ3R5G8vdWZ5zmexYMYE+F8qEttS3YnehhkmZtplT0oSO87
m5DcMzjD8r5jd5xH3EOTXttHgZco3gK8SPFW4IWKHyPdldwlT6Dt0ugngW9R
/DTpm9V8BjkGP0d6vprbkGPw88A3KH4ReF4y+5fQztW4l4HnKH6V9NVqvoYc
g98gPVvNN5Fj8A7gmYp3ku5MangbbadG7yJ9mZrvIMfgd4FnKN4DPF3xe8AX
K/4AeJrivcBTk3l/iPYCjfsI+DzFnwCbz9T7gc23Kp8Cn6P4c+DoMFzhKJSn
r5j40R1wH9vtUSjjq4rsHecL9BVNqcJBqJCRFE/vK6RGHxWyj0N+RgkHQNpc
CdV3n6yd6Bt01BLICcjP2I8Okh6lF+MQOjD4W+DTFX9PulnNH5DjcPxJMhd/
Q5uK+wm4SfHPpBvV/AU5Bv8KPELx78ANio+4xUrjP4GLybyPasQQv4/3av4B
tanVAA==\
\>"],
 ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {0.144407, 2.93508, 1.58243, \
0.000126613}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}]}]}]}]}], "  ", ";", 
   RowBox[{"b1", "=", 
    RowBox[{
     SuperscriptBox["C", "\[Prime]",
      MultilineFunction->None], "[", "f", "]"}]}], ";", 
   RowBox[{"b2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["C", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "f", "]"}], 
      RowBox[{"C", "[", "f", "]"}]}], "+", 
     SuperscriptBox["b1", "2"]}]}], ";", 
   RowBox[{"B0B\[Alpha]z", "=", 
    RowBox[{
     RowBox[{"C", "[", "K", "]"}], 
     RowBox[{"C", "[", "f", "]"}]}]}]}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData["with"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"C", "[", "f", "]"}], "=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{"A_", ",", "B_", ",", "G_", ",", "F_", ",", "\[Gamma]_"}], "]"}], 
   "  ", "computes", "  ", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "A", "B"], 
    RowBox[{
     FractionBox[
      SuperscriptBox["r", "\[Gamma]"], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["r", 
         RowBox[{"2", " "}]], "-", " ", 
        RowBox[{"r", " ", "G"}], " ", "+", "F"}]]], 
     RowBox[{"\[DifferentialD]", "r"}]}]}]}], " ", ";", "  ", 
  RowBox[{"so", " ", "..."}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegral", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"]}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRz", "[", 
   RowBox[{
   "K_", ",", "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", 
    "\[Rho]s_", ",", "\[Beta]1_", ",", "\[Beta]2_", ",", "legendrelst_"}], 
   "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"\[Alpha]1", " ", "\[Beta]1"}]], 
   RowBox[{"BiSABRIntegralN", "[", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"K", "+", "F2"}], ")"}], "\[Beta]1"], ",", 
     SuperscriptBox[
      RowBox[{"(", "F1", ")"}], "\[Beta]1"], ",", 
     FractionBox[
      RowBox[{"2", "  ", 
       SuperscriptBox["F2", "\[Beta]2"], "  ", "\[Alpha]2", " ", "\[Rho]s"}], 
      "\[Alpha]1"], ",", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["\[Alpha]2", "\[Alpha]1"], ")"}], "2"]}], ",", 
     FractionBox[
      RowBox[{"1", "-", "\[Beta]1"}], "\[Beta]1"], ",", "legendrelst"}], 
    "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[""], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"BiSABRz", "[", 
    RowBox[{
    "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
     "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"0.15062489716382582`", "\[InvisibleSpace]", "-", 
  RowBox[{"2.425990932423949`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Csabr", "[", 
   RowBox[{
   "f_", ",", "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "F2_", ",", 
    "\[Alpha]2_", ",", "\[Beta]2_", ",", "\[Rho]s_"}], "]"}], ":=", 
  FractionBox[
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", "+", "F2"}], ")"}], "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]], 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["F1", 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["F2", 
       RowBox[{"2", " ", "\[Beta]2"}]], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["F1", "\[Beta]1"], " ", 
      SuperscriptBox["F2", "\[Beta]2"], " ", "\[Alpha]1", " ", "\[Alpha]2", 
      " ", "\[Rho]s"}]}]]]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"K", "=", 
      RowBox[{"-", "0.1"}]}], ",", 
     RowBox[{"F1", "=", "0.0418"}], ",", 
     RowBox[{"F2", "=", "0.00728"}], ",", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", 
     RowBox[{"\[Alpha]2", "=", "0.041402972188513"}], ",", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "f"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Csabr", "[", 
        RowBox[{
        "fx", ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "F2", ",", 
         "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]s"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"fx", ",", 
        RowBox[{"K", "-", "0.01"}], ",", "f"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "::", "\<\"plnr\"\>"}], ":", 
  " ", "\<\"\\!\\(1\\/\\(Csabr[\\(\\(fx, F1$3792295, \[Alpha]1$3792295, \
\[Beta]1$3792295, F2$3792295, \[Alpha]2$3792295, \[Beta]2$3792295, \
\[Rho]s$3792295\\)\\)]\\)\\) is not a machine-size real number at \\!\\(fx\\) \
= \\!\\(-0.10999999397833334`\\). \\!\\(\\*ButtonBox[\\\"Plus\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot::plnr\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "::", "\<\"plnr\"\>"}], ":", 
  " ", "\<\"\\!\\(1\\/\\(Csabr[\\(\\(fx, F1$3792295, \[Alpha]1$3792295, \
\[Beta]1$3792295, F2$3792295, \[Alpha]2$3792295, \[Beta]2$3792295, \
\[Rho]s$3792295\\)\\)]\\)\\) is not a machine-size real number at \\!\\(fx\\) \
= \\!\\(-0.10413725837788222`\\). \\!\\(\\*ButtonBox[\\\"Plus\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot::plnr\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot", "::", "\<\"plnr\"\>"}], ":", 
  " ", "\<\"\\!\\(1\\/\\(Csabr[\\(\\(fx, F1$3792295, \[Alpha]1$3792295, \
\[Beta]1$3792295, F2$3792295, \[Alpha]2$3792295, \[Beta]2$3792295, \
\[Rho]s$3792295\\)\\)]\\)\\) is not a machine-size real number at \\!\\(fx\\) \
= \\!\\(-0.09774343224432332`\\). \\!\\(\\*ButtonBox[\\\"Plus\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot::plnr\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], ":", 
  " ", "\<\"Further output of \\!\\(Plot :: \\\"plnr\\\"\\) will be \
suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"Plus\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.186866 22.8657 0.0147151 0.0837909 [
[.41552 .00222 -12 -9 ]
[.41552 .00222 12 0 ]
[.64418 .00222 -12 -9 ]
[.64418 .00222 12 0 ]
[.87284 .00222 -12 -9 ]
[.87284 .00222 12 0 ]
[.17437 .09851 -6 -4.5 ]
[.17437 .09851 0 4.5 ]
[.17437 .1823 -6 -4.5 ]
[.17437 .1823 0 4.5 ]
[.17437 .26609 -6 -4.5 ]
[.17437 .26609 0 4.5 ]
[.17437 .34988 -6 -4.5 ]
[.17437 .34988 0 4.5 ]
[.17437 .43367 -6 -4.5 ]
[.17437 .43367 0 4.5 ]
[.17437 .51746 -6 -4.5 ]
[.17437 .51746 0 4.5 ]
[.17437 .60125 -6 -4.5 ]
[.17437 .60125 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.41552 .01472 m
.41552 .02097 L
s
[(0.01)] .41552 .00222 0 1 Mshowa
.64418 .01472 m
.64418 .02097 L
s
[(0.02)] .64418 .00222 0 1 Mshowa
.87284 .01472 m
.87284 .02097 L
s
[(0.03)] .87284 .00222 0 1 Mshowa
.125 Mabswid
.2326 .01472 m
.2326 .01847 L
s
.27833 .01472 m
.27833 .01847 L
s
.32406 .01472 m
.32406 .01847 L
s
.36979 .01472 m
.36979 .01847 L
s
.46125 .01472 m
.46125 .01847 L
s
.50699 .01472 m
.50699 .01847 L
s
.55272 .01472 m
.55272 .01847 L
s
.59845 .01472 m
.59845 .01847 L
s
.68991 .01472 m
.68991 .01847 L
s
.73564 .01472 m
.73564 .01847 L
s
.78137 .01472 m
.78137 .01847 L
s
.82711 .01472 m
.82711 .01847 L
s
.14113 .01472 m
.14113 .01847 L
s
.0954 .01472 m
.0954 .01847 L
s
.04967 .01472 m
.04967 .01847 L
s
.00394 .01472 m
.00394 .01847 L
s
.91857 .01472 m
.91857 .01847 L
s
.9643 .01472 m
.9643 .01847 L
s
.25 Mabswid
0 .01472 m
1 .01472 L
s
.18687 .09851 m
.19312 .09851 L
s
[(1)] .17437 .09851 1 0 Mshowa
.18687 .1823 m
.19312 .1823 L
s
[(2)] .17437 .1823 1 0 Mshowa
.18687 .26609 m
.19312 .26609 L
s
[(3)] .17437 .26609 1 0 Mshowa
.18687 .34988 m
.19312 .34988 L
s
[(4)] .17437 .34988 1 0 Mshowa
.18687 .43367 m
.19312 .43367 L
s
[(5)] .17437 .43367 1 0 Mshowa
.18687 .51746 m
.19312 .51746 L
s
[(6)] .17437 .51746 1 0 Mshowa
.18687 .60125 m
.19312 .60125 L
s
[(7)] .17437 .60125 1 0 Mshowa
.125 Mabswid
.18687 .03147 m
.19062 .03147 L
s
.18687 .04823 m
.19062 .04823 L
s
.18687 .06499 m
.19062 .06499 L
s
.18687 .08175 m
.19062 .08175 L
s
.18687 .11526 m
.19062 .11526 L
s
.18687 .13202 m
.19062 .13202 L
s
.18687 .14878 m
.19062 .14878 L
s
.18687 .16554 m
.19062 .16554 L
s
.18687 .19906 m
.19062 .19906 L
s
.18687 .21581 m
.19062 .21581 L
s
.18687 .23257 m
.19062 .23257 L
s
.18687 .24933 m
.19062 .24933 L
s
.18687 .28285 m
.19062 .28285 L
s
.18687 .2996 m
.19062 .2996 L
s
.18687 .31636 m
.19062 .31636 L
s
.18687 .33312 m
.19062 .33312 L
s
.18687 .36664 m
.19062 .36664 L
s
.18687 .3834 m
.19062 .3834 L
s
.18687 .40015 m
.19062 .40015 L
s
.18687 .41691 m
.19062 .41691 L
s
.18687 .45043 m
.19062 .45043 L
s
.18687 .46719 m
.19062 .46719 L
s
.18687 .48394 m
.19062 .48394 L
s
.18687 .5007 m
.19062 .5007 L
s
.18687 .53422 m
.19062 .53422 L
s
.18687 .55098 m
.19062 .55098 L
s
.18687 .56774 m
.19062 .56774 L
s
.18687 .58449 m
.19062 .58449 L
s
.18687 .61801 m
.19062 .61801 L
s
.25 Mabswid
.18687 0 m
.18687 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .41299 m
.02831 .45176 L
.03775 .51499 L
.04317 .54394 L
.0481 .56563 L
.0527 .58152 L
.05706 .59258 L
.05945 .59697 L
.06166 .60001 L
.06408 .60221 L
.06666 .60332 L
.07091 .60253 L
.07489 .59913 L
.07927 .59284 L
.08398 .58361 L
.11601 .49239 L
.15105 .40076 L
.18555 .33648 L
.20437 .30979 L
.22188 .2889 L
.25304 .2588 L
.28682 .23357 L
.32333 .21228 L
.3578 .19619 L
.4223 .17312 L
.49126 .15509 L
.56428 .14069 L
.69574 .12214 L
.76322 .11498 L
.83571 .1085 L
.97619 .09851 L
s
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzVWc9LVUEUvvp8PvO3lmla9ixCMyorC6yoTeQiok1Qm4iXFLqwxKRNtAii
TS1aBLVo0aIIgqCIIiKECqLAyH6A/QZT/w57M07njuN35s1c3/OZyNzhm+98
M3PmzNwz9x1MDfWe7E8N9fWkkt2DqYHevp6zyf1nBtNQrCAICpJBEDxKBqI+
na6qYjr9P90iiiA4LR6FAi4CtZioxUWtLTOvSNTarbywprrvlw9pKWsSDIIS
DEvzdGc63OqlUAgU2iMozIGT+ZlPDCisn/cYVudnMkihzUshDhSa8xlpc2C/
xbEHW7h3S8EOa7e2brC2qt2pHxQ7gUcmctSUEA8509rQOeox22AJwErzxFtM
Y1lMvCp+vXc5YrsB1jbv4JOhPpnL8M59D//59LaIh0ww0ImrSNtAUxS6HO4H
UUuIWqWf+itRlgukzs/wiSgrBKKO0q00mGJAvyvKaoFsMl19Q9SqRG0P79mr
oiwVyEGedEmUJQI5wpMukKuO86RzRDplDneAmvp5+14iDfGkE6IsFsh5nnSM
YukiTzpKpMvmcA9T0xXe/pAo5Qv5Gk86QKTrPKmbSDfNkeyjplu8/V4i3eZJ
8uCU0B1tw0krlCt1Ef2eRjdIKGh3kOF9LcYNUpwm2En0B357qYMMH+oDdEoE
N5LtY5d9GGZIT831CVOrZ7zrW4n0nCetI9ILnrSWSMM8aQ3Ahs2Bt1DtJa/U
TKTXPGkVwCz0JtJ8Y46pkWpvefsGgFno9QB7x9PraAgjPGkZwEbMySDSe16z
hgxHeVI1wEZdIrgKYB+9t00lwD7NGNjftMjw84xhJ2hCV9lygH3xnkF4wxlz
cRvKa8fMhUakr/waJgD2jaejYX3n6WjSP3g6Olh/mhNEpF+8Jvqw8lunx2c1
qdUKxnXKnMX8Yw5KBck/2jgej/izpqk+eavO7SJgStsA0tacv0bqVBGA5m9Q
w3RY+V+z0QfCBD/zuWBKi3ptHfQn2nx6Oo28j5Zc2Wx3jJBMdH3OrmfGRCR6
tu4YmG7PhiYzkCxXJ4dzIxq9AzQlzBGzJKy5GTShjzrR6BWgqRlg6OSOIqE7
Ikd9oyQr3BeW1ePF8DGM9qZlsyD5lY7RGzN9h9KEJquhZeJeYu57Dck2Akwe
ARLKghhKfiwSKwBW4eJs1jALfWMJlJiilB11FUVC9wAyXA4wxLP0vTgk6gCG
rg9KAjWhG0y16URkuBRgNX59Lw6JWkcsioTuRDQshFn6RnQ0HnkDkpDl7PQS
c7t5ZVE5k+fQdiiLOm0kho5jzzmzspleGSgE0PmK9n8UCd3ZC923uwRaEXSI
Kgl0NJRxEroHvAzd+0a/laFXmJJABzPKJxdeAiXlDaYTvQxx3yg80HXDUwKd
DSihiSKhewAZoj2PckHVN4owdO30lEDZMFovyw23Xk1Hb5INQQDDKZOUfAmg
hQy/L0b7LuDx3VC3YH8y4b4VBQV/AcE8knU=\
\>"],
 ImageRangeCache->{{{0, 287}, {176.938, 0}} -> {-0.00931839, -0.543026, \
0.000160368, 0.0437629}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Definition", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"l", "=", "0"}], "\[Infinity]"], 
     FractionBox[
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"a", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "1"], ",", "k"}], "]"}], " ", 
       RowBox[{"Pochhammer", "[", 
        RowBox[{
         SubscriptBox["b", "2"], ",", "l"}], "]"}], " ", 
       SubsuperscriptBox["z", "1", "k"], " ", 
       SubsuperscriptBox["z", "2", "l"]}], 
      RowBox[{
       RowBox[{"Pochhammer", "[", 
        RowBox[{"c", ",", 
         RowBox[{"k", "+", "l"}]}], "]"}], " ", 
       RowBox[{"k", "!"}], " ", 
       RowBox[{"l", "!"}]}]]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]]],

Cell[BoxData[
 RowBox[{"low", " ", "order", " ", "development"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["z", "1"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "2"]}], "c"], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      SubscriptBox["z", "1"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubscriptBox["z", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubscriptBox["z", "1"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"2", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "a"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "a"}], ")"}], " ", 
      SubscriptBox["b", "1"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "1"]}], ")"}], " ", 
      SubscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["b", "2"]}], ")"}], " ", 
      SubsuperscriptBox["z", "1", "2"], " ", 
      SubsuperscriptBox["z", "2", "2"]}], 
     RowBox[{"4", " ", "c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", "c"}], ")"}]}]], "+", "\[Ellipsis]"}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "1"], "]"}], "<", "1"}], "\[And]", 
   RowBox[{
    RowBox[{"Abs", "[", 
     SubscriptBox["z", "2"], "]"}], "<", "1"}]}]}]]],

Cell[BoxData[
 RowBox[{"general", " ", "development"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{"Gamma", "[", "c", "]"}], 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}], 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "2"], "]"}]}]}]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"k", "=", "0"}], "\[Infinity]"], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"j", "=", "0"}], "\[Infinity]"], 
     RowBox[{"Residue", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"a", "-", "s", "-", "t"}], "]"}], 
          RowBox[{"Gamma", "[", "s", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "1"], "-", "s"}], "]"}], " ", 
          RowBox[{"Gamma", "[", "t", "]"}], 
          RowBox[{"Gamma", "[", 
           RowBox[{
            SubscriptBox["b", "2"], "-", "t"}], "]"}]}], 
         RowBox[{"Gamma", "[", 
          RowBox[{"c", "-", "s", "-", "t"}], "]"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "1"]}], ")"}], 
         RowBox[{"-", "s"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           SubscriptBox["z", "2"]}], ")"}], 
         RowBox[{"-", "t"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{"-", "j"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"-", "k"}]}], "}"}]}], "]"}]}]}]}]}]]],

Cell[BoxData[
 RowBox[{"Integral", " ", "representation"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], " "}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}]}]], 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{
       SuperscriptBox["t", 
        RowBox[{"a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "t"}], ")"}], 
        RowBox[{"c", "-", "a", "-", "1"}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "1"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "1"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"t", " ", 
           SubscriptBox["z", "2"]}]}], ")"}], 
        RowBox[{"-", 
         SubscriptBox["b", "2"]}]]}], 
      RowBox[{"\[DifferentialD]", "t"}]}]}]}]}], "/;", 
  RowBox[{
   RowBox[{
    RowBox[{"Re", "[", "a", "]"}], ">", "0"}], "\[And]", 
   RowBox[{
    RowBox[{"Re", "[", 
     RowBox[{"c", "-", "a"}], "]"}], ">", "0"}]}]}]]],

Cell[BoxData[
 RowBox[{"Differential", " ", "equation", " ", "followed"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "1"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "1"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "1"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "1"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}], "\[And]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       SubscriptBox["z", "2"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["z", "2"], ",", "2"}], "}"}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       SubscriptBox["z", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["z", "2"]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{
       SubscriptBox["b", "2"], " ", 
       SubscriptBox["z", "1"], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "1"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", 
            SubscriptBox["b", "2"], "+", "1"}], ")"}], " ", 
          SubscriptBox["z", "2"]}]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["\[PartialD]", 
         SubscriptBox["z", "2"]], 
        RowBox[{"w", "[", 
         RowBox[{
          SubscriptBox["z", "1"], ",", 
          SubscriptBox["z", "2"]}], "]"}]}]}], "-", 
      RowBox[{"a", " ", 
       SubscriptBox["b", "2"], 
       RowBox[{"w", "[", 
        RowBox[{
         SubscriptBox["z", "1"], ",", 
         SubscriptBox["z", "2"]}], "]"}]}]}], "\[Equal]", "0"}]}], ")"}], "/;",
   " ", 
  RowBox[{
   RowBox[{"w", "[", 
    RowBox[{
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]]],

Cell[BoxData[
 RowBox[{"Integral", " ", "and", " ", "differential"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Integral]", 
   RowBox[{
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      RowBox[{"\[ScriptA]", " ", 
       SubscriptBox["z", "1"]}], ",", 
      SubscriptBox["z", "2"]}], "]"}], 
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["z", 
      RowBox[{" ", "1"}]]}]}]}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "-", "1"}], ")"}], " "}], 
    RowBox[{"\[ScriptA]", 
     RowBox[{"(", 
      RowBox[{"a", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["b", "1"], "-", "1"}], ")"}]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"a", "-", "1"}], ",", 
     RowBox[{
      SubscriptBox["b", "1"], "-", "1"}], ",", 
     SubscriptBox["b", "2"], ",", 
     RowBox[{"c", "-", "1"}], ",", 
     RowBox[{"\[ScriptA]", " ", 
      SubscriptBox["z", "1"]}], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["\[PartialD]", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["z", "1"], ",", "n"}], "}"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}], "\[Equal]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Pochhammer", "[", 
       RowBox[{"a", ",", "n"}], "]"}], " ", 
      RowBox[{"Pochhammer", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", "n"}], "]"}]}], 
     RowBox[{"Pochhammer", "[", 
      RowBox[{"c", ",", "n"}], "]"}]], " ", 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"a", "+", "n"}], ",", 
      RowBox[{
       SubscriptBox["b", "1"], "+", "n"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"c", "+", "n"}], ",", 
      SubscriptBox["z", "1"], ",", 
      SubscriptBox["z", "2"]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"n", "\[Element]", "Integers"}], "\[And]", 
   RowBox[{"n", ">", "0"}]}]}]]],

Cell[BoxData[
 RowBox[{"Formule", " ", "asymptotiques"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"Gamma", "[", "c", "]"}], 
     RowBox[{"Gamma", "[", "a", "]"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"k", "=", "0"}], "\[Infinity]"], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"Gamma", "[", 
         RowBox[{"a", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}], 
        RowBox[{"Pochhammer", "[", 
         RowBox[{
          SubscriptBox["b", "2"], ",", "k"}], "]"}]}], 
       RowBox[{
        RowBox[{"k", "!"}], " ", 
        RowBox[{"Gamma", "[", 
         RowBox[{"c", "-", 
          SubscriptBox["b", "1"], "+", "k"}], "]"}]}]], " ", 
      RowBox[{"Hypergeometric2F1", "[", 
       RowBox[{
        SubscriptBox["b", "1"], ",", 
        RowBox[{"1", "-", "c", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        RowBox[{"1", "-", "a", "+", 
         SubscriptBox["b", "1"], "-", "k"}], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}], " ", 
      SubsuperscriptBox["z", "2", "k"]}]}]}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{
        SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", "a"}], "]"}], " ", 
      RowBox[{"Gamma", "[", 
       SubscriptBox["b", "1"], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "2"], ",", 
      RowBox[{"1", "+", "a", "-", "c"}], ",", 
      RowBox[{"1", "+", "a", "-", 
       SubscriptBox["b", "1"]}], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       SubscriptBox["z", "1"]], ",", 
      FractionBox["1", 
       SubscriptBox["z", "1"]]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"Gamma", "[", "c", "]"}], 
      RowBox[{"Gamma", "[", 
       RowBox[{"a", "-", 
        SubscriptBox["b", "1"]}], "]"}]}], 
     RowBox[{
      RowBox[{"Gamma", "[", "a", "]"}], " ", 
      RowBox[{"Gamma", "[", 
       RowBox[{"c", "-", 
        SubscriptBox["b", "1"]}], "]"}]}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"a", "-", 
            SubscriptBox["b", "1"]}], ")"}], "2"], 
         SubscriptBox["b", "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c", "-", 
           SubscriptBox["b", "1"]}], ")"}], "2"]], 
       SubscriptBox["z", "2"], 
       RowBox[{"HypergeometricPFQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", 
             RowBox[{
              SubscriptBox["b", "2"], "+", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["b", "1"], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "1"}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "-", 
              SubscriptBox["b", "1"], "+", "1"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c", "-", 
             SubscriptBox["b", "1"], "+", "1"}], "}"}]}], "}"}], ",", 
         FractionBox[
          SubscriptBox["z", "2"], 
          SubscriptBox["z", "1"]], ",", 
         SubscriptBox["z", "2"]}], "]"}]}], "+", 
      RowBox[{"HypergeometricPFQ", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           SubscriptBox["b", "1"], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["b", "2"], ",", 
            RowBox[{"a", "-", 
             SubscriptBox["b", "1"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "c", "+", 
             SubscriptBox["b", "1"]}], ",", "1"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"c", "-", 
            SubscriptBox["b", "1"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", "-", "a", "+", 
            SubscriptBox["b", "1"]}], "}"}]}], "}"}], ",", 
        FractionBox[
         SubscriptBox["z", "2"], 
         SubscriptBox["z", "1"]], ",", 
        FractionBox["1", 
         SubscriptBox["z", "1"]]}], "]"}]}], ")"}]}]}]}]]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Proportional]", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{
         SubscriptBox["b", "1"], "-", "a"}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", "a"}], "]"}], " ", 
       RowBox[{"Gamma", "[", 
        SubscriptBox["b", "1"], "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", "a"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"Gamma", "[", "c", "]"}], 
       RowBox[{"Gamma", "[", 
        RowBox[{"a", "-", 
         SubscriptBox["b", "1"]}], "]"}]}], 
      RowBox[{
       RowBox[{"Gamma", "[", 
        RowBox[{"c", "-", 
         SubscriptBox["b", "1"]}], "]"}], 
       RowBox[{"Gamma", "[", "a", "]"}]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", 
        SubscriptBox["z", "1"]}], ")"}], 
      RowBox[{"-", 
       SubscriptBox["b", "1"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"O", "[", 
        FractionBox["1", 
         SubscriptBox["z", "1"]], "]"}]}], ")"}]}]}]}], "/;", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Abs", "[", 
      SubscriptBox["z", "1"], "]"}], "\[Rule]", "\[Infinity]"}], ")"}], 
   "\[And]", 
   RowBox[{"a", "\[NotEqual]", "b"}]}]}]]],

Cell[BoxData[
 RowBox[{"Implementation", " ", "of", " ", "AppellF1"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "x_", ",", "y_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "j", ",", "sumtotale", ",", "currentterm", ",", "firstTerm", 
      ",", "amnfirst", ",", "nx", ",", "cmnfirst", ",", "my", ",", "amn", ",",
       "cmn", ",", "b1n", ",", "b2m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"currentterm", "=", "1"}], ";", 
     RowBox[{"nx", "=", "1"}], ";", 
     RowBox[{"my", "=", "1"}], ";", 
     RowBox[{"b2m", "=", "b2"}], ";", 
     RowBox[{"firstTerm", "=", "1"}], ";", 
     RowBox[{"b1n", "=", "b1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sumtotale", "=", "0"}], ";", 
     RowBox[{"amnfirst", "=", "a"}], ";", 
     RowBox[{"cmnfirst", "=", "c"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"currentterm", "=", "firstTerm"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b2m", "=", "b2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"amn", "=", "amnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cmn", "=", "cmnfirst"}], ";", "\[IndentingNewLine]", 
        RowBox[{"my", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sumtotale", "+=", "currentterm"}], ";", 
           RowBox[{"currentterm", "*=", 
            RowBox[{"amn", " ", "b2m", " ", 
             RowBox[{
              RowBox[{"y", "/", "cmn"}], "/", "my"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<i=\>\"", ",", "i", ",", "\"\< j=\>\"", ",", "j", ",", 
               "\"\< currentterm=\>\"", ",", "currentterm", ",", 
               "\"\< sumtotal=\>\"", ",", "sumtotale"}], "]"}], ";"}], 
            "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"amn", "++"}], ";", 
           RowBox[{"b2m", "++"}], ";", 
           RowBox[{"cmn", "++"}], ";", 
           RowBox[{"my", "++"}], ";"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"firstTerm", "*=", 
         RowBox[{"x", " ", "amnfirst", " ", 
          RowBox[{
           RowBox[{"b1n", "/", "cmnfirst"}], "/", "nx"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"amnfirst", "++"}], ";", 
        RowBox[{"cmnfirst", "++"}], ";", 
        RowBox[{"b1n", "++"}], ";", 
        RowBox[{"nx", "++"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Nb"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "sumtotale"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version1", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", "b1", ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version2", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{"z1", "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version3", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "a"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{"a", ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z2", "-", "z1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", 
       RowBox[{"z2", "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version4", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", "z1", 
       ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z2", "-", "1"}], ")"}]}], ",", "Nb"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HypergeometricAppellF1Version5", "[", 
   RowBox[{
   "a_", ",", "b1_", ",", "b2_", ",", "c_", ",", "z1_", ",", "z2_", ",", 
    "Nb_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z1"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"-", "b1"}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "z2"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"c", "-", "a", "-", "b2"}], ")"}]}], 
     RowBox[{"HypergeometricAppellF1", "[", 
      RowBox[{
       RowBox[{"c", "-", "a"}], ",", 
       RowBox[{"c", "-", "b1", "-", "b2"}], ",", "b2", ",", "c", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", "z2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"z1", "-", "1"}], ")"}]}], ",", "z2", ",", "Nb"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "1.4285714285714"}], ",", 
     RowBox[{"b1", "=", "0.5"}], ",", 
     RowBox[{"b2", "=", "0.5"}], ",", 
     RowBox[{"c", "=", "2.4285714285714"}], ",", 
     RowBox[{"z1", "=", 
      RowBox[{"1.1737504870683", "+", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"z2", "=", 
      RowBox[{"1.1737504870683", "-", 
       RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ",", 
     RowBox[{"Nb", "=", "150"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"HypergeometricAppellF1Version1", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version2", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version3", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", ",", 
     RowBox[{"HypergeometricAppellF1Version4", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"HypergeometricAppellF1Version5", "[", 
      RowBox[{
      "a", ",", "b1", ",", "b2", ",", "c", ",", "z1", ",", "z2", ",", "Nb"}], 
      "]"}]}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"8.191250777003514`*^57", "+", 
    RowBox[{"6.96898287454082`*^41", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.5984880191933416`*^72", "+", 
    RowBox[{"1.4386102719719762`*^71", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"6.618253165535394`*^72", "-", 
    RowBox[{"1.8268625400817602`*^71", " ", "\[ImaginaryI]"}]}], ",", "Null", 
   ",", 
   RowBox[{
    RowBox[{"-", "5.768091527866253`*^63"}], "-", 
    RowBox[{"4.678396843370144`*^64", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "1.8415401009704138`*^64"}], "-", 
    RowBox[{"1.3862699191173578`*^65", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"HypergeometricAppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", "x", ",", "y", ",", "4"}], "]"}], 
   ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"a", " ", "y", " ", 
    SubscriptBox["b", "2"]}], "c"], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "2"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"2", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "a"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "a"}], ")"}], " ", 
    SuperscriptBox["y", "3"], " ", 
    SubscriptBox["b", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["b", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      SubscriptBox["b", "2"]}], ")"}]}], 
   RowBox[{"6", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       SubscriptBox["b", "1"]}], "c"], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"2", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"4", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", "y", " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"]}], 
      RowBox[{"6", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "2"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"12", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}]}]], "+", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "a"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "a"}], ")"}], " ", 
       SuperscriptBox["y", "3"], " ", 
       SubscriptBox["b", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "1"]}], ")"}], " ", 
       SubscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["b", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SubscriptBox["b", "2"]}], ")"}]}], 
      RowBox[{"36", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"5", "+", "c"}], ")"}]}]]}], ")"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
HypergeometricAppellF1[1.4285714285714,0.50000000000000,0.50000000000000,2.\
4285714285714,
1.1737504870683+\[ImaginaryI] 0.88031286530120,1.1737504870683-\[ImaginaryI] \\
0.88031286530120,150]\
\>", "Input"],

Cell[BoxData[
 RowBox[{"1.1184639606115216`*^45", "+", 
  RowBox[{"3.1691265005705735`*^30", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
AppellF1[1.1,2.09,3.7,4.12,0.19-0.5 \[ImaginaryI],0.9]\
\>", "Input"],

Cell[BoxData[
 RowBox[{"6.616499213883773`", "\[InvisibleSpace]", "-", 
  RowBox[{"5.8714598634635795`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AppellF1", "[", 
  RowBox[{
  "1.4285714285714", ",", "0.50000000000000", ",", "0.50000000000000", ",", 
   "2.4285714285714", ",", "\[IndentingNewLine]", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}], ",", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"1.4301741471254665`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SqrtBox[
  RowBox[{
   RowBox[{"0.19098042207655", "^", "2"}], "-", 
   RowBox[{"4", " ", "0.014247469381460"}]}]]], "Input"],

Cell[BoxData[
 RowBox[{"0.`", "\[InvisibleSpace]", "+", 
  RowBox[{"0.14323531655741475`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"z1", "=", 
   RowBox[{"1.1737504870683", "+", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";", 
  RowBox[{"z2", "=", 
   RowBox[{"1.1737504870683", "-", 
    RowBox[{"\[ImaginaryI]", " ", "0.88031286530120"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"z2", "-", "z1"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input"],

Cell[BoxData["1.9621461397679203`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", "z2", "]"}]], "Input"],

Cell[BoxData["1.4671881088353598`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Abs", "[", 
  RowBox[{"z2", "/", 
   RowBox[{"(", 
    RowBox[{"z2", "-", "1"}], ")"}]}], "]"}]], "Input"],

Cell[BoxData["1.6351217831399636`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Power", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"z2", "-", "z1"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"z2", "-", "1"}], ")"}]}], ",", "10"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "312.1012926642466`"}], "-", 
  RowBox[{"786.2069686500461`", " ", "\[ImaginaryI]"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "We", " ", "extend", " ", "the", " ", "definition", " ", "of", " ", "the", 
   " ", "appell", " ", "function", " ", "to", " ", "x"}], ",", 
  RowBox[{
   RowBox[{
   "y", " ", "couple", " ", "outside", " ", "the", " ", "real", " ", "axis", 
    " ", "x"}], ">", 
   RowBox[{"1", " ", "or", " ", "y"}], ">", "1"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "2"], "-", 
       SubscriptBox["z", "1"]}], 
      RowBox[{
       SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"AppellF1", "[", 
   RowBox[{"a", ",", 
    SubscriptBox["b", "1"], ",", 
    SubscriptBox["b", "2"], ",", "c", ",", 
    SubscriptBox["z", "1"], ",", 
    SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "1"]}], ")"}], 
    RowBox[{"-", 
     SubscriptBox["b", "1"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SubscriptBox["z", "2"]}], ")"}], 
    RowBox[{"c", "-", "a", "-", 
     SubscriptBox["b", "2"]}]], 
   RowBox[{"AppellF1", "[", 
    RowBox[{
     RowBox[{"c", "-", "a"}], ",", 
     SubscriptBox["b", "1"], ",", 
     RowBox[{"c", "-", 
      SubscriptBox["b", "1"], "-", 
      SubscriptBox["b", "2"]}], ",", "c", ",", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "1"], "-", 
       SubscriptBox["z", "2"]}], 
      RowBox[{
       SubscriptBox["z", "1"], "-", "1"}]], ",", 
     SubscriptBox["z", "2"]}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      SubscriptBox["b", "1"], ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", "c", ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "2"], "-", 
        SubscriptBox["z", "1"]}], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", " ", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", "a"}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{"a", ",", 
      RowBox[{"c", "-", 
       SubscriptBox["b", "1"], "-", 
       SubscriptBox["b", "2"]}], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       RowBox[{
        SubscriptBox["z", "1"], "-", 
        SubscriptBox["z", "2"]}], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AppellF1", "[", 
    RowBox[{"a", ",", 
     SubscriptBox["b", "1"], ",", 
     SubscriptBox["b", "2"], ",", "c", ",", 
     SubscriptBox["z", "1"], ",", 
     SubscriptBox["z", "2"]}], "]"}], "\[Equal]", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "1"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "1"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["z", "2"]}], ")"}], 
     RowBox[{"-", 
      SubscriptBox["b", "2"]}]], 
    RowBox[{"AppellF1", "[", 
     RowBox[{
      RowBox[{"c", "-", "a"}], ",", 
      SubscriptBox["b", "1"], ",", 
      SubscriptBox["b", "2"], ",", "c", ",", 
      FractionBox[
       SubscriptBox["z", "1"], 
       RowBox[{
        SubscriptBox["z", "1"], "-", "1"}]], ",", 
      FractionBox[
       SubscriptBox["z", "2"], 
       RowBox[{
        SubscriptBox["z", "2"], "-", "1"}]]}], "]"}]}]}], "/;", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "1"]}], "]"}], "]"}], "\[And]", 
   RowBox[{"Not", "[", 
    RowBox[{"IntervalMemberQ", "[", 
     RowBox[{
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Infinity]"}], "}"}], "]"}], ",", 
      SubscriptBox["z", "2"]}], "]"}], "]"}]}]}]],
 FontSize->16],

Cell[BoxData[
 RowBox[{"Generic", " ", "Algorithm", " ", "For", " ", "Generic", " ", "SABR",
   " "}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"C", "[", "f_", "]"}], ":=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"f", "+", "A"}], ")"}], "\[Beta]"]}], "        ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "determine", " ", "z"}], ",", "b1", ",", "b2"}], " ",
    "*)"}], " ", "*)"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"C", "[", "f", "]"}], "=", 
    RowBox[{
     RowBox[{"B", "[", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]", " ", "z"}], "]"}], " ", 
     "determines", " ", "B"}]}], ",", " ", 
   RowBox[{"so", " ", ":"}]}], " ", "*)"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"z", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]", " ", "\[Alpha]"}]], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "K", "f"], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"C", "[", "s", "]"}]], 
       RowBox[{"\[DifferentialD]", "s"}], "  ", "determines", " ", 
       "z"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"b1", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], "=", 
      RowBox[{
       SuperscriptBox["C", "\[Prime]",
        MultilineFunction->None], "[", "f", "]"}]}]}], " ", ",", " ", 
    RowBox[{"b2", "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["B", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
       RowBox[{"B", "[", 
        RowBox[{"z", " ", "\[Alpha]"}], "]"}]], " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["C", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "f", "]"}], 
        RowBox[{"C", "[", "f", "]"}]}], "+", 
       SuperscriptBox["b1", "2"]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"SqB0B\[Alpha]z", " ", "represente", " ", "bien", " ", "sur", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"z", " ", "\[Alpha]"}], "]"}], 
      RowBox[{"B", "[", "0", "]"}]}]]}], "  ", "*)"}], "\[IndentingNewLine]", 
  " "}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SABRgeneric5", "[", 
   RowBox[{
   "intrinsec_", ",", "z_", ",", "b1_", ",", "b2_", ",", "zavg_", ",", 
    "SqB0B\[Alpha]z_", ",", "T_", ",", "\[Mu]_", ",", "\[Alpha]_", ",", 
    "\[Rho]_", ",", "\[Nu]_", ",", "printflag_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x", ",", "I0", ",", "I1", ",", "I2", ",", "\[Kappa]", ",", "f1overf0"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[Rho]"}], "+", 
          RowBox[{"\[Nu]", " ", "z"}], "+", 
          SqrtBox[
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "\[Nu]", " ", "\[Rho]", " ", "z"}], "+", 
            RowBox[{
             SuperscriptBox["\[Nu]", "2"], " ", 
             SuperscriptBox["z", "2"]}]}]]}], 
         RowBox[{"1", "-", "\[Rho]"}]], "]"}], "\[Nu]"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I0", "=", 
      SqrtBox[
       RowBox[{"1", "+", 
        RowBox[{"zavg", " ", "\[Nu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"zavg", " ", "\[Nu]"}], "-", 
           RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I1", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"zavg", " ", "\[Nu]"}], "-", "\[Rho]"}], "I0"]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I2", "=", 
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}], 
       SuperscriptBox["I0", "3"]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"12", "  ", "\[Mu]"}], "+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           SuperscriptBox["b1", "2"], " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "+", 
          RowBox[{"2", " ", "b2", " ", 
           SuperscriptBox["\[Alpha]", "2"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["z", "2"], " ", 
           SuperscriptBox["\[Mu]", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["I1", "2"], " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{"2", " ", "I0", " ", "I2", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          RowBox[{
          "6", " ", "b1", " ", "\[Alpha]", " ", "\[Nu]", " ", "\[Rho]"}], "-", 
          RowBox[{
          "16", " ", "z", " ", "\[Mu]", " ", "\[Nu]", " ", "\[Rho]"}]}], 
         ")"}]}], 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"z", "  ", "\[Nu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "  ", "\[Nu]"}], "-", 
             RowBox[{"2", " ", "\[Rho]"}]}], ")"}]}]}], ")"}]}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f1overf0", "=", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Mu]"}], "+", 
           RowBox[{"b1", " ", "\[Alpha]", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"z", "  ", "\[Nu]"}], "-", "\[Rho]"}], 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{"2", " ", "\[Rho]", " ", 
            RowBox[{"ArcTan", "[", 
             FractionBox["\[Rho]", 
              SqrtBox[
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}]]], "]"}]}], "+", 
           RowBox[{
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}]], " ", 
            RowBox[{"Log", "[", 
             RowBox[{"1", "+", 
              RowBox[{
               SuperscriptBox["z", "2"], "  ", 
               SuperscriptBox["\[Nu]", "2"]}], "-", 
              RowBox[{"2", " ", "z", "  ", "\[Nu]", " ", "\[Rho]"}]}], 
             "]"}]}]}], ")"}]}], 
        RowBox[{"4", "  ", 
         SuperscriptBox["\[Nu]", "2"], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}]]}]]]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<z=\>\"", ",", "z", ",", "\"\< zavg=\>\"", ",", "zavg", ",", 
         "\"\< x=\>\"", ",", "x", ",", "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", 
         ",", "\"\< f1overf0=\>\"", ",", "f1overf0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "+", 
      RowBox[{
       FractionBox["\[Alpha]", "2"], 
       SqrtBox[
        FractionBox["2", "\[Pi]"]], " ", "SqB0B\[Alpha]z", "  ", "f1overf0", 
       " ", 
       SqrtBox["I0"], " ", 
       RowBox[{"GIntegralAnalytical", "[", 
        RowBox[{
         SqrtBox[
          RowBox[{"-", "\[Kappa]"}]], ",", 
         FractionBox["x", 
          SqrtBox["2"]], ",", 
         SqrtBox["T"]}], "]"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Regles", " ", "pour", " ", "la", " ", "transcription", " ", "en", 
  " ", 
  RowBox[{"C", "++"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesz", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]1", "\[Rule]", "alpha1"}], ",", 
     RowBox[{"\[Alpha]2", "\[Rule]", "alpha2"}], ",", 
     RowBox[{"\[Beta]1", "\[Rule]", "beta1"}], ",", 
     RowBox[{"\[Beta]2", "\[Rule]", "beta2"}], ",", 
     RowBox[{"\[Rho]1", "\[Rule]", "rho1"}], ",", 
     RowBox[{"\[Rho]2", "\[Rule]", "rho2"}], ",", 
     RowBox[{"\[Nu]1", "\[Rule]", "nu1"}], ",", 
     RowBox[{"\[Nu]2", "\[Rule]", "nu2"}], ",", 
     RowBox[{"\[Rho]s", "\[Rule]", "rhos"}], ",", 
     RowBox[{"\[Rho]v", "\[Rule]", "rhov"}], ",", 
     RowBox[{"\[Rho]c12", "\[Rule]", "rhoc12"}], ",", 
     RowBox[{"\[Rho]c21", "\[Rule]", "rhoc21"}], ",", 
     RowBox[{"\[Alpha]s", "\[Rule]", "alphas"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ruleszz1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1SQ", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2SQ", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X1", "*", "X1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["X2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"X2", "*", "X2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "6"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "5"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1SQ", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "4"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2SQ", "*", "alpha2SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]1", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha1", "*", "alpha1SQ"}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "3"], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"alpha2", "*", "alpha2SQ"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleszz2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       StyleBox["\[Alpha]1", "DisplayFormula"], "2"], "\[Rule]", "alpha1SQ"}],
      ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]2", "2"], "\[Rule]", "alpha2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]1", "2"], "\[Rule]", "beta1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Beta]2", "2"], "\[Rule]", "beta2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]1", "2"], "\[Rule]", "rho1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]2", "2"], "\[Rule]", "rho2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]1", "2"], "\[Rule]", "nu1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Nu]2", "2"], "\[Rule]", "nu2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]s", "2"], "\[Rule]", "rhosSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]v", "2"], "\[Rule]", "rhovSQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c12", "2"], "\[Rule]", "rhoc12SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Rho]c21", "2"], "\[Rule]", "rhoc21SQ"}], ",", 
     RowBox[{
      SuperscriptBox["\[Alpha]s", "2"], "\[Rule]", "alphasSQ"}], ",", 
     RowBox[{
      SuperscriptBox["X1", "2"], "\[Rule]", "X1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["X2", "2"], "\[Rule]", "X2SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F1", "2"], "\[Rule]", "F1SQ"}], ",", 
     RowBox[{
      SuperscriptBox["F2", "2"], "\[Rule]", "F2SQ"}]}], "}"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CTranform", "[", "x_", "]"}], ":=", 
  RowBox[{"CForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x", " ", "/.", "ruleszz1"}], " ", "/.", " ", "ruleszz2"}], " ", 
    "/.", "rulesz"}], "  ", "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{"2", " ", 
   SuperscriptBox["X1", 
    RowBox[{"3", " "}]], " ", "X2", " ", 
   SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["X1", "F1"], ")"}], "2"], " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", 
      SuperscriptBox["\[Beta]1", "2"]}], "+", 
     RowBox[{
      FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]s"}]}], ")"}]}], "+", 
     RowBox[{"\[Nu]1", " ", 
      RowBox[{"(", 
       RowBox[{"\[Nu]1", "+", 
        RowBox[{
         FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
         "\[Rho]c21"}], "+", 
        RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}], 
  "]"}]], "Input"],

Cell["\<\
2*Power(alpha1,3)*alpha2*rhos*Power(X1,3)*X2*
   ((alpha1SQ*beta1SQ*X1SQ)/Power(F1,2) + nu1*(nu1 + nu2*rhov + \
(alpha2*beta2*rhoc21*X2)/F2) + 
     (alpha1*beta1*X1*(2*nu1*rho1 + nu2*rhoc12 + \
(alpha2*beta2*rhos*X2)/F2))/F1)\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Precalcul", " ", "pour", " ", "le", " ", "spreadoption"}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Nu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         SuperscriptBox["\[Nu]1", "2"], "+", 
         RowBox[{"2", " ", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          "\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       SuperscriptBox["X2", 
        RowBox[{"4", " "}]], " ", 
       SuperscriptBox["\[Alpha]2", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         SuperscriptBox["\[Nu]2", "2"], "+", 
         RowBox[{"2", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          "\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X2", "F2"], ")"}], "2"], "  ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]1", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]2", "2"], " ", 
          SuperscriptBox["\[Rho]s", "2"]}], "+", 
         RowBox[{"2", " ", 
          FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", 
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
             SuperscriptBox["\[Rho]s", "2"]}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}], "+", 
         RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", 
          SuperscriptBox["\[Rho]s", "2"], " ", "\[Rho]v"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{"2", " ", "X1", "  ", 
       SuperscriptBox["X2", 
        RowBox[{"3", " "}]], " ", "\[Alpha]1", " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", "\[Rho]s", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"2", " ", "\[Beta]2"}]}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"], " ", 
          SuperscriptBox["\[Beta]2", "2"]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["F2", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}]], " ", "\[Alpha]2", " ", 
           "\[Beta]2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "F1", " ", "\[Nu]2", " ", "\[Rho]2"}], "+", 
             RowBox[{"F1", " ", "\[Nu]1", " ", "\[Rho]c21"}], "+", 
             RowBox[{
              SuperscriptBox["F1", "\[Beta]1"], " ", "\[Alpha]1", " ", 
              "\[Beta]1", " ", "\[Rho]s"}]}], ")"}]}], "F1"], "+", 
         RowBox[{"\[Nu]2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]2", "+", 
            RowBox[{
             FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
             "\[Rho]c12"}], "+", 
            RowBox[{"\[Nu]1", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"term5", "=", 
      RowBox[{"2", " ", 
       SuperscriptBox["X1", 
        RowBox[{"3", " "}]], " ", "X2", " ", 
       SuperscriptBox["\[Alpha]1", "3"], " ", "\[Alpha]2", " ", "\[Rho]s", 
       " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["X1", "F1"], ")"}], "2"], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", 
          SuperscriptBox["\[Beta]1", "2"]}], "+", 
         RowBox[{
          FractionBox["X1", "F1"], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Rho]1"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"\[Nu]1", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]1", "+", 
            RowBox[{
             FractionBox["X2", "F2"], " ", "\[Alpha]2", " ", "\[Beta]2", " ", 
             "\[Rho]c21"}], "+", 
            RowBox[{"\[Nu]2", " ", "\[Rho]v"}]}], ")"}]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
       "term1", "+", "term2", "+", "term3", "-", "term4", "-", "term5"}]], 
      SuperscriptBox["\[Alpha]s", "2"]]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "\[Nu]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["X1", "3"], " ", 
        SuperscriptBox["\[Alpha]1", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], "F1"], "+", 
          RowBox[{"\[Nu]1", " ", "\[Rho]1"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X2", "3"], " ", 
        SuperscriptBox["\[Alpha]2", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], "F2"], "+", 
          RowBox[{"\[Nu]2", " ", "\[Rho]2"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["X1", "2"], " ", "X2", " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X1", " ", "\[Alpha]1", " ", "\[Beta]1"}], 
              "F1"], "+", 
             RowBox[{"\[Nu]2", " ", "\[Rho]c12"}], "+", 
             FractionBox[
              RowBox[{
              "X2", " ", "\[Alpha]2", " ", "\[Beta]2", " ", "\[Rho]s"}], 
              "F2"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c21", "+", 
             RowBox[{"\[Rho]1", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]s", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"2", " ", "X2", " ", "\[Alpha]2", " ", "\[Beta]2"}], 
              "F2"], "+", 
             RowBox[{"\[Nu]1", " ", "\[Rho]c21"}], "+", 
             FractionBox[
              RowBox[{
              "X1", " ", "\[Alpha]1", " ", "\[Beta]1", " ", "\[Rho]s"}], 
              "F1"]}], ")"}]}], "+", 
          RowBox[{"\[Nu]2", " ", 
           RowBox[{"(", 
            RowBox[{"\[Rho]c12", "+", 
             RowBox[{"\[Rho]2", " ", "\[Rho]s"}]}], ")"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Nu]s", " ", 
       SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Nu]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.2504035206821828`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F1", " ", "=", "0.040908314711852"}], ",", 
     RowBox[{"alpha1", "=", " ", "0.013242339206841"}], ",", 
     RowBox[{"beta1", " ", "=", "0.40000000000000"}], ",", 
     RowBox[{"rho1", "=", " ", "0.35242800000000"}], ",", 
     RowBox[{"nu1", " ", "=", "0.25283800000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"F2", "=", " ", "0.044141630651630"}], ",", 
     RowBox[{"alpha2", " ", "=", "0.014300324948643"}], ",", 
     RowBox[{"beta2", "=", " ", "0.40000000000000"}], ",", 
     RowBox[{"rho2", "=", " ", "0.37737400000000"}], ",", 
     RowBox[{"nu2", "=", " ", "0.23093200000000"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rhos", " ", "=", "0.90400000000000"}], ",", 
     RowBox[{"rhov", "=", " ", "0.60000000000000"}], ",", 
     RowBox[{"rhoc12", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"rhoc21", "=", 
      RowBox[{"-", "0.050000000000000"}]}], ",", 
     RowBox[{"X1", " ", "=", "0.27843551868880"}], ",", 
     RowBox[{"X2", "=", " ", "0.28703796939008"}], ",", "\[IndentingNewLine]", 
     RowBox[{"alphas", "=", " ", "0.0017550658859387"}], ",", 
     RowBox[{"nus", " ", "=", "0.25040352068222"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"\[Rho]BiSABR1", "[", 
    RowBox[{
    "F1", ",", "alpha1", ",", "beta1", ",", "rho1", ",", "nu1", ",", "F2", 
     ",", "alpha2", ",", "beta2", ",", "rho2", ",", "nu2", ",", "rhos", ",", 
     "rhov", ",", "rhoc12", ",", "rhoc21", ",", "X1", ",", "X2", ",", 
     "alphas", ",", "nus"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", "1.0279990989437193`"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CTranform", "[", 
  RowBox[{
   SuperscriptBox["X1", 
    RowBox[{"2", " "}]], " ", 
   SuperscriptBox["X2", "2"], " ", "F2", "  ", 
   SuperscriptBox["\[Alpha]1", "2"], " ", 
   SuperscriptBox["\[Alpha]2", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["X1", "2"], " ", "F2", " ", 
      SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "\[Beta]1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
         SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", "\[Rho]2", 
         " ", "\[Rho]s"}], "+", 
        RowBox[{"F2", " ", "\[Beta]1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
           RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}],
      "-", 
     RowBox[{
      SuperscriptBox["F1", "2"], " ", "F2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]1", "2"], "+", 
        SuperscriptBox["\[Nu]2", "2"], "-", 
        RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
       ")"}]}]}], ")"}]}], "]"}]], "Input"],

Cell["\<\
alpha1SQ*alpha2SQ*F2*X1SQ*(-(F1SQ*F2*(-1 + rhosSQ)*(nu1SQ + nu2SQ - \
2*nu1*nu2*rhov)) + 
     2*alpha1*F1*(-(beta2*F1*nu2*rho2*rhos) + beta1*F2*(nu2*rhoc12*(-1 + \
rhosSQ) + nu1*rho1*(2 + rhosSQ)))*X1 + 
     alpha1SQ*beta1*F2*(-1 + 2*beta1 + (-2 + beta1)*rhosSQ)*X1SQ)*X2SQ\
\>", "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BiSABR1", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"term1", ",", "term2", ",", "term3", ",", "term4"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"term1", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"6", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "6"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Beta]2"}], 
       "+", 
       RowBox[{
        SuperscriptBox["X1", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "5"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], 
         ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox["X1", 
         RowBox[{"4", " "}]], " ", "X2", " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]1", "4"], " ", "\[Alpha]2", " ", "\[Beta]1", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "+", 
          RowBox[{"2", " ", "F1", " ", "\[Nu]1", " ", "\[Rho]1"}]}], ")"}], 
        " ", "\[Rho]s"}], "+", 
       RowBox[{
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", 
         RowBox[{"5", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "5"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2"}], "-", 
          RowBox[{"3", " ", "X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", "\[Rho]s"}]}],
          ")"}]}], "+", 
       RowBox[{"X1", " ", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["X2", "4"], " ", "\[Alpha]1", " ", 
        SuperscriptBox["\[Alpha]2", "4"], " ", "\[Beta]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", "F2", " ", "\[Nu]2", " ", "\[Rho]2", " ", 
           "\[Rho]s"}], "+", 
          RowBox[{"X1", " ", "\[Alpha]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "\[Beta]2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Beta]2"}], ")"}], " ", 
              SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}]}], ")"}]}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"term3", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "3"], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"X1", " ", "\[Alpha]1", " ", "\[Rho]s", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["F2", "2"]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
             "\[Beta]1"}], "-", 
            RowBox[{
             SuperscriptBox["F1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Beta]2"}], ")"}], " ", 
             "\[Beta]2"}], "+", 
            RowBox[{
            "2", " ", "F1", " ", "F2", " ", "\[Beta]1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "F1", " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F2"}], " ", "\[Beta]1", " ", "\[Nu]1", " ", 
             "\[Rho]1", " ", "\[Rho]s"}], "+", 
            RowBox[{"F1", " ", "\[Beta]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]1", " ", "\[Rho]c21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]2", " ", "\[Rho]2", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"term4", "=", 
      RowBox[{
       SuperscriptBox["X1", 
        RowBox[{"2", " "}]], " ", 
       SuperscriptBox["X2", "2"], " ", "F2", "  ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", "2"], " ", "F2", " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Beta]1"}], ")"}], " ", 
             SuperscriptBox["\[Rho]s", "2"]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "X1", " ", "F1", " ", "\[Alpha]1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "F1"}], " ", "\[Beta]2", " ", "\[Nu]2", " ", 
             "\[Rho]2", " ", "\[Rho]s"}], "+", 
            RowBox[{"F2", " ", "\[Beta]1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Nu]2", " ", "\[Rho]c12", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}], "+", 
               RowBox[{"\[Nu]1", " ", "\[Rho]1", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["F1", "2"], " ", "F2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["\[Rho]s", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Nu]1", "2"], "+", 
            SuperscriptBox["\[Nu]2", "2"], "-", 
            RowBox[{"2", " ", "\[Nu]1", " ", "\[Nu]2", " ", "\[Rho]v"}]}], 
           ")"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"term1", "+", "term2", "+", "term3", "+", "term4"}], ")"}], 
      "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        SuperscriptBox["F1", "2"], " ", 
        SuperscriptBox["F2", "2"], " ", 
        SuperscriptBox["\[Alpha]s", "3"]}], ")"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"], 
     ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "F2", ",", "2"}], "}"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["2", "\[Beta]1"]}], " ", 
     SuperscriptBox["F2", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
     RowBox[{"(", 
      RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["2", "\[Beta]1"], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
       RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["4", "\[Beta]1"], " ", 
        SuperscriptBox["F2", 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", "2"], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "+", "\[Beta]1"}]], " ", 
        SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
      SuperscriptBox["F2", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
      "\[Beta]1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["8", "\[Beta]1"], " ", 
         SuperscriptBox["F2", 
          RowBox[{"3", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["4", "\[Beta]1"], " ", 
         SuperscriptBox["F2", 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
         SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
        "-", 
        RowBox[{
         SuperscriptBox["X2", "3"], " ", 
         SuperscriptBox["\[Alpha]2", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Rho]s"}], 
        "+", 
        RowBox[{
         SuperscriptBox["2", "\[Beta]1"], " ", 
         SuperscriptBox["F2", "\[Beta]1"], " ", 
         SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
         SuperscriptBox["\[Alpha]2", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Rho]s", "2"]}], "+", 
           RowBox[{"\[Beta]1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["4", "\[Beta]1"], " ", 
       SuperscriptBox["F2", 
        RowBox[{"2", " ", "\[Beta]1"}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["X2", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", "\[Alpha]s", " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["4", "\[Beta]1"], " ", 
       SuperscriptBox["F2", 
        RowBox[{"2", " ", "\[Beta]1"}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["X2", "2"], " ", 
       SuperscriptBox["\[Alpha]2", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "+", "\[Beta]1"}]], " ", 
       SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadC", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"s", "+", "F2"}], "]"}], "<", 
       RowBox[{"2", " ", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "3"}], ")"}]}], "F2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["2", "\[Beta]1"]}], " ", 
          SuperscriptBox["F2", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", 
          RowBox[{"(", 
           RowBox[{"F2", "-", "s"}], ")"}], " ", "\[Alpha]1", " ", "\[Beta]1",
           " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["2", "\[Beta]1"], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "\[Alpha]1"}], "-", 
            RowBox[{"X2", " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["4", "\[Beta]1"], " ", 
             SuperscriptBox["F2", 
              RowBox[{"2", " ", "\[Beta]1"}]], " ", 
             SuperscriptBox["\[Alpha]1", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["X2", "2"], " ", 
             SuperscriptBox["\[Alpha]2", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"1", "+", "\[Beta]1"}]], " ", 
             SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
             " ", "\[Alpha]2", " ", "\[Rho]s"}]}], ")"}]}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
           SuperscriptBox["F2", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"F2", "-", "s"}], ")"}], "2"], " ", "\[Alpha]1", " ", 
           "\[Beta]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["8", "\[Beta]1"], " ", 
              SuperscriptBox["F2", 
               RowBox[{"3", " ", "\[Beta]1"}]], " ", 
              SuperscriptBox["\[Alpha]1", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}]}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["4", "\[Beta]1"], " ", 
              SuperscriptBox["F2", 
               RowBox[{"2", " ", "\[Beta]1"}]], " ", "X2", " ", 
              SuperscriptBox["\[Alpha]1", "2"], " ", "\[Alpha]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
              "\[Rho]s"}], "-", 
             RowBox[{
              SuperscriptBox["X2", "3"], " ", 
              SuperscriptBox["\[Alpha]2", "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", 
              "\[Rho]s"}], "+", 
             RowBox[{
              SuperscriptBox["2", "\[Beta]1"], " ", 
              SuperscriptBox["F2", "\[Beta]1"], " ", 
              SuperscriptBox["X2", "2"], " ", "\[Alpha]1", " ", 
              SuperscriptBox["\[Alpha]2", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{"2", " ", 
                 SuperscriptBox["\[Rho]s", "2"]}], "+", 
                RowBox[{"\[Beta]1", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", 
                   SuperscriptBox["\[Rho]s", "2"]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}], 
          RowBox[{
           RowBox[{
            SuperscriptBox["4", "\[Beta]1"], " ", 
            SuperscriptBox["F2", 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", "2"], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"1", "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
            " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", " ", "\[Alpha]s", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["4", "\[Beta]1"], " ", 
            SuperscriptBox["F2", 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", "2"], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"1", "+", "\[Beta]1"}]], " ", 
            SuperscriptBox["F2", "\[Beta]1"], " ", "X2", " ", "\[Alpha]1", 
            " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRspreadC", "[", 
    RowBox[{
    "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_",
      ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
     "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], "\[Alpha]s"]}], 
    "]"}]}], "\[IndentingNewLine]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   FractionBox[
    RowBox[{" ", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
       SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
      RowBox[{"X2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"s", "+", "F2"}], ")"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
       "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
    RowBox[{"\[Alpha]s", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{"2", " ", "\[Beta]1"}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["X2", 
         RowBox[{"2", " "}]], " ", 
        SuperscriptBox["\[Alpha]2", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
        "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]], ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", 
     RowBox[{"-", "F2"}], ",", "1"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
    SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"F2", "+", "s"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "X2", " ", "\[Alpha]1", 
    " ", "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], 
  RowBox[{"\[Alpha]s", " ", 
   SqrtBox[
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], 
       RowBox[{"2", " ", "\[Beta]1"}]], " ", 
      SuperscriptBox["\[Alpha]1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["X2", "2"], " ", 
      SuperscriptBox["\[Alpha]2", "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"F2", "+", "s"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
      "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", " ", 
       RowBox[{"X2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}]}], 
     RowBox[{"\[Alpha]s", " ", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], 
          RowBox[{"2", " ", "\[Beta]1"}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
         "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRspreadCderivative2", "[", 
   RowBox[{
   "F1_", ",", "F2_", ",", "\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Beta]1_", 
    ",", "\[Beta]2_", ",", "\[Rho]s_", ",", "X1_", ",", "X2_", ",", 
    "\[Alpha]s_", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1"}], "-", 
         RowBox[{"2", " ", "X2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
          "\[Alpha]2", " ", "\[Beta]1", " ", "\[Rho]s"}]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], 
             RowBox[{"2", " ", "\[Beta]1"}]], " ", 
            SuperscriptBox["\[Alpha]1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["X2", 
             RowBox[{"2", " "}]], " ", 
            SuperscriptBox["\[Alpha]2", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
            "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]], ")"}], 
        "3"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}]], " ", 
        SuperscriptBox["\[Alpha]1", "2"], " ", "\[Beta]1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "\[Beta]1"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["F2", "\[Beta]2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"s", "+", "F2"}], ")"}], 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Beta]1"}]], " ", "\[Alpha]1", " ", 
        "\[Alpha]2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Beta]1"}], ")"}], " ", "\[Beta]1", " ", 
        "\[Rho]s"}]}], 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], 
           RowBox[{"2", " ", "\[Beta]1"}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"s", "+", "F2"}], ")"}], "\[Beta]1"], " ", "X2", " ", 
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s"}]}]]}]]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData["Spreadoption"], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Utilise", " ", "une", " ", "integration", " ", "numerique", " ", "pour", 
   " ", "le", " ", "calcul", " ", "du", " ", "z"}], ",", " ", 
  RowBox[{"Fait", " ", "des", " ", "tas", " ", 
   RowBox[{"d", "'"}], "affichage"}]}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "zb", ",", "b1", ",", "b2", ",", 
      "SqB0B\[Alpha]z", ",", "favg", ",", "zavg", ",", "Ck", ",", 
      "\[Alpha]sp", ",", "\[Nu]sp", ",", "\[Rho]sp", ",", "\[Mu]sp", ",", 
      "X1", ",", "X2", ",", "Qs", ",", "Q1", ",", "Q2", ",", "Qb", ",", "C1", 
      ",", "C2", ",", "C1p", ",", "C2p", ",", "Q", ",", "COV", ",", "COV1", 
      ",", "COV0", ",", "\[Rho]sb", ",", "\[Rho]s\[Alpha]1", ",", 
      "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", 
      ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",", "X2", ",", 
         "\"\< \[Alpha]sp=\>\"", ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Re", "[", 
       RowBox[{"BiSABRz", "[", 
        RowBox[{
        "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
         "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zb", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:z=\>\"", ",", "z", ",", "\"\<zb=\>\"", ",", 
         "zb"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:K=\>\"", ",", "K", ",", 
         "\"\< b1:Cprime[favg]=\>\"", ",", "b1", ",", 
         "\"\< Csecond[favg]=\>\"", ",", "Csecond", ",", " ", "\"\< b2=\>\"", 
         ",", "b2", ",", "\"\< Cfavg=\>\"", ",", "Cfavg"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:intrinsec Value=\>\"", ",", "intrinsec", ",", 
         "\"\<  z=\>\"", ",", "z", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", 
         "SqB0B\[Alpha]z"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"C1", "=", 
         RowBox[{"F1", "^", "\[Beta]1"}]}], ";", 
        RowBox[{"C2", "=", 
         RowBox[{"F2", "^", "\[Beta]2"}]}], ";", 
        RowBox[{"C1p", "=", 
         RowBox[{"\[Beta]1", " ", 
          RowBox[{"F1", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]1", "-", "1"}], ")"}]}]}]}], ";", 
        RowBox[{"C2p", "=", 
         RowBox[{"\[Beta]2", " ", 
          RowBox[{"F2", "^", 
           RowBox[{"(", 
            RowBox[{"\[Beta]2", "-", "1"}], ")"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         SqrtBox[
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Alpha]1", "2"], " ", 
            SuperscriptBox["C1", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["\[Alpha]2", "2"], " ", 
            SuperscriptBox["C2", "2"]}], "-", 
           RowBox[{
           "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", " ",
             "C2"}]}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qs", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", "  ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Qb", "=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Alpha]1", "2"], " ", "C1", " ", "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C2", "  ", 
           "C1p"}], "-", 
          RowBox[{
          "\[Alpha]1", " ", "\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", 
           "C2p"}], "+", 
          RowBox[{
           SuperscriptBox["\[Alpha]2", "2"], " ", "C2", " ", "C2p"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Q1", "=", 
         RowBox[{
          RowBox[{"\[Alpha]1", " ", 
           SuperscriptBox["C1", "2"]}], "-", 
          RowBox[{"\[Alpha]2", " ", "\[Rho]s", " ", "C1", " ", "C2"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Q2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Alpha]1"}], " ", "\[Rho]s", " ", "C1", " ", "C2"}],
           "+", 
          RowBox[{"\[Alpha]2", " ", 
           SuperscriptBox["C2", "2"]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]sb", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
            RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]1", "=", 
         FractionBox[
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
          "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]s\[Alpha]2", "=", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
            RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], "Q"]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]1", "=", "\[Rho]c21"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Rho]b\[Alpha]2", "=", "\[Rho]2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV0", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Alpha]1", "2"], " ", 
              SuperscriptBox["C1", "2"]}], ",", 
             "                                                          ", 
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                         ", 
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                    ", 
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ", 
              "C2"}], " ", ",", "                                         ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", 
             "                                            ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
             "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                        ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "rc12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc12", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Alpha]1", "2"], " ", 
                SuperscriptBox["C1", "2"]}], ",", 
               "                                                          ", 
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", "                         ", 
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                    ", 
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]s", " ", "\[Alpha]1", " ", "C1", " ", "\[Alpha]2", "  ",
                 "C2"}], " ", ",", 
               "                                         ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
               "                                       ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", "                                 ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]1", "  ", "\[Alpha]1", " ", "C1", " ", "\[Nu]1", " ", 
                "\[Alpha]1"}], ",", 
               "                                            ", 
               RowBox[{
               "rc21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
                "\[Alpha]1"}], ",", "                       ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
               "                                                ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
               "\[Rho]c12", " ", "\[Alpha]1", " ", "C1", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], ",", 
               "                                        ", 
               RowBox[{
               "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
                "\[Alpha]2"}], " ", ",", "                           ", 
               RowBox[{
               "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ",
                 "\[Alpha]2"}], ",", "                                    ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}],
             "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rc21", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Initial Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV0", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"COV1", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Alpha]1", "2"], " ", 
               SuperscriptBox["C1", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["\[Alpha]2", "2"], " ", 
               SuperscriptBox["C2", "2"]}], "-", 
              RowBox[{
              "2", "\[Rho]s", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", "C1", 
               " ", "C2"}]}], ",", "       ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], " ", ",", "     ", 
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              "\[Nu]1", " ", "\[Alpha]1"}], ",", "     ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]s", " ", "\[Alpha]1", " ", "C1"}], "-", "  ", 
                RowBox[{"\[Alpha]2", " ", "C2"}]}], ")"}], " ", "\[Alpha]2", "  ",
               "C2"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             "                                       ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", " ", 
              "\[Alpha]1"}], ",", "                                 ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"\[Rho]1", "  ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]c21", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]1", "  ", "\[Alpha]1"}], ",", "             ", 
             RowBox[{
             "\[Rho]c21", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ", 
              "\[Alpha]1"}], ",", "                       ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             "                                                ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Rho]c12", " ", "\[Alpha]1", " ", "C1"}], "-", " ", 
                RowBox[{"\[Rho]2", " ", "\[Alpha]2", " ", "C2"}]}], ")"}], 
              " ", "\[Nu]2", " ", "\[Alpha]2"}], ",", "                ", 
             RowBox[{
             "\[Rho]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], " ", ",", "                           ", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", "                                    ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"COV", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["Q", "2"], ",", 
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             " ", ",", 
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", " ", "\[Alpha]1"}], 
             ",", 
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Rho]sb", " ", "Q", " ", "\[Alpha]2", "  ", "C2"}], 
             ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]2", "  ", "C2"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", 
              " ", "\[Alpha]1"}], ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]1", " ", "Q", " ", "\[Nu]1", "  ", "\[Alpha]1"}],
              ",", 
             RowBox[{
             "\[Rho]b\[Alpha]1", " ", "\[Alpha]2", " ", "C2", " ", "\[Nu]1", "  ",
               "\[Alpha]1"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]1", " ", "\[Alpha]1"}], ")"}], "2"], ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\[Rho]s\[Alpha]2", " ", "Q", " ", "\[Nu]2", " ", "\[Alpha]2"}], 
             ",", 
             RowBox[{
             "\[Rho]b\[Alpha]2", " ", "\[Alpha]2", "  ", "C2", " ", "\[Nu]2", 
              " ", "\[Alpha]2"}], " ", ",", 
             RowBox[{
             "\[Rho]v", " ", "\[Nu]1", " ", "\[Alpha]1", " ", "\[Nu]2", " ", 
              "\[Alpha]2"}], ",", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Nu]2", " ", "\[Alpha]2"}], ")"}], "2"]}], "}"}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\< COV1-COV=\>\"", ",", 
          RowBox[{"COV1", "-", "COV"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"N1", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"N2", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}], ".", 
          RowBox[{"(", 
           RowBox[{"COV", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Qs", "/", "Q"}], ",", 
              RowBox[{"Qb", "/", "Q"}], ",", 
              RowBox[{"Q1", "/", "Q"}], ",", 
              RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Nu]spZ", "=", 
         FractionBox[
          SqrtBox["N2"], "Q"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Rho]spZ", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}], ".", 
            RowBox[{"(", 
             RowBox[{"COV", ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Qs", "/", "Q"}], ",", 
                RowBox[{"Qb", "/", "Q"}], ",", 
                RowBox[{"Q1", "/", "Q"}], ",", 
                RowBox[{"Q2", "/", "Q"}]}], "}"}]}], ")"}]}], ")"}], "/", 
          SqrtBox[
           RowBox[{"N2", " ", "N1"}]]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N1=\>\"", ",", "N1"}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:N2=\>\"", ",", "N2"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Nu]spZ=\>\"", ",", "\[Nu]spZ"}], 
         "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:\[Rho]spZ=\>\"", ",", "\[Rho]spZ"}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:ds=\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"Q", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<BiSABRSpreadOption:\!\(\*SubscriptBox[\(d\[Alpha]\), \(11\)]\)=\
\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qs", "/", "Q"}], ",", 
            RowBox[{"Qb", "/", "Q"}], ",", 
            RowBox[{"Q1", "/", "Q"}], ",", 
            RowBox[{"Q2", "/", "Q"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:COV=\>\"", ",", "COV"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption:eigenvalues=\>\"", ",", 
          RowBox[{"Eigenvalues", "[", "COV", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<BiSABRSpreadOption: Det=\>\"", ",", 
          RowBox[{"Det", "[", "COV", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "\"\<spell\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Utilise", " ", "une", " ", "integration", " ", "numerique", " ", 
  "pour", " ", "le", " ", "calcul", " ", "du", " ", "z"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "K", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"favg", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"F1", "-", "F2", "+", "K"}], ")"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zavg", "=", 
      RowBox[{"BiSABRz", "[", 
       RowBox[{
       "favg", ",", "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
        "\[Rho]s", ",", "\[Beta]1", ",", "\[Beta]2", ",", "legendrelst"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b1", "=", 
      RowBox[{"BiSABRspreadCderivative", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Csecond", "=", 
      RowBox[{"BiSABRspreadCderivative2", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cfavg", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "favg"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ck", "=", 
      RowBox[{"BiSABRspreadC", "[", 
       RowBox[{
       "F1", ",", "F2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Beta]1", 
        ",", "\[Beta]2", ",", "\[Rho]s", ",", "X1", ",", "X2", ",", 
        "\[Alpha]sp", ",", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"Csecond", " ", "Cfavg"}], "+", 
       SuperscriptBox["b1", "2"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SqB0B\[Alpha]z", "=", 
      SqrtBox["Ck"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"intrinsec", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"F1", "-", "F2", "-", "K"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:X1=\>\"", ",", "X1", ",", "\"\< X2=\>\"", ",",
          "X2", ",", "\"\< z=\>\"", ",", "z"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:b1=\>\"", ",", "b1", ",", "\"\< b2=\>\"", ",",
          "b2", ",", "\"\< SqB0B\[Alpha]z=\>\"", ",", "SqB0B\[Alpha]z"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRSpreadOption:\[Alpha]=\>\"", ",", "\[Alpha]sp", ",", 
         "\"\< \[Nu]=\>\"", ",", "\[Nu]sp", ",", "\"\< \[Rho]=\>\"", ",", 
         "\[Rho]sp", ",", "\"\<  \[Mu]=\>\"", ",", "\[Mu]sp"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"SABRgeneric5", "[", 
       RowBox[{
       "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "zavg", ",", 
        "SqB0B\[Alpha]z", ",", "T", ",", "\[Mu]sp", ",", "\[Alpha]sp", ",", 
        "\[Rho]sp", ",", "\[Nu]sp", ",", "printflag"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", "==", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<BiSABRSpreadOption:res=\>\"", ",", "res"}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", "res", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRSpreadOptionVol", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
     "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
     ",", "printflag_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"NormalImplicitVol", "[", 
    RowBox[{
     RowBox[{"F1", "-", "F2"}], ",", "K", ",", "T", ",", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
      "implicitNormalvols"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001"}], ",", "T"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"BiSABRSpreadOptionVol", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NormalImplicitCorrelation", "[", 
      RowBox[{
      "\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
       "implicitNormalvols"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Debiaisage", " ", 
  RowBox[{"(", 
   RowBox[{
   "symetrisation", " ", "du", " ", "role", " ", "S1", " ", "et", " ", "S2"}],
    ")"}]}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRSpreadOptionCorrected", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "legendrelst_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "\[IndentingNewLine]", 
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", "\[Nu]2", 
       ",", "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
       "\[Nu]1", ",", 
       RowBox[{"-", "K"}], ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c21", ",", "\[Rho]c12", ",", "legendrelst", ",", "printflag"}], 
      "]"}], "+", "F1", "-", "F2", "-", "K"}], ")"}], "/", "2"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Extended", " ", "BISABR", " ", "spreadoption", " ", 
  RowBox[{"(", 
   RowBox[{"with", " ", "coefficients"}], ")"}]}]], "Input",
 Background->RGBColor[0.372549, 0.709804, 0.988235]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"compute", " ", 
   RowBox[{"E", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a1", "*", "S1"}], "-", 
       RowBox[{"a2", "*", "S2"}], "-", "K"}], ")"}], 
     SubscriptBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"a1", "*", "S1"}], "-", 
        RowBox[{"a2", "*", "S2"}], "-", "K"}], ">", "0"}]]}], "]"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralizedBiSABRSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "a1_", ",", "a2_", 
    ",", "legendrelst_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"BiSABRSpreadOption", "[", 
     RowBox[{
      RowBox[{"a1", " ", "F1"}], ",", 
      RowBox[{"\[Alpha]1", " ", 
       SuperscriptBox["a1", 
        RowBox[{"1", "-", "\[Beta]1"}]]}], ",", "\[Beta]1", ",", "\[Rho]1", 
      ",", "\[Nu]1", ",", 
      RowBox[{"a2", " ", "F2"}], ",", 
      RowBox[{"\[Alpha]2", " ", 
       SuperscriptBox["a2", 
        RowBox[{"1", "-", "\[Beta]2"}]]}], ",", "\[Beta]2", ",", "\[Rho]2", 
      ",", "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
      "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "printflag"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Application", " ", "numerique"}]], "Input",
 Background->RGBColor[1, 1, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TestCorrelation", "[", 
     RowBox[{
     "\[Rho]1_", ",", "\[Rho]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
      "\[Rho]c12_", ",", "\[Rho]c21_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Test Correlation : Eigenvalues=\>\"", ",", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "\[Rho]1", ",", "\[Rho]s", ",", "\[Rho]c12"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]1", ",", "1", ",", "\[Rho]c21", ",", "\[Rho]v"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]s", ",", "\[Rho]c21", ",", "1", ",", "\[Rho]2"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Rho]c12", ",", "\[Rho]v", ",", "\[Rho]2", ",", "1"}], 
            "}"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Simple", " ", "execution"}]], "Input",
 Background->GrayLevel[0.900008]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", 
      RowBox[{"-", "0.002"}]}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionCorrected", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00757654289844304`", ",", "0.007589450676546244`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.3881481805504236`*^9, 3.3881485054545937`*^9, 
  3.3881485477199483`*^9, 3.438081141342285*^9, 3.43808230947945*^9, 
  3.438083372315612*^9, 3.438085614254923*^9, 3.4380856798160267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.5"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", 
      RowBox[{"-", "0."}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0035"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOptionNormalCorrelation", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRSpreadOptionVol", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}]}],
     "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8147656089678607`", ",", "0.004461586575902286`"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[BoxData["Smile"], "Input",
 Background->GrayLevel[0.900008]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
          ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
         ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}]}], 
        "]"}], ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{
         "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{
  3.388148567172949*^9, {3.388148635406887*^9, 3.3881486512974105`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.43808570770151*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.438085707891225*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.438085708045154*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.8645184922281947`", ",", "0.8695172159508083`", ",", 
     "0.8743670616831829`", ",", "0.8790766770862387`", ",", 
     "0.8836545561721881`", ",", "0.8881090818288572`", ",", 
     "0.8924485304783195`", ",", "0.8966810308099487`", ",", 
     "0.9008144641056229`", ",", "0.9048562890212374`", ",", 
     "0.9088132691706357`", ",", "0.9126910783339546`", ",", 
     "0.9164937571409256`", ",", "0.9202229991009933`", ",", 
     "0.9238772562448456`", ",", "0.9274506792638926`", ",", 
     "0.9309319471237076`", ",", "0.9343030968617403`", ",", 
     "0.9375385294695825`", ",", "0.9406044265383875`", ",", 
     "0.9434588389207951`", ",", "0.9460526740954391`", ",", 
     "0.9483316971559674`", ",", "0.9502394883867671`", ",", 
     "0.9517211268011669`", ",", "0.9527272715881687`", ",", 
     "0.9532258225876741`", ",", "0.9532339533286935`", ",", 
     "0.9527461195628966`", ",", "0.9517666845880283`", ",", 
     "0.9503144661832967`", ",", "0.9484192657282366`", ",", 
     "0.9461184651652974`", ",", "0.9434538486089176`", ",", 
     "0.9404687613134889`", ",", "0.937205714173119`", ",", 
     "0.9337045241048997`", ",", "0.9300010333585886`", ",", 
     "0.9261263878072089`", ",", "0.922106798118906`", ",", 
     "0.9179636735351463`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADRCF2vIqrrP4cqusQV0+s/1B/UodD66z89
YFhpZSHsP/cRd+vlRuw/dYm3vGNr7D+FkHg48I7sP6q2yGqcsew/CR7j2njT
7D/toh0tlfTsP3pHqJD/FO0/LHOZ68M07T/1ET236lPtP0NOxYB3cu0/1t8i
CWeQ7T/I7AIMra3tP2hVdssxyu0/hFOym8/l7T8t+lnNUADuPxKRTnRuGe4/
qy5Jl9Aw7j9yEPFBEEbuPxpxIbe7WO4/XqW/pFxo7j+4vlDdf3TuP9RPL+e9
fO4/r++2cNOA7j8Sed995IDuP8Y7HW7lfO4/MUv3Z9907j/eiCXi+WjuPxxf
JlxzWe4/dtpAO5pG7j+78CEgxjDuP7kImPFRGO4/je5/1pb97T+ZDGVP6ODt
P9iu8IaRwu0/wwZzztOi7T8U4aod5oHtP7H7l1r1X+0/5WKy1g==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.3881485590480013`*^9, 3.388148568266692*^9}, 
   3.3881486533755226`*^9, 3.438085708048184*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.18022000000000205`", ",", 
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9cxK/TPo4p8z+9s+6rD0lk/d/nav5
cqZRmb3Nff/e6XmT9j/RNOSuPVlqP+eIwoaijIn7d0pOOlidWGr/Z+XHS75J
E/Z7cGvKlf4qsd8h1/o6cEff/scJnxXcppTYV75UM+RY07P/78R93Sf1Suyt
tpwo2ze/a//fv6e+Xz9ZbP8LbF3H/q1acV4eqcX2uzx5mLTb2/YfdKjZ+IGh
2B7ivpb9BmFNCSvmFEHd07R//TuvEC+LIqj9Dfs9VBeU7rxcaF8Btq9mf5FW
XdWzvEKo+RX7F39zfnyds9C+BmxeyX4Og6MhW5YUQPUX7O9IYvE5b19g/wOs
PmO/utCdiPzt+fY/wPIJ+/s4em/0fsqzZ1gF4gfsn/ZxUVSsMZAPBbE7GESZ
a3Nh8vbvjtxxSLucA9Nvv8R+ZbeYdQ7MfHu7l7xPhXZmw+y3X5GhY5oflA1z
n/3dnNqfd7mB8hD322cu/f5j4YssmP/sp6ywqOED8qH+t9+w5NjZTq5sWPjY
az4/r+non21fBQk/+4762dGvNmfDwtfe6HPKO23THFj420/7vvYN9/kcWPzY
t5b+XxsK9E8VJP7sA7bt2fzGOs9+FyR+7SsFDopwsOfb/4XEvz3jB+/2sNv5
9rMh6cNe6FGPLHt0gb01JP3YV129srzsVAEsfdlLySX/F7cuhMbvFHvHk8fq
HNYU2gMAEjxFtA==
        "]]},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->True,
      PlotLabel->FormBox["\"Implicit Normal Vol\"", TraditionalForm],
      PlotRange->Automatic,
      PlotRangeClipping->True], ",", 
     GraphicsBox[
      {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9Fzli1yutem1/+2dd1p6SyfvbtXYd
Eb382t7mvn/v9LxJ+6/IX1l44ddr+zlHFDYUZUzcb5sQkZmq+Mb+z8qPl3yT
Juz/Llj++qnbG/sdcq2vA3f07S/t3L4nOfuNfeVLNUOONT37WydUWHzoe2Nv
teVE2b75XftXbTuRNWfjG/tfYOs69nPKPb5VcfmN/S5PHibt9rb9bxfJ6k79
8sYe4r6W/VXuKyb8F3kLdU/Tfp3ima8Pm7yF2t+w/6ug7fZXwW/tK8D21ex3
9jvaUF70Fmp+xf5r95U40ye8ta8Bm1ey/8QbJp61a2H6C/ZnhJadNjz11v4H
WH3G/pbgTbPPPwXywfIJ+3V/RZ4NYHhnz7AKxA/YLzTRryRPEsiHgtV6ntMv
GMDl7YsEPjoKuL2D6beXKlTcvjviHcx8+7il+5fEZLyD2W+/Y1/A3fqSdzD3
2V/x13++twYoD3G//fr32wouN7yD+c9eqPJ+7ZMGmP4G+2PWsnlPgeqh4WNv
6P09/T7QvCpI+Nnf61B99BNoHzR87WXi1WKKI9/Bwt++7JaD9Syge6HxY7/7
g6LCMaB/qiDxZ7+TY8bHQAmgfkj82ve+q7827e9b+7+Q+LefyZPq/+LBW/vZ
kPRhf2Pdh7aJh97aW0PSj/1htuJzlxe9haUve5GHq2SfNb6Fxu8U+42/p0d9
jX9rDwAMY12J
        "]]},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->True,
      PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
      PlotRangeClipping->True]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.3881485594698734`*^9, 3.3881485686885643`*^9}, 
   3.3881486537973948`*^9, 3.4380857081178303`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Nouvelle", " ", "implementation", " ", "bas\[EAcute]e", " ", "sur", 
  " ", "normalheston"}]], "Input",
 Background->RGBColor[0.823529, 0.972549, 0.380392]],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "1"}],
  FontColor->RGBColor[0, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Theta]", ",", "S0", ",", 
      "\[Kappa]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "\[Mu]sp", " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
              RowBox[{
               SuperscriptBox["\[Nu]sp", "2"], " ", 
               SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
          SuperscriptBox["\[Alpha]sp", "2"]], "]"}], ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "8"}], ")"}]}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], 
          RowBox[{"2", "\[Lambda]"}]], "]"}], ",", 
        RowBox[{"100", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[Alpha]sp", "^", "2"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Lambda]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"printflag", ">", "0"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<BiSABRNormalHestonSpreadOption: \[Lambda]=\>\"", ",", 
         "\[Lambda]", ",", "\"\< \[Theta]=\>\"", ",", "\[Theta]", ",", 
         "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Alpha]sp=\>\"", 
         ",", "\[Alpha]sp"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"HestonNormalCall", "[", 
      RowBox[{
      "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
       SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4380827912939*^9, 3.43808286061928*^9}, {
   3.438082932774144*^9, 3.4380829370396876`*^9}, {3.4380829679922185`*^9, 
   3.4380829855387564`*^9}, {3.4380833318158712`*^9, 3.438083353206359*^9}, 
   3.438083385768651*^9},
 Background->RGBColor[0.94902, 0.843137, 0.615686]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",",
        "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", 
       ",", "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", 
       "Q1", ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", 
       "C2p", ",", "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb",
        ",", "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", 
       "\[Rho]b\[Alpha]1", ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",",
        "\[Nu]spZ", ",", "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X1", "=", 
       SuperscriptBox["F1", 
        RowBox[{" ", "\[Beta]1"}]]}], ";", 
      RowBox[{"X2", "=", 
       SuperscriptBox["F2", "\[Beta]2"]}], ";", 
      RowBox[{"\[Alpha]sp", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["X1", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]1", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["X2", 
           RowBox[{"2", " "}]], " ", 
          SuperscriptBox["\[Alpha]2", "2"]}], "-", 
         RowBox[{
         "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
          "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]sp", "=", 
       RowBox[{"\[Nu]BiSABR1", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "X1", ",", "X2", ",", 
         "\[Alpha]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
    "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Kappa]", "2"], "2"], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "\[Mu]sp", " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}], " ", "+", 
           RowBox[{
            SuperscriptBox["\[Nu]sp", "2"], " ", 
            SuperscriptBox["\[Alpha]sp", "2"]}]}], " ", ")"}]}], ")"}], 
       SuperscriptBox["\[Alpha]sp", "2"]]}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
    RowBox[{
    "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
     "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
     "\[Rho]2_", ",", "\[Nu]2_", ",", "\[Rho]s_", ",", "\[Rho]v_", ",", 
     "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Alpha]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Rho]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Kappa]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Kappa]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "printflag"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<\[Alpha]=\>\"", ",", "\[Alpha]", ",", "\"\< \[Nu]=\>\"", ",", 
        "\[Nu]", ",", "\"\< \[Rho]=\>\"", ",", "\[Rho]", ",", 
        "\"\< \[Kappa]=\>\"", ",", "\[Kappa]", ",", "\"\< \[Lambda]=\>\"", 
        ",", "\[Lambda]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"Strategie", " ", "2", " "}],
  FontColor->RGBColor[0, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
   RowBox[{
   "F1_", ",", "\[Alpha]1_", ",", "\[Beta]1_", ",", "\[Rho]1_", ",", 
    "\[Nu]1_", ",", "F2_", ",", "\[Alpha]2_", ",", "\[Beta]2_", ",", 
    "\[Rho]2_", ",", "\[Nu]2_", ",", "K_", ",", "T_", ",", "\[Rho]s_", ",", 
    "\[Rho]v_", ",", "\[Rho]c12_", ",", "\[Rho]c21_", ",", "printflag_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "intrinsec", ",", "z", ",", "b1", ",", "b2", ",", "SqB0B\[Alpha]z", ",", 
      "favg", ",", "zavg", ",", "Ck", ",", "\[Alpha]sp", ",", "\[Nu]sp", ",", 
      "\[Rho]sp", ",", "\[Mu]sp", ",", "X1", ",", "X2", ",", "Qs", ",", "Q1", 
      ",", "Q2", ",", "Qb", ",", "C1", ",", "C2", ",", "C1p", ",", "C2p", ",",
       "Q", ",", "COV", ",", "COV1", ",", "COV0", ",", "\[Rho]sb", ",", 
      "\[Rho]s\[Alpha]1", ",", "\[Rho]s\[Alpha]2", ",", "\[Rho]b\[Alpha]1", 
      ",", "\[Rho]b\[Alpha]2", ",", "N1", ",", "N2", ",", "\[Nu]spZ", ",", 
      "\[Rho]spZ", ",", "\[Lambda]", ",", "\[Kappa]", ",", "\[Theta]", ",", 
      "S0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X1", "=", 
      SuperscriptBox["F1", 
       RowBox[{" ", "\[Beta]1"}]]}], ";", 
     RowBox[{"X2", "=", 
      SuperscriptBox["F2", "\[Beta]2"]}], ";", 
     RowBox[{"\[Alpha]sp", "=", 
      SqrtBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["X1", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]1", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["X2", 
          RowBox[{"2", " "}]], " ", 
         SuperscriptBox["\[Alpha]2", "2"]}], "-", 
        RowBox[{
        "2", " ", "X1", " ", "X2", " ", "\[Alpha]1", " ", "\[Alpha]2", " ", 
         "\[Rho]s"}]}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]sp", "=", 
      RowBox[{"\[Nu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Rho]sp", "=", 
      RowBox[{"\[Rho]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp", ",", 
        "\[Nu]sp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Mu]sp", "=", 
      RowBox[{"\[Mu]BiSABR1", "[", 
       RowBox[{
       "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1",
         ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
        "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
        "\[Rho]c21", ",", "X1", ",", "X2", ",", "\[Alpha]sp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Kappa]", "=", 
      RowBox[{"2", "\[Nu]sp", " ", "\[Alpha]sp"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"\[Theta]", "=", 
      SuperscriptBox["\[Alpha]sp", "2"]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Theta]"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Lambda]2", "=", "0.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"S0", "=", 
      RowBox[{"F1", "-", "F2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Re", "[", 
      RowBox[{"HestonNormalCall", "[", 
       RowBox[{
       "\[Rho]sp", ",", "\[Lambda]", ",", "\[Theta]", ",", "\[Kappa]", ",", 
        SuperscriptBox["\[Alpha]sp", "2"], ",", "S0", ",", "K", ",", "T"}], 
       "]"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.438083427205886*^9, 3.4380834528464575`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]1", "=", 
      RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
     RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]2", "=", 
      RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
     RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]s", "=", "0.808"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]v", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c12", "=", 
      RowBox[{"-", "0.2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Rho]c21", "=", "0."}], ",", "\[IndentingNewLine]", 
     RowBox[{"K", "=", "0.0"}], ",", 
     RowBox[{"legendrelst", "=", 
      RowBox[{"LegendreCoeffs", "[", "10", "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BiSABRSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", ",", "0"}], "]"}], 
     ",", 
     RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "K", ",", "T", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "}"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.008895426691655233`", ",", "0.00895385030911113`", ",", 
   "0.008323357861024557`"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "30"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.4380834943620825`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 3.438085774098433*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 3.4380857741004457`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$26681"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$26681)],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 3.4380857741029177`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.010220202625056234`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.010858755238711893`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.010220202625056234`, "  \[Sigma]ATMnormal2=", 
   0.010858755238711893`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 3.4380857748476267`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.8671861963373699`", ",", "0.8679974523136006`", ",", 
     "0.868792519329466`", ",", "0.8695709157598699`", ",", 
     "0.8703321539228686`", ",", "0.8710757409677405`", ",", 
     "0.8718011798930735`", ",", "0.8725079706709811`", ",", 
     "0.8731956114862023`", ",", "0.8738636000703581`", ",", 
     "0.8745114351924252`", ",", "0.8751386182000065`", ",", 
     "0.8757446547111747`", ",", "0.8763290563882572`", ",", 
     "0.8768913428067899`", ",", "0.877431043404032`", ",", 
     "0.8779476995114112`", ",", "0.8784408664062913`", ",", 
     "0.8789101154497354`", ",", "0.8793550362080338`", ",", 
     "0.8797752385871939`", ",", "0.8801703549423286`", ",", 
     "0.8805400421398475`", ",", "0.8808839835380665`", ",", 
     "0.8812018909001675`", ",", "0.8814935061445286`", ",", 
     "0.8817586029798888`", ",", "0.8819969883586538`", ",", 
     "0.8822085037414494`", ",", "0.8823930261498057`", ",", 
     "0.8825504690041321`", ",", "0.8826807826934734`", ",", 
     "0.8827839549359093`", ",", "0.882860010853728`", ",", 
     "0.8829090128076748`", ",", "0.882931059974015`", ",", 
     "0.8829262876782551`", ",", "0.8828948664817237`", ",", 
     "0.8828370010748535`", ",", "0.8827529289283452`", ",", 
     "0.8826429187881252`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAADy+BlE/b/rP+9X1peixus/s/Ew+CXN6z+m
uZdihtPrP9AwONHC2es/BnR5O9rf6z+pKIiWy+XrP4T/8NWV6+s/ugFL7Dfx
6z/C8e7LsPbrP8gkxGf/++s/UFcUtCIB7D+sM3SnGQbsP3sbtzvjCuw/ogXw
bn4P7D+QS31E6hPsP4//H8YlGOw/6uoVBTAc7D/IXT8bCCDsP8zDQiytI+w/
xwCyZh4n7D85WiwFWyrsPzTkeU9iLew/5bebmzMw7D/W3dJOzjLsPzbekN4x
New/GX1Y0V037D8aeIW/UTnsP+VS+lMNO+w/OwWxTJA87D+UJi572j3sP6E8
z8TrPuw/vEP8IsQ/7D/TAzKjY0DsP5FI62bKQOw/lsBmo/hA7D/aakuh7kDs
P50MK7ysQOw/ORbqYTNA7D8rQQYSgz/sPx+2x1ycPuw/J7SosA==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.4380834773152075`*^9, 3.4380834952214575`*^9}, {
  3.4380857571289263`*^9, 3.4380857748508263`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7748719999999949`", ",", 
   GraphicsBox[
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n35Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/5o8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7LxhYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2t/z/cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/oXIk/f9vmHua9geEi2xRYnwDtb9h/xrjkuWSbG/sK8D21eyv
lt5u/ZjrDdT8iv2LWD/k1fG/sa8Bm1eyf4J3rcsrYZj+gv39/+WPqUq8sf8B
Vp+x/9UrUVYDGSAfLJ+w/0SsvTSHwht7hlUgfsD+M4eddNYqA/lQcJxhU5qc
Olze3jJKhzVaC67f3uRJpX+SLtx8+6fbZ882NoDbb3/t7iW/c0Zw99mb3Ztw
z9AUKA9xv71kbcTFWHO4/+ylKlr3B1rC/W//NOhXMK/1G1j42FuzbvSZYPPG
vgoSfvZT1PSqb9m+gYWv/UKb80de28HCp8N+j/MfpSP2b2DxY3+Z2WhxsgNQ
PyT+7Cd6vE47BeTvgsSv/bQDaYt/APl/IfFvfyvLe+E7IH82JH3Yz+XR3rMG
yLeGpB97S7FXicZAPjR92Ws7sgk1A+2Dpj97+W3HY+YA3QMAsPZTYw==
      "]]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRangeClipping->True]}], "}"}]], "Output",
 CellChangeTimes->{{3.4380834809558325`*^9, 3.4380834963777075`*^9}, {
  3.438085759101242*^9, 3.4380857748561373`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{"BiSABRNormalHestonSpreadOptionComputeParameters", "[", 
      RowBox[{
      "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", "\[Nu]1", 
       ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
       "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", "\[Rho]c12", ",", 
       "\[Rho]c21", ",", "printflag"}], "]"}], ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitNormalvols"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "\"\<Implicit Normal Vol\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\[Sigma]ATMnormal1=\>\"", ",", "\[Sigma]ATMnormal1", ",", 
       "\"\<  \[Sigma]ATMnormal2=\>\"", ",", "\[Sigma]ATMnormal2"}], "]"}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<implicit correlation=\>\"", ",", "implicitcorrelations"}], 
      "]"}], ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.4380835046902075`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.43808578112087*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.438085781122747*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Alpha]=\"\>", "\[InvisibleSpace]", "0.0041315812903778585`", 
   "\[InvisibleSpace]", "\<\" \[Nu]=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`", "\[InvisibleSpace]", "\<\" \[Rho]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}], 
   "\[InvisibleSpace]", "\<\" \[Kappa]=\"\>", "\[InvisibleSpace]", 
   "0.0026301956208849187`", "\[InvisibleSpace]", "\<\" \[Lambda]=\"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$32710"}]}], ")"}]}]}],
  SequenceForm[
  "\[Alpha]=", 0.0041315812903778585`, " \[Nu]=", 0.31830374813276047`, 
   " \[Rho]=", -0.1166587353908298, " \[Kappa]=", 0.0026301956208849187`, 
   " \[Lambda]=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$32710)],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.438085781125614*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Sigma]ATMnormal1=\"\>", "\[InvisibleSpace]", 
   "0.007236307082792201`", 
   "\[InvisibleSpace]", "\<\"  \[Sigma]ATMnormal2=\"\>", "\[InvisibleSpace]", 
   "0.007413518035210933`"}],
  SequenceForm[
  "\[Sigma]ATMnormal1=", 0.007236307082792201, "  \[Sigma]ATMnormal2=", 
   0.007413518035210933],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.438085782396525*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"implicit correlation=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.7329452356224138`", ",", "0.7366278726449398`", ",", 
     "0.7402754620240658`", ",", "0.7438845993757446`", ",", 
     "0.747451557837655`", ",", "0.7509722617641598`", ",", 
     "0.7544422597766575`", ",", "0.7578566980017771`", ",", 
     "0.7612102940499842`", ",", "0.7644973129691721`", ",", 
     "0.7677115467289758`", ",", "0.7708462975016053`", ",", 
     "0.7738943692410436`", ",", "0.7768480677845266`", ",", 
     "0.7796992133066234`", ",", "0.7824391681176202`", ",", 
     "0.7850588831199719`", ",", "0.7875489661734003`", ",", 
     "0.7898997754994498`", ",", "0.7921015401976008`", ",", 
     "0.7941445092078206`", ",", "0.7960191274279995`", ",", 
     "0.7977162362033088`", ",", "0.7992272918562047`", ",", 
     "0.8005445936699145`", ",", "0.8016615092398296`", ",", 
     "0.8025726842007613`", ",", "0.803274221425358`", ",", 
     "0.8037638168116656`", ",", "0.8040408403624433`", ",", 
     "0.8041063562694951`", ",", "0.8039630799395857`", ",", 
     "0.8036152760775339`", ",", "0.8030686058671125`", ",", 
     "0.8023299354441954`", ",", "0.8014071209985787`", ",", 
     "0.8003087795131458`", ",", "0.7990440670253651`", ",", 
     "0.7976224658462632`", ",", "0.7960535941385506`", ",", 
     "0.794347040698086`"}], "}"}]}],
  SequenceForm["implicit correlation=", CompressedData["
1:eJwBVQGq/iFib1JlAQAAACkAAACmOxiRSXTnP1Cgyp10kuc/wZZtKlaw5z/s
I0oT583nPzA5iIcf6+c/8V0P+/YH6D8rwQ4YZCToPxwcn7BcQOg/3VfKsNVb
6D+ao6IRw3boPwXNPs4Xkeg/+GLA2sWq6D/SXM4fvsPoP/gMo3rw2+g/1M27
w0vz6D+GlsXdvQnpP/bnjc4zH+k/4tO245kz6T+Badzk20bpP05RSFTlWOk/
1Q7rvqFp6T8cZuka/XjpP9BnPzPkhuk/PPoSHUWT6T8YqRmyD57pP8y0lAk2
p+k/P8Tp6Kyu6T+fvNcjbLTpP3JBXeVuuOk/YClA27O66T/T3NVAPbvpP8UF
8ccQuuk/aDUqYje36T8PmNTuvLLpPyG1KtSvrOk/mg3viyCl6T+IvVYoIZzp
PxD6/dzEkek/nqqrjB+G6T/RBhZjRXnpPwkgL3xKa+k/tZOxFA==
   "]],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835053464575`*^9, 3.4380857823996553`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3108289999999982`", ",", 
   GraphicsBox[
    {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9y6wlJnqWPLe//bMua0/J5P0BC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvYNnRLv/6uf0OudbXgTv69n+M5f/9jf2FfeVLNUOONT37tQ/ySaSovLC3
2nKibN/8rv0yMvM3xDi8sP8Ftq5j/93wUxuuRr+w3+XJw6Td3rZ/1uJFgofL
XthD3Neyn/Ws3TnxiS+g7mna/yPpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+6+c3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8X6BHyNALIh4KrfK/3
LcyEy9vLpL2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffZn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/3lO1cdbHe/hIWv/VHWj8cFgPLQ8LfPMNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97gV9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2nAr6NV7Z
L+0BsDRbxw==
      "]]},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->True,
    PlotLabel->FormBox["\"Implicit Normal Correlation\"", TraditionalForm],
    PlotRangeClipping->True]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835073464575`*^9, 3.4380857824060087`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
      RowBox[{"F1", "=", "0.0418`"}], ",", 
      RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
      RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819`"}]}], ",", 
      RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
      RowBox[{"F2", "=", "0.0363`"}], ",", 
      RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
      RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136`"}]}], ",", 
      RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
      RowBox[{"T", "=", "10"}], ",", 
      RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
      RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3`"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F1", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
            "\[Nu]1", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"F2", " ", 
         RowBox[{
          RowBox[{"SABROption", "[", 
           RowBox[{
           "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
            "\[Nu]2", ",", 
            RowBox[{"{", 
             RowBox[{
             "method", ",", "zmethod", ",", "zetavmethod", ",", "favmethod"}],
              "}"}], ",", 
            RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "}"}]}],
      ";", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x1", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
     RowBox[{"\[Rho]c21x2", "=", 
      RowBox[{"-", "0.3`"}]}], ";", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
          "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitNormalvols", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitVol", "[", 
         RowBox[{
          RowBox[{"F1", "-", "F2"}], ",", 
          RowBox[{
          "strikevalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "T", ",", 
          RowBox[{
          "callvalues", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"implicitcorrelations3", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"NormalImplicitCorrelation", "[", 
         RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
          RowBox[{
          "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"1", " ", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], "]"}]}],
      ";", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
          "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
         RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
          RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
           "\"\< \[Rho]c21=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.4380835187370825`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789405713*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085789407619*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001416`", ",", 
     "0.4918880776877218`", ",", "0.06921597823402081`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001416`, 0.4918880776877218, 0.06921597823402081}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085790702512*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9307840217659755`", ",", "1.5081119223122788`", ",", 
     "0.47060169289985865`", ",", "0.0905023630218846`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9307840217659755`, 
   1.5081119223122788`, 0.47060169289985865`, 0.0905023630218846}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380835201120825`*^9, 3.438085792344246*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.408179000000004`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{
        {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9y6wlJnqWPLe//bMua0/J5P0BC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdhvYNnRLv/6uf0OudbXgTv69n+M5f/9jf2FfeVLNUOONT37tQ/ySaSovLC3
2nKibN/8rv0yMvM3xDi8sP8Ftq5j/93wUxuuRr+w3+XJw6Td3rZ/1uJFgofL
XthD3Neyn/Ws3TnxiS+g7mna/yPpwK2jq15A7W/YfynmnPy+wy/sK8D21ez/
wbO46sNtmPkV+6+c3X3Y+/ML+xqweSX726YdvbuX8yVUf8H+b897zxnLv7T/
AVafsf/R5W2PZxoD+WD5hP2NmXee3HZ7ac+wCsQP2O8X6BHyNALIh4KrfK/3
LcyEy9vLpL2U+lsB129/Id3e+Ekb3Hx7m19Csq6T4fbbS6yU3MQ/7yXMffZn
tkzhNFsOlIe4397+yMsXa9a9hPnPfv6e68o5W2D6G+yLHGOf5u14CQsf+wRN
h9ubd720r4KEn/3lO1cdbHe/hIWv/VHWj8cFgPLQ8LfPMNVKMt/+EhY/9vwz
rrzbswmoHxJ/9opbta6sXwPUD4lf+1m877sVlr60/wuJf/uOvWEainNe2s+G
pA97gV9/7xyZ+NLeGpJ+7OetWt0jD/Q/NH3ZX2QTS3atfAmN3yn2nAr6NV7Z
L+0BsDRbxw==
          "]]}, 
        {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9q542CPlIPbW//bMua0/J5P13Nx36
keD51N7mvn/v9LxJ+3fO3i1VWPHUfs4RhQ1FGRP3X7rKk1e1/Kn9n5UfL/km
TdgvVf1madW1p/Y75FpfB+7o25/lxK2dz/rMvvKlmiHHmp796muLhUJNntlb
bTlRtm9+1361hfrCmsnP7H+BrevYn/RqV9Xzic/sd3nyMGm3t+2vvZiv0HPg
mT3EfS379cIvhwm9fwZ1T9P+ut1PbpfIPofa37B/zwGf42u9n9tXgO2r2W96
73jZtsrnUPMr9reXra5oX/7cvgZsXsl+zl2BJRJXYfoL9ivtmiiQwPTC/gdY
fcb+1K12N4L1gXywfML+O6vZZF9Ev7BnWAXiB+yXDXt7g78DyIeC0Kd2/Xs2
w+Xt9729oXvvHly/fd4K6Q9JnC9h5tt3Pl3ham78Ema//YFV4ftdY17C3Gef
uvsYa3kLUB7ifnv//kN3N65+CfOf/f0fkva3L8L0N9ifODSr+dq3l7Dwsf/4
ddbmVqlX9lWQ8LOvuBX+9aTNK1j42ps8KlNqiX0FC3/7ktx5LVNrXsHix35a
ZdfWBzOB+iHxZ39zz9OZXluB+iHxa98YGZix+9wr+7+Q+Lf3m1+8Qv7ZK/vZ
kPRhv/2LqHDm71f21pD0Y/+76L51P99rWPqyr5r17GO//Gto/E6x79++2jtf
77U9ADYYXI8=
          "]]}, 
        {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT96nVhEjObX9nf/lmXtadk8v43MrpL
DXpe2dvc9++dnjdp/zRe4wcvJr+yn3NEYUNRxsT9sdkKfOtmvbL/s/LjJd+k
CftVIuINsxe8st8h1/o6cEff/rNHXRS4lr6yr3ypZsixpmf/2amXthSveGVv
teVE2b75XfvTd3zmnbDqlf0vsHUd+036Lz9zW/3KfpcnD5N2e9v+Ur0Ejgag
PMR9LfvZTZMuKq+Auadpv7RG3BXpJTD7G/YnPv7cEjzvlX0F2L6a/b8jpd/s
mAYzv2K/3sRN4ba9r+xrwOaV7Fddy/rjaiNMf8H+V8mTY2tKXtn/AKvP2J8g
pXRaLxXIB8sn7I+fvC74Q/Are4ZVIH7Afv9THAdPOAD5UHB8arbrEW24vH06
073/n0Tg+u1VTS/GZfx5CTPfPu71sTyrRy9h9tvbtDYoNR57CXOf/UTejwtC
VwLlIe635+gVW3Sx6yXMf/ahSoIP+bJh+hvs48+XLVPzegkLH/u67r3Zhhov
7asg4WefIWI1zY31JSx87a2rm9xrHr6Ahb+91rXH9s/3vIDFj/2sbyvOz5r+
wr4KEn/2n/5mXFlR+MJ+FyR+7V07Du9T9H5h/xcS//bl++7NE1F5YT8bkj7s
K15bmfb/eW5vDUk/9u7p7mzzrjyHpS/7vScn5vuseQ6N3yn2V25V7V3S/Nwe
AH21VMM=
          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox[
        "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
       PlotRangeClipping->True], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
       {GrayLevel[0], 
        RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
        GraphicsGroupBox[{
          RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
           GraphicsBox[{{{InsetBox[
                GraphicsBox[{
                  {RGBColor[0, 0, 1], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
                GraphicsBox[{
                  {RGBColor[0., 1, 0.], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002`, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
                GraphicsBox[{
                  {RGBColor[1, 0., 0], Thickness[0.01], 
                   LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
                 PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
            AspectRatio->1.0952380952380953`,
            FormatType->TraditionalForm,
            
            PlotRange->{{-0.1, 3.26}, {-0.1, 
             3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
           Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.4380835274089575`*^9, 3.43808579513346*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
      RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
      RowBox[{"favmethod", " ", "=", "\"\<Arithmetic\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"F1", "=", "0.0418"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]1", "=", "0.0435"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]1", "=", "0.6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]1", "=", 
       RowBox[{"-", "0.1819"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]1", "=", "0.3798"}], ",", "\[IndentingNewLine]", 
      RowBox[{"F2", "=", "0.0363"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]2", "=", "0.0671"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Beta]2", "=", "0.7"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]2", "=", 
       RowBox[{"-", "0.1136"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]2", "=", "0.3797"}], ",", "\[IndentingNewLine]", 
      RowBox[{"T", "=", "10"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]s", "=", "0.8"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]v", "=", "0.5"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c12", "=", 
       RowBox[{"-", "0.3"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Rho]c21", "=", 
       RowBox[{"-", "0.3"}]}], ",", 
      RowBox[{"legendrelst", "=", 
       RowBox[{"LegendreCoeffs", "[", "20", "]"}]}], ",", "callvalues2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<money=\>\"", ",", 
       RowBox[{"F1", "-", "F2"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"TestCorrelation", "[", 
      RowBox[{
      "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
       "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"strikevalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"-", "0.020"}], ",", "0.02", ",", "0.001"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRNormalHestonSpreadOption2", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}],
            "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"callvalues2", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"strikevalues", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"BiSABRSpreadOption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
             "\[Rho]2", ",", "\[Nu]2", ",", 
             RowBox[{"strikevalues", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "T", ",", "\[Rho]s", ",", 
             "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", 
             "legendrelst", ",", "0"}], "]"}], "-", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"F1", "-", "F2", "-", 
              RowBox[{"strikevalues", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], "}"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"callvalues", ",", 
          RowBox[{"PlotLabel", "->", "\"\<Heston BiSABR\>\""}]}], "]"}], 
        "\[RawEscape]"}], "]"}], "\[RawEscape]"}], ";", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"callvalues2", ",", 
         RowBox[{"PlotLabel", "->", "\"\<BiSABR\>\""}]}], "]"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<correlation \[Rho] spread=\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Rho]", "[", 
         RowBox[{
         "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
          "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
          "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
          "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Nu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Nu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Mu] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Mu]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\[Lambda] spread=\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"BiSABRNormalHestonSpreadOptionCompute\[Lambda]", "[", 
        RowBox[{
        "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
         "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
         "\[Rho]2", ",", "\[Nu]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
         "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}]}], "]"}]}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.438085824272683*^9, 3.438085866155608*^9}, {
  3.438085901336306*^9, 3.4380859221525373`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085924519638*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233638`", ",", "1.1794737833590507`", ",", 
     "0.5621491608076291`", ",", "0.1355382895996812`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233638, 1.1794737833590507`, 
   0.5621491608076291, 0.1355382895996812}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380859245210667`*^9}],

Cell[BoxData[
 RowBox[{"\[RawEscape]", " ", 
  GraphicsBox[
   {Hue[0.67, 0.6, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DeVtBcXRBva3f9Zl7SmZvJ9BceNV
16lG9jb3/Xun503a3xD/+W6BlKn9nCMKG4oyJu53KN4oWfrF3P7Pyo+XfJMm
7D/gdrnzla61/Q651teBO/r2M1y7vX/mJTv7ypdqhhxrevYnnO1ceqrc0d5q
y4myffO79i+oep+88qSz/S+wdR37HWqDwx6mudnv8uRh0m5v298QcPCqUYSn
PcR9Lfs3/N0mob/cB+qepv0aora88voBUPsb9ivEzPYKcAmyrwDbV7OfQbsy
zWxmCNT8iv0OT7USnUzC7WvA5pXsd/hmouokEwXVX7D/RGn9oaCIWPsfYPUZ
+y/8Kpz0rDzB/gdYPmF/SJpKjFhpkj3DKhA/YP+S9buvly9PsWeAgpZUj+Yd
QukweftluQH5cbsyYfrt5S5eMt+wMAdmvv28rYr7Zp/Oh9lvf1nSpcxvbiHM
ffZbW1PZgyuK7f9A3G9vwlb42zq7GOY/e4aLPBtjygph/rdfJDd721vvfFj4
2BftOs7u8znbvgoSfva9KRf+hj/MgIWvvcl/h6p3wmmw8LeffWFhZURHMix+
7N15rfcnWSfaV0Hiz779RIPIx6A4+12Q+LWX5elkqJ8bZf8XEv/2jvH8Rml+
4fazIenD3m1jpVNNbIi9NST92KfJPJiy6FAgLH3Z8/bdmXDjtR80fqfY/6r3
/lJx38seAHHqOnQ=
     "]]},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   PlotLabel->FormBox["\"Heston BiSABR\"", TraditionalForm],
   PlotRange->Automatic,
   PlotRangeClipping->True]}]], "Print",
 CellChangeTimes->{3.4380859253170757`*^9}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9DXYi87mSXexv/6zL2lMyef8B77iN
62td7W3u+/dOz5u0/0CF45WKrW72c44obCjKmLi/QaT18mxeD/s/Kz9e8k2a
sN/hWUHkjk5P+x1yra8Dd/TtX3DPVOKprrd95Us1Q441PfsVkrMX7/vnY2+1
5UTZvvld+w9cFFCvYPS3/wW2rmO/wo986e9zA+x3efIwabe37d/Q6M0cdyvQ
HuK+lv0eFzbuX2kZDHVP0/6Ab0L5PAdCoPY37A+YzJPjWBRmXwG2r2b/jdqH
EQtCI6DmV+y/MSFWyqQgyr4GbF7J/gcxb95dOxED1V+w32HCnbMh6fH2P8Dq
M/abPPQN9dJKtP8Blk/Yv2fuq8PJZ5PsGVaB+AH79zhERp1ZlGLPAAUZioqG
WhvTYPL2dZuuFPz4nwHTb58xlz8/b3o2zHx7iwlPec0b8mD222e+Y/9d/LAA
5j77P9bcM2duLrL/A3G//Z1O3vzJa4pg/rPvYJsQX3OqAOZ/+3zhIxMUjfJg
4WOf8t+63083274KEn728t2757Q2ZMDC137R9pd7JFTSYOFvf3lFxoWJ/Cmw
+LFP+996u8Aqyb4KEn/2PprPHq+dk2C/CxK/9tXnReWY4+Ls/0Li3/7Skrr9
TNei7WdD0od90UaWQttpkfbWkPRj38Cm7q09NRyWvuw7WkszV54KhcbvFPso
Rw/x4/oh9gDxVT2W
    "]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotLabel->FormBox["\"BiSABR\"", TraditionalForm],
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Print",
 CellChangeTimes->{3.4380859253223343`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"correlation \[Rho] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "0.1166587353908298`"}]}],
  SequenceForm["correlation \[Rho] spread=", -0.1166587353908298],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380859253608723`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Nu] spread=\"\>", "\[InvisibleSpace]", 
   "0.31830374813276047`"}],
  SequenceForm["\[Nu] spread=", 0.31830374813276047`],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380859254036293`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Mu] spread=\"\>", "\[InvisibleSpace]", 
   "0.000781149540185173`"}],
  SequenceForm["\[Mu] spread=", 0.000781149540185173],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085925435834*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda] spread=\"\>", "\[InvisibleSpace]", 
   RowBox[{"58582.43183183385`", " ", 
    RowBox[{"(", 
     RowBox[{"1.7294822510305506`*^-6", "-", 
      RowBox[{"0.000034139927918000744`", " ", "\[Mu]sp$87258"}]}], ")"}]}]}],
  SequenceForm[
  "\[Lambda] spread=", 
   58582.43183183385 (1.7294822510305506`*^-6 - 
    0.000034139927918000744` $CellContext`\[Mu]sp$87258)],
  Editable->False]], "Print",
 CellChangeTimes->{3.438085925468875*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8601619999999954`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.4380859255048656`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Rho]", "=", 
       RowBox[{"-", "0.11665"}]}], ",", 
      RowBox[{
      "\[Lambda]v", "=", "\[InvisibleSpace]\[InvisibleSpace]", 
       "0.09975497699499274"}], ",", 
      RowBox[{"StdDev", "=", "0.00413158"}], ",", 
      RowBox[{"\[Kappa]", "=", "\[InvisibleSpace]", "0.00263019"}], ",", 
      RowBox[{"S0", "=", "0.005"}], ",", "V", ",", 
      RowBox[{"\[Tau]1", "=", "3"}], ",", 
      RowBox[{"\[Tau]2", "=", "10"}], ",", 
      RowBox[{"\[Tau]3", "=", "30"}], ",", "Vinfini"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"V", "=", 
      SuperscriptBox["StdDev", "2"]}], ";", 
     RowBox[{"Vinfini", "=", 
      FractionBox[
       SuperscriptBox["\[Kappa]", "2"], 
       RowBox[{"2", "\[Lambda]v"}]]}], ";", 
     RowBox[{"Plot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]1", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]1"}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]2", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]2"}], "]"}]}], "]"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{"S0", ",", "k", ",", "\[Tau]3", ",", 
           RowBox[{"HestonNormalCall", "[", 
            RowBox[{
            "\[Rho]", ",", "\[Lambda]v", ",", "Vinfini", ",", "\[Kappa]", ",",
              "V", ",", "S0", ",", "k", ",", "\[Tau]3"}], "]"}]}], "]"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{
          RowBox[{"-", "8"}], " ", "StdDev"}], ",", 
         RowBox[{"8", " ", "StdDev"}]}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "1", ",", "0"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.5", ",", "0.5", ",", "0."}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0", ",", "0.5", ",", "0.5"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"0.5", ",", "0.", ",", "0.5"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegend", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]1", "]"}]}], ",", 
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]2", "]"}]}], ",", 
          RowBox[{"\"\<T=\>\"", "<>", 
           RowBox[{"ToString", "[", "\[Tau]3", "]"}]}]}], "}"}]}], ",", 
       RowBox[{"LegendPosition", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0."}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "->", "\"\<NormalHeston: imp. vol.\>\""}]}], 
      "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4380835763464575`*^9, 3.4380836581902075`*^9}, {
  3.4380836916589575`*^9, 3.4380837012527075`*^9}, {3.4380841849089575`*^9, 
  3.4380842056902075`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25.375403`", ",", 
   GraphicsBox[{InsetBox[
      GraphicsBox[{{}, {}, 
        {RGBColor[1, 0, 0], LineBox[CompressedData["
1:eJwt13k4lGvcB3CnaOOUNsnyIkmnk3KizfaVopRS2SrZskfqmXmMsYyZsaVB
JLIzLbKUpUVOWSbSSmSniBZKKEelQvXe3uv9Y665PjPXPPPc93Pf39/vVjly
fL/rNDExsVHymnovvyUXZjIkFKVLT/b/y2KDfX18U+aAUGRp1WZU68uGVuHz
4a/9QlHOE+PEbpqN/OxUm+xXQlF8+UvFaUw2UhLk/hZvF4oyOUpFO4+zwWLI
NVVVCUUPA/I2PXdnQ3ONnLJ+klBkI5RUHD3AxqXspeVaRkIRA0dWSeiy4dDR
7pm9MEuUz41kZP7ww6vJqk0WZRkinZUdKu/L/FB9t1y+2jNddKJPuuBJsB8+
aNnzEiZSRe2hO3ye6vqBY2Bc3ZadIuqtNqkXTrJg870pPEgrWSTx8Ok9RikL
cfsouzcPz4myRys21zNY0DayWnCHThQd9V/lqbqOBaXXPTu+iCeIskL9zlgN
+sJ3afHhzIJ4kZKn+XhGri9WjcSFzbY7I0o77zSS5+YLsyHNw8U9saJdb4r/
FPyPL+TUaz01NsSI7tSZKz14ToN193oAZSEQaUgelnsfRyMuuezGxuCTosKf
69fI76DByzLP6e4ME105lfJcUZzGL/F/MndO8kWyfCUz3h0mLq3TzVqTFSyK
GP7I0WQx4SlbNMu6mS3qOmu9WEKDibxA12r+MqbIcZqqREo/A6v8XV53XvYS
BcR3+9ZfZkDXV2t3naqjSKFEtjHThYHo6+WRY3HGoiA7HaXcVQx8DTU8r5K4
DWUL7bcmjVFYrbJ4yywzY5QJ85KqvlI4UjnQ+3GaCRw9/7Yb+kKh/nu8cvmJ
7bD1PqW/9TOF3GN9WdZmOzH+X5nD2CcKhX8bN9z/Yy9+OpQJGAMUnBZ/eDr+
rxU+V3eE3++i4PIlxfX6WUdI1v1z9mMNhRqP/vn2lY4o7268v414efe6ytkD
jjjyw5KZdo9C3/1aGScDJ8xoPGa4s5qCW9LPh/MGnFDqVHO1QETBQ8dp1TED
Z/yhUqMQfYeCN2/lJ/UBV0w3KHycV0yh7gud1rzQDX+wxySkiVd7Vm3nGrjh
7TGdR6wiCsP7DgnbzrrB1Gper3EhBR/V6H3hBu6YHWvj9uEKhRMPPt14fdYD
F7pkZHfnUKClStkZBl5oM544FJhJYSi//maXtxdO7WiOf5dBwdm0f0Q+zQv7
Is1oS+L9EYs9U795wbyufL1mOoW1YvTBpGJvqPWEV3xKofDhs6bOmWU+iDlQ
uSE2kULxsVaOUegJJJWNeuyPIdfXeyV/JPUEHK4axLVEU1CXGr7Nv3YCFXZD
3jbEmfniY3d7ToBx/N52hygKMe+0fKBHQW1hZrTfKQpHneLt9chzVA9akPYk
nHxuZY4N7kwo1jYMTgaT7+Xk6gY4TCgYVGxMJi7ueXsgI4GJp+nXdLWJ9Y4G
MMSrmUg4l+Ptw6Fgwc3OblKgURt/3H8wkAI/b0LyeBONRdwgapY/hQc+D5KX
DdBYx087WMSmIKV9Rq3tN43jrhY/rYmTK1dAX8MX3g3e7Fw/CkXN+xiSkb5I
FJ03smRR6P6Z05Gjz0LjC/+9DUwKy+4xXG0tWdgR9mtWCLFHpP7oXC8W0v2n
89YTf1nQLMlKZuH9L438TAYFyZW/DLZ9ZmGcWv/Zn6Kweb9ldm+uH3wXW/pZ
HqcQvERpXYLID0khs/9aSFzTNVC5vc0PzYfc05p8KOx153YUTmfj2bOoagti
96B8SY49GwluBxUdjlFIvCzGWLrIH//8K1ia6kXW84JvYiZ/+WMw4+FxD2Lt
4OFYhoE/3vS0+GwkbrJ6XlDr4Y/ikXj39qMU5krcHOBU+GOzefc2JeLuE/ns
/CZ/RJm8ej3qSeFql3Bm+zt/qMtKrnpIvPNmjJrmggAkln26QRFHOLs7vXYL
QJKo9Fa9BwWrBruRuUEBeG+fl5lDvFzXkqt7JgDyu0bW8omrF2zJSCgLgJm+
YM8G4l9Vcp0m0oFQv68alOtO4anGfA+mWiCW1n8vjCBOT5n5LUsnEByb1VGu
xDrUl0U/XAJhhlyoEfsp1++9cjsQ87MuJ191o2ASXdPTXh8I3QpVmThime93
fMTfBiI56bUeTXyzISfabm4QnF9LRhgQjwTzH81zDsKp4E0zXrhSEH3ws9Fj
B2HZ3s9194hPW/v0e8QEofV2sV4B8eo1tuLVpUFItf4qE0Ls0a1tSEtxcPGX
V4kW8UbTvxuEKhxw6huqVYhnlKjYP93AwVHTh2xp4kvRc4NWOHFgp6n/8pML
BeZ3cUkLFge5lzJieomNXCZSuFEcGPua9zUS9+q+L+0o4SA20CfmFnFRzksT
iVoOnn0t7s4jDl7Y2vpPLwfl4z9bM4h3c2td7L9yUKC6lRVPrDBY9VkwJxiy
i10qTxIPWv8bUqoUDL0dXoUc4jvVhfPfagejI2rUmCY+mJq2Vt8hGGqyX72c
ibXT/CK0WMFImaPvZEs8N92i+6+YYNROzJa3JB5IX6utfCkY8vvDUnYT12RI
RsmUBUOpNqprO3Fm5rtXUk3BaHD6/caI2D/r3qbpA8HYaF5RZEBsKcyK/fE7
GFI5l6FLvOZ8YP8nGS7+dRmP20Q864KNfr8GF4r/2V7ZQPzmglZC1zYupp18
HbGeuPLivMEmWy4CTX+rTTn50uCWxwwujL9ERU6Zkf0wWXSKi1/hToVTv999
+eKnEiEX0lsOJE1df2UO1+RqKRfOV7dvnfr/abm2GRfquVieMOP61P115W78
ktzHxdk5Xv93/6V5C3fFTnLR6LGzfWp8pq3fnlXP5iHO3D9mavy3Wl0n9Rfz
IJtbKzE1P8vbmtVvK/Pw8dIiw6n5O9O2xUJ7NQ/XqlfoTc3vr7ai4KKNPMg9
bv7hRezdrpi/aisPybVDbF/izvao1uw9PDivMrrNJTbp+CGmcogHnbMX7wiI
VTpbbZZQPBjeu//7AvHpzq2h8UE8dFHLthYTT3ZeK/wzkod5E9UmlcRtz2Mk
xLN4yBv6HdNFvPXFhCY3nwfVp+sah4iLX3geHi/hwSigrfkncVSX8Y2ROh4C
WhJllpH1+73rxkuvDh6O5BpZryd261aZ8+4NDzXJIZamxIYvfzp2j/NQOdIW
xSQufOkVfWAGH2t2+9WcIpbv6Sxtns/HvWvVd4TEYz0lc5+s5EOS49XzjPjK
q2Plt6z5CGMdmKZD9qfs6xfv/jnCx/q+XBVr4ojXpgsLjvGhfvD6JIPY8Y3a
0YthfCRYifUVTu33vu4lcdf5YDPX+60l+cB7v5vpOTcEHCHLzYLkzbryRiWV
pSFYOVDrxyZ+G2tV16EagjqdnysziXdstFPbsTkEsBU/OkgsHeHdvsIlBDt+
iTnGkLwTqkbpvr0dQsa1v+8jycv93+a+T6sJwa2GkHZFkq/itfEJFg0hsD6V
67qb2IOROlz9NgR7p4ssC4k1q/Kyzs8LRcuSOpafN8kb+0fTHVxDobxo9PQK
ku8n1pkVy5wIxYfVqcoOxMtmPDtcHxCKjyPDpsnEEQXtJfpxodiiFnREitSL
PZP97gplobgnOHxxgvhlikRdp3QYhsYFy8dIvfnVYpRgWR6GaX0tSw+Selai
umJT24MwNJVVnbtA7M2Y3WXTGAbROe/0IeLn856p2vaH4bd8s2EIqYe3dtrd
cJIOR7Z2Rd8NUi997vo1+biEY3ren/aapN6+vHJV+pRUBJ52q4xG8Ug9Go+9
OWdJBOQy337uIzYzZR6IVonArs3NtCGf5E3/ZmHshgjMrPkxOkZ8TuXh2nOO
EXgZ2dzuGUrGk/Rqz8WbETgz5vvLLYLs7xCZmIrDJyF+fMHZctJfTKQNLVru
cRLnpHhda0g/sqmkOl3APImgQ2VF54mvvfO5aiM4Cb5U0mjkaZK3Zg9r/ys9
iXy9PS/t4igIZNhzViyMhNuDtDHlBArW+Z0nTz+OhEo2/8Bs0g99akwPcdgg
gOL0lotmBeR5VEZGTdsiwLVd4uEtxKP5dEL2LgG+cw89Okz6sy+hZpcHHQVY
7r6C9iH92/j6ycd+UQJYOUTanLtG8j/Vdn5crwDbwzRmfS+hoHhETnhXEIXO
ON1hMdIv7hpNqlDpiUZj66i0bBNZ7zeNvypUxcLVN2xW/G8KkaramxU2n0FA
SMLkyjUMZD+9+ea9IB5LHJ3fNNkzEPjotNT+H2fBDDDMUT/HQP/fqgd2mSdC
ppbxJLGWgTm90steVZ0Dxb0f3T+DiYYvw+0lGsloezZ4YLkRE38xwovl+Cl4
ftU75I8AJvQMWTMV/kuFVprJXxO3mHjLUuEX7EgHdWvTjaUjTGjMLe/npGRA
MdVzzfKVNNaOFT35MCMLSl8Xu/S40HBWLXr/WUMItT4xe+cMGsWNClrDmkKc
llht7JBJzhNcAadfSwjJw9/UbbNoJHe5LujcLMR15UO9+8/TqE9U0Ks0FkLW
qEreKJuGzixBbKSdEDxu7B2lAhrSwy4bFGOEwLwlnu3lNOzTmngycUJEbrh9
p6mCxhVTw9p5Z4Wog9PM+koaJpflHaelCNE6Unym5i6NQIemU+8uCeEj0+R5
rYZGfyO6r5ULMb/wrZqgjoY2r0D9ikiICKVytfCnNPhr5BmXqoWwf7BfmVdP
QyFqbEbSIyHuPZkwZT2jsW9bgWZQixCPEz8GO7XQyByVC/RtF0JGdYXF4VYa
Q8LI+z7PhSgyNde1aaMR8dP5kFOvEAMXJOrMOmi0XGm8dOiNEFfq9aK3d9JQ
OYRPFv1C0Av+2G5Ezms+swo27x4Q4qbZnkm9FzT+/zyMGhvlqxu7aPwvuzIv
3g==
          "]]}, 
        {RGBColor[0, 1, 0], LineBox[CompressedData["
1:eJwt2Hk0VO8fB3BJIoVUyiT7lhJZs37SokRUKC2E6GuddGeM7GYxdiNLtuJK
iPJNCvVNBilCYihkX7JFIUsl+j2d8/trzuvMOc+957n3+bzfM9JO1864cHNx
ca1dw8X197OijMAwmcLZoUpGQZoffOFGya8DmRM4255njOdauy9o/PtpemEU
Z7verowoaPOFwtz0c7mDOFs/a4UhwfGFtCTCHp4OnG1h1W7J994XKBiBU12N
s4+uL1HtrvcFtX0EKcMUnO1ZWyURXOEL93LFKjQO4ewymd2zz3J84XJnh1vu
lix2orhqcJuXLwz+rj5g9eIOW1ImV9VU3xdqqip21rjdZutyTLrj+H1hUsM+
NGk5nf29sVMJa6NAkNHRmo+5aWzexgdrOTgFzv3ghAVqpLK327g19LpRIP70
dbvhults0Ri+8QENCmgeshH5j5zM/hFnfi16DQUkh/qPz/MksSdaP/8RbvQB
H7HiS5lFCeysLoXtTqk+oDwTz+C3u8nm7VXOnLvqA+ZTapeK+1ns3n2rK0/2
+wBBsdFNRTuWrV227yeNywcoVSX+162i2FcDZ+8PNpIhPvXFE53gcPaVrr2M
HWlkCM2yzO/tYrDLmvWvPnUnwyrP/swTv6ns9p+9h4p0yXBPXT9rX1Ywu/Fm
9fLFTWRw2/GI72zbDfYUZ7e+Zj8JCgJcaqgyJPbYCYkCsackUPZzHurK82Cf
FK3x2BtHAn0fjZNNsg7sXq36vNF/SBBTUhGxGH+U7UJ1XVI5RoIF+sFs6eQj
0CT1xd9QmQTO82kuJYkOEHfvuM4TQRLUuo5utq90gBLFNG9rZLle9Ur+CQe4
xp8yurCJBJ9fN4o6GjmCs2hVhC7y1ZSVOqEJRxjflpL/SoAErnqOyl5GV0Bo
b7ndMB8JPEOVvilOuID2iwjx02tJQN5YfuOOkQec4k49NvEDg6nC5qc9nh6Q
edcuPBH5iunozM4MD3hS3i9ihHyGuc0tfckDcuIvb0pawkCVi3w+pdgTdhzT
Tji8iMHkdzW9mzJEEE03mSz+jkGx14egQ3RvkJSyO/76K1rfYHCnU7o30F+4
SPkhK26cfk597A3FP3RNVJAzC3kWq/q9YVKdFnBrGoPYMQ0iGFwHfQOdOM8p
DNwdE+wNFq7DDfYuR8VJDORtLEEb7esWtxnJzs/oewKhaSKIBIK1d7lTkIv7
R2zvJJFgl/mf/WeRDdz9MZ4aEkwljVI+jGBgFZKbyxEngwZveXrHMAbUgmWB
axwydO51tp4cxKB3Jb8z35ACq15D3aZ9GMi8wlwuWlNgM8XNTQTZNcJwTtCD
AtwHZ45092IwL9ImQEmlQKiOzKgXsoDSqtGR7xR4MrWVc6sHA90z1rkD931B
O2P23NInDJLzuDCxrX5g0+Nl/b0DA2eRJS6T3X7w8UJ1dT2yZvA0CzPyA2pg
IykTmWPzqajR1Q9o/DJ5J5AF1z2dCHrpB01j54/kfcSAeeUfx6Gr/mAWoufh
/gEDm/d2M4KB/nDZxUPhCLKcvnWI/k1/+Nc6W0ECuUbE+E7SC3+wFFBZ5LRj
sFpN6DIRDoBcRS0OIPtKNZ968DwAQlptqQptGJjE1PZ3NAfA7tkHcTzIoj/+
I/KMBECaMAwOcTB4+j4/xk4wEB5n7z+LI88EU+uFrgRC37X0EAlk117Ng+SN
QZCb3spRbMVAx3TPe1w6COSyr2ttQOYtlbZ/px0ETSP+vVMtGNyLEQxUcAyC
Me7WlRLkAf3x8s7SINjTXBlyCPl8eoaq4eVgsE38E0l8j/Yrw5epQQmGkQNV
clbIgretenfHBsNsteHmA8i1dwSiRV8Eg14dqZ8beV92wOg30RB4rDpy6nYz
Btz3L9652xwCTytMI/reYdBzX2c+9XMI/PkgD/XI5QVbzFi/Q8C7ovZYCXLZ
B5ffhttCYZHP1CIc2bNjV6Hy4VC4cOeCmhbyx0+x63iyQkHq16NjeBMGh7uX
1UIKQ2F7tDmBhVzc7XbpV2koxIqlGQUjR/ccfTLTFApL4nqBdsgH+1Ycen+F
QtygXaMk8r99HjG2vFQ4vM9wz2bknf1d5W2bqVD78XkPN/Jif6lggxIVtouF
ao41YvBg0Kui7CwVssWny54g7xjqHtvvRIWWh845+cjMIdMtRV5UMPzkMJiB
7DAs757DoMLa/s7TYcjNw4nJEvFUqHQ6yfBH1h9ZU52WQYXEHh0+b2TRz73b
40uo8JrrMs8lZPpns8MClWj95MTAM8gzn58TmW+pYLuoYmKK3Dia/DpwgAqP
P9Pe6SCHjp8kuQnS4HKT6sMdyOoVrZLSYjQgzLFkRZBHWDZNnbI08NxYNSiA
fFzHTv64Lg3iyBR1LuRfGwZb/xymgeapxdpfDRg87HMOLreggW+CRuYCsjDT
s0PBmQbzNe1yU8g152fofUQaKFapcsaQySpktVt+NBg21n4zjKyw5kfPSQYN
zb9hrgHkzvaAyHUsGrQoa9B6kKPu/9F6mUYDvs1SJ7qQDQLpQ+R7NGj1y7X9
iPzVcj1r7yMaDPlWFrUh47LR+iPPabBu41XTVuQzS4LjGbU0+PYjdc97ZJ7G
hCSr9zRw5bWwfodclilqLPCJBmrGtFeNyK5Y+nTNCA06ndT8GpAJJhLp/t9o
oL3FyuctcpPYXRP1XzQwGx8pr0cOnpb/PsFDh2tXBw7+tVp1QVa2EB1Ocx0U
/uuhJBXz8wQ6jIuuyv91kuvjH8LydFDl2U77axMDrdx6VTqELofI/V3/h9Dz
06F6dEh5qbXp7/ULhw1WdY7SwbJF3eDv/V0qryr8ZkmH9kW/x03IgtFHzuVf
oEPE3QXPZmS2ff3ayy50WBuWR2xB9lY3Lxb1pkM/xizjIMvwtlxq9qfDKVXW
kQ/I7V1W/MwwOhywLtjRicws6ig1jKdDwds1Gt3IB6gXnRbS6bCtwz6xD3nS
ul+wKJcOCiKNukPIFr9H/xF/QQfekjLbSWSuFvet7a/pIFmh1PoVuSTna1V0
Cx0YRizWd2RRs0Wx5c90UPra1ruCXC/h/6Zkhg5fmg8Q16L3y39uBXNfpoP9
1r1H+JH70tY1dQkzQFIltHobcrxX5I2bOxmwO4njKo58yHiTvKkCA4zbBmxk
kfPGtwY/02dAu8mWNerIthWpyt4mDPgUrsTWRd4QL96heJoBq8+7a4yRiTpy
ailXGVB3eiX97/mRErjfY3GdAc8NL127iMzp2xPJG8gAD0W9SGdkbabGkM9N
BtiYWsX6Iq+2H0qyrmDA9wCxjzhyqazCgY9vGPCz+fqdB8ieGH/PuVYGLMxb
55chfxJqkb04yoC5hQzaO+SyE3ZPHIXDwEDR7OwqslfawXPDhDAgvCfsF0Dz
RW5cdtlZPgyem6hb7EBOCJs85KoXBmlD4pYayMQqXw7ROQyWpObcPZHlhS5S
Zohh8K5c8lwAco+dEQHzC4MGyzNhUcgnlnmcfOLC0DnOyS9AVtBOmA14Fgae
ukvcX5D7HjwUjtzIBInMyxv90TxN/sV6umE7E4LtUrbGIpubkmxjpJnw8QXY
48j/jeriLG0mXLN5XlqHfEu6TvWWAxPOJR0ji6H5bpEyaJHzlAkpa2YV3iKv
G62dk2MzwXM33XgAuULz/q28t0yQTxq+vYSszCH2FfQxQbF6ZJsiygveTb+9
ivnCgehfIRSJXEkTjX15KRwwG22x8yiPljOmtsq5hkPHvZJYCvKB0prbUaRw
KF9XdDIJ+fEY8eG5qHA4njD4qOVvvpnXNc6Wh4O9dNGyOcq/KNEbGxS2RIAW
51GOFcrLs4Vd4XFvIyBSbrk+FeVx4qtHQgvtEfCh+iGLjdzSE5ZycSACbq2Z
yBpFNhVSz1daioC6qsrbWijfDchRb2rkIqHdgp+3A1nGSH/dUkgk9OXrRiii
/vCt9TbtsnYUUB3/tKx2ofNZGRHNbRwFsmcFr+9B/WSukJyUaxYFQhfA0hZ5
nm6e98UhCkTaX74uQf6l9futb3QUeP1gprl3o/1Jv7g5fiAKMg6vNH9GfWeX
EwGviooGkQ65dRsGUL+z4C24khwNqaJ7zYyQpfTnHvPi0dB77eY7DFlma8Mr
89Jo4F7hZ/YgK73xG+vsj4b7YgVvSlAf01Tu2jerGQNtDg0Ud9TXzOZSXkr3
x4DsqU4J3jE0XwsohQWTMRBxxrDVBPmCg03K/sUYEHcYqwtHdm0WuW68KRb0
s59QN4xjwCiMlXPUj4W6jrdyWybQ83SiR+MpsaCY+2zb/i8oj9qI5yVPxYHM
blif9Q3l59OjC+LVLFBs2a5l9BP1NSO9K4ONLPjaMDkWiVxcv6819yMLdvVa
tX5APt67vWjfFAvsOBnHiL/Q81jro44LxMMq7xd29jIGHnuPTT7WjgdWy4tm
kVUMGoK/nP8QEw9S3mp94qifR8hq6orr3oSTLjGMJtTvc989HR6PSgCtf1zK
fsqRIKA+buOZn4ngc/FYwm5jEozukbU1s0yGn72T2uvsSbBhQFhmsPoWRFto
2r0MIcH7+emOUpVUMPZbPbQmhwS7sbBiAjUN5lrm7RNek8DgIGW9+Gw6TG9Y
vytzigQjFGlq0fHbUJEx+dpKhAwqghWjQWl3gOXfGWh2gAyqi48aJnmz4JuU
ghDRiQxXZB+Nf1fBYTqzViMwigzFreIa02o4yI+0+alFo99XIVFBoxo4sC5E
NI4gp/a4iHTp4qDt8OzmyVgyNCeLG1QexSH9GeG+ZDwZ9PiiWBF2OCxOKM+/
TiaD8LSz9q5YHDL+lNcSsslgn8EJFY3HIf+mkWcL8gPTg41CiTj0XN0vwbxL
BpO8nQ7caTgsa2pnz+aQIeAyJ3LsHg46/EUyb/PIMNoKvY8rcGhVdxLwf0gG
zdAixQdsHAKZFjZqRWSg7tuJ3avBwWtVpGAUWTx6kTelHkdzk4to9YgMp48U
qQW240Bu8/JUKSFD5hwhwKcDB4qRBM8I8hQe8Zr4CQfhavvc9CdkYK5cueA4
gEOXuycPXykZ2h+03rswjINUs2JNJbL0BfhmNYqDQLVlpE8ZGYh8RbonJ3Ao
IHaf31tOhv//PwAG62s0hpH/B6lH2oI=
          "]]}, 
        {RGBColor[0, 0, 1], LineBox[CompressedData["
1:eJwt2Hk4VG8bB3AhhJCQUBKJiopsWW6UEClJtmwhlCScQaLsw5jFHlkmkSJZ
ftJGEyrJEhGRIhWSikoh9N5zXe9fc32us8w5576f5/meI3f8zGEvTg4OjhXL
ODjYv3W1UrH7Jpks8oTQzkLrEAitntfO/8xkvT0ltqiDVr818HVmlMni3STR
3nUoBEqLc+yK3zNZ21avDluGzk6X2srdx2R9rxNb5m4VAqRAqZcNDUzW/pl9
LzdYhMAOVakN+llMllrMVNTVvSFQVLy2Tt2YyRLafsLptlYIuL7u8y1eXcBK
22T1d0w6BN4vNGjbPMhjORM23ww5Q6DxUZ10o28uK+zKwrKTn0kwoe5yMf1v
DoumIubV10GCCAOTxt7ibNa24y2JJ2tJYDf7Mu68+iWW9H9RXMdzScCwPuv8
oTmT9ZR+Y8EihgS7jG1F7wdnsGJFXdrt/UggOzJk9os7ndXentb814YExNrK
Y/nlqawWwbNRjfok2DLFiF3hnMIav745KkKJBJaTO45VDtFZZvIeB3lESSC1
udVXRZPK0uNVXVW2SADpUfW5szZJrKv6atmW4wQwLj34TysygZXNUc8t0kPA
xYKDJW/7Y1kaGSUXRhoIWOLemb9/IYrV2+eQ8vsWAUVqugWqBZGslFpxplg+
Ab6SFXxHu0NZmsNjc2XJBNwI92qM2hjEOj9k+jr6PAFbwjxH+q+dYi0+D1Cz
9CdAl1A/0CbvxnrYyOU26EpAcnUd+TfDhKXLu0LExoaAmRjDK3IZe0FG8oLP
tCkBnr+yvarT3OCet/Slq3oEBAveCc0zOAVBbSp+a9QJ2GR7EDS9g0DAp+fs
G2UCMq5xBK4VC4PItt1fv8vh8aJ/OPYph8FaC73kHvSuyK/0QIMwePFzr+49
9EvbgfJWnzCgF/m3RKOFltd8jqgPg6gYrWsS6HgPb/eRE+fA+qvecaMNBIRs
6DhUdi8ctI8MjReuJ8Ah5/J2fddIIDhCj2RK4/kvh8SrkyLhTagbZwRaKNfm
rTI1Ek4rH27yQD/OE6BIPIiE7N82kTvRqlfCR79LXIBS94+v26UI4LzulFfY
cQE4NTs28KN7B6jLuQsuwpdgA44USazP+IEgX6FoEOITWP9anAC1ui5ZubXR
cLJ4z9Rj9Ee6bdtr+WjY7qXWXYU203LeZKYTDWF31VspaJF4vz5FTzz+3IsY
QzRTnqL78V40VGnfWVMuRgDL5RmXq1cMtPNGtKWuJgCrVikREAM19dK1UeiN
PJ3HOs7FwKHz5yoD0PHlfbf1GTEwJR3WZ4W2Whj1lnkQA7t/RH0TQL/LXt7W
LxILl7r+GCaKYj/1GKcfqYuF71VzoYxVBNyWV9TufRoL2VdJT6PQfoErBu26
YsF8SFQhCD0g3CnvNBoLVR03hI+ia/c7/+cuEgdqObbXZdD+j0Je+nvGQfuH
xqGbIvh/ZTdFEgXj4XFLvXe/MPbDPL2Gf008fHrodq8NbWkeZJ8sFw9cvorS
j9D3R3WYdM14qJWUEi5BZ8o1b890i4cOj6K7BNoq673V1Zp4uKlmJSqBfhgt
Qa0/lgDZhTLDx4UI+Ht5UkzBJwF0Z1Os7NDatxtzk4IS4C+Nt9MCXTXmf9Mu
KQF4bH8KaKCLLJtbp+8kAOVdqzcfOkkilF9xNRloAYEV1SsJaN5ulZq8ngyn
7388cB3Nba4g9VOZDKUKR//loSPCO5UfGZLh4TeNy4nogGElc0d/MtzZPlrr
jj5a2p9AayGDZstkhDg6ralCeKaHDBbexpaC6M7BuCynYTKc4cxQ4UKbC6uV
KP0hw/OYHcrTggToBSc9bVRIhKInutwd6I0Gusv/XEiEdfRQcwr6e1dutKtm
Ehx+zCEshg54SKZwGiWB2NTPypXoH6XB6cUWScDv5OPBi/4VY3nti1sSTMx3
z80LEDCvsdASQsH9aRWTI2ieHKdVjOEksPxoMHEbTY43lVL/kgQhHzanV6JX
BKnL984kgd1fqlUZWtBSQENGgALbrDt/MdGiS/ftr2tQoNV/Ey8Vve64FPNR
EgVkmtuNfdD5Vjw3PDIo8DPR85cHeoPujyoeJgWUIoNqXdEbxZ43Wd6mQM61
2VN2aKWnYWOvhyjAHZWZa4ourfaaCp+gQKzzp6496K0F1nPrZyjQUHFjjSFa
NVRZwIs/Gc6Yp/Roo3dt6Ved3pUMdeovV29F10o80UqHZIgrbmzbjNbiqjLU
2p8MV65sylRA7x4kH45wTYbZGiPH9WhDmjZpRVIyZMU0l4iiG88pXLiZngx5
ZKOPwug93iLkgwXJMLWwZedK9D7D8eyMmmQYztq/wIu2+JFVLzeUDPrbquyW
+Ak4fINUemMCtxt/G/uLdnSzzdr5Oxk6voVQ5tA+HaJnjVZS4cwbf8EZ9Jm4
aecWSSqs5H7z+QeapNe531qBCk9TUgam0LGlVAV3XSooXnkzM4mmuPut+ryP
Cumc/hu+oFMlLZYCDlOhhGzm8hl9JZ7v9UVfKojf6V49ir6uP/aYj0BrxVA+
oit/PaliXKTCckqoxAf0w+MxFGYWFV4cVjsxjH6y9nio0lUqqGXObBlCt3Ua
elXeokKm5QLnO3RPguxh7ftU2P3G5Nsg+o3BksGjJ1SwvdY1+QY9MjO41ayL
CnKrCpYG0BM3H0h2DlKhN6Jcnu1pj5zl9uNUKD6w4NSPnpUK+zH0kwqs4aSS
1+h/XXZD3v+oYJNpz8M2T6Jm23d+GqS3eYb2oYUMxe+FSNCgbPjWYi9a/M/P
4n9yNGhQ1cxkW+bWy9QEFRpwic4bsa3gVXVBWIcGWR/nONjeKsPwy9pLg9J/
u7pfodW6/R1kD9HA4UHpXbZ1kg7sK3GiwSt/xyq2DY22qW/3poFBwJ56ts1m
+TfcCaRB06YTg2wfrPgsCJE0uFXFEmKf/+iJZ3NPE2nwK+HQEbZd1pWMWmXQ
oGZ+TTnbXj1x3b1MGsg6ia9l348fxfORy00a2M6ZXmI7yHhP+egdGlxUqNjC
vv9zc3I5/k00aN6yv5PtqEqOhN8dNDjiIJnIfn5k76GgyAEaHFqQtGU/X/r6
h248ozSYdLHYxa5H5qvcA7RpGli33lJk16t4j+PmfD46wKflJux63pzXFlMU
o4PixtkAdr1rqtYsuyVLh2sJkpXsfmiUfTVQr0mHvcPD3ux+aen9r9nEmA7v
HBOG2f3USU2taT9Ah1lBBz92v737e5D21pMO3dLh9ex+/FStGu4VQAf52ZZo
dr9O+q70+RpOB2kBI6ev6L99z40WU+lg2VJkMo2WrDGZkWmgw4N1KhzzaE+D
3R7vW+kQETSqscDu32eqXcW9dJBItzrPHm9mb9eUq07S4dkVJV0uHI96XIQa
U4AB1Z9/XGSP1+NmZ3w5VzFANFhET4Q931F9mZ4SDBil9vGuRvescRFSlmPA
useuXZLoU9tMJ6o0GfDHxWTbJjTjrJGcmB4D9tNy/ZTY80utrj3JiAFWI1n1
7PmG02jH092WDBDRCE1RQ+fYri1scmdAq1ILhxH6eeQXh1fJDHj+Tm7RDT3V
9ImhlcqAU99PmHqhJVYMN2dnMcC0cW+hL/t603o0XAoZQK1rTgxkz98l9avG
7jCgVLdXNg6t3EVvmR1hwMZmP+9ytJVEEofTOAPcpD/er0YHO8Vq1X9lgLv4
+Pq76EefQoujZhngPJAq2YS2n3eP4hdKgZE855f97Ochv0tHRicFrN3FXflx
/dih+O6Uh0EKJM9/yhFB9yuR80v3pIBMQOqoBHqL6iCXjlUKmHaHl8uj27Rj
O2w9UkA/6dycPlrYqseDTk2BI+tIiQQ6MzSYxjmC+y/VxkyhDcLXN5iPpUBK
f/C9WfRYxLOfjMkU6Dv9a4kD10ftGBkH2T8pMG+tcW8VeoD6WF5PMBV2DhRP
qKPXXxW7R2imwk/PSMNwdHF7zYfxpFTIPdpZJY7rO0PDnlzISAWytdODDejz
eX+3HctMhbQzVn1b0YdPG5NeXEmFq5Y++4zRHCs7+Wrv4vZhs2UBaEfLLyox
o6lg6lQ+3oEWaZULXWecBmHCdkQO5pEFtScyfaZpoBQT18LOL2M5Pg2MA2lQ
YvBr+212XjlZwc/tkAaHHKnqnehT/Pp5E2fS4E1aojgv5qWn5vaNd/LSwOFj
9J5QdPgzmuDhuTS4HS1u4IP5ik+qfvrGUhpMa3W2kdCZp770LuNOh7uWFqfi
0NVCZleqhNLhIl9kXyF6/MgyzVUK6eDSddvvHfro+yDXTqt0eLjol2iP+W/H
vH21VVE6KA63x9hjPhzdKm9vcTADzGhSOgmYR2tH9leI22ZAin/Z7svohOxA
nmHHDFhsc7OqQCvxNtYEn8iA/dFqN/vQJ0fcVuVHZEDXmr1GyhKYTy7lP58q
y4CVHRUvXqBnl0vpZ/JlgqghZ+AWzM/8wyIb3zdkgrnT8tPimL+dj4wHM5oz
wa95eaiKNHs8s5qhPRMkDNamm6CPVvmfzn+dCUFhgf8IdGF0212n75mQavGw
sA+tu4l8sFcmCxbDd0vly+D8efLf+daQLMgdyX2khe8HL3597butcgn2ls4l
5OH7hHJgXKVUVDZkHdjnV6yE84MhiVdmOgesenWz9uzE/E6Siyo3y4VbXd2K
WrsJUBGqG43IzoM/AfcEOvcQsP13xfMJngJYO6iovO4gAR7yFeM/VZig/oZW
QHLE6++SUf+6gwndPQXcZeilC0kRo+pM0H5KDx1CXxr0Eu3XYYKNLCfVzImA
jgwZvYcmTLhPHfOWPoZ5hC+JTnZmQnr4iQ9NzthvXz0111GZcEth5ZCsO64f
l19elGAw4dmFSamj6DJzw1bhNCaEyth5JaP3XZN248xmgkN+06Y5dLjry8Sx
Iib8dqw80n0c690Fb6vqmKC8m+qT5Il56WL55jIWE2qXPlEa0FGq0oFFjUx4
J8isn0XLUH7zZD1jglC8iqW3FwHWe8t3nO9hwqivp7jJCcx3P6TCiT4mUOci
ys6jJ5nkJ/4DTGjq+nCwBh2/6OHoPsyE7IHEJnlvnF/LuoocPzAh4PnjVCe0
nCN8txllgn2UUUAa2p+vXOfAZyb0uiw6taL///0BTjfO2HL5EPA/ygNxkQ==

          "]]}},
       AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
       Axes->True,
       AxesOrigin->{0, 0.0045000000000000005`},
       DisplayFunction:>$DisplayFunction,
       FormatType->TraditionalForm,
       PlotLabel->FormBox["\"NormalHeston: imp. vol.\"", TraditionalForm],
       PlotRange->{{-0.03305264, 0.03305264}, {0.004245956049958695, 
        0.005972597384019587}},
       PlotRangeClipping->True,
       PlotRangePadding->{
         Scaled[0.02], 
         Scaled[0.02]}], {-1, -0.6180339887498948}, {
      Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
       {GrayLevel[0], 
        RectangleBox[{1.05, -0.05}, {1.780434782608696, 0.7500000000000001}]}, 
       {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
        GraphicsGroupBox[{
          RectangleBox[{1, 0.}, {1.7304347826086959`, 0.8000000000000002}], 
          InsetBox[
           GraphicsBox[{{{InsetBox[
                GraphicsBox[
                 {RGBColor[0, 0, 1], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 0.08}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=30\"\>", {1.2100000000000002`, 0.58}, {-1, 0}, 
                Automatic, {1, 0}]}, {InsetBox[
                GraphicsBox[
                 {RGBColor[0, 1, 0], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 1.24}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=10\"\>", {1.2100000000000002`, 1.74}, {-1, 0}, 
                Automatic, {1, 0}]}, {InsetBox[
                GraphicsBox[
                 {RGBColor[1, 0, 0], 
                  LineBox[{{0, 0}, {1, 0}}]}], {0.08, 2.4}, {
                Left, Bottom}, {1, 1}], 
               InsetBox["\<\"T=3\"\>", {1.2100000000000002`, 2.9}, {-1, 0}, 
                Automatic, {1, 0}]}}, {}},
            AspectRatio->1.0952380952380953`,
            FormatType->TraditionalForm,
            
            PlotRange->{{-0.1, 3.26}, {-0.1, 
             3.5799999999999996`}}], {1, 0.}, {
           Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
    AspectRatio->Automatic,
    Background->None,
    ColorOutput->Automatic,
    ImageSize->Automatic,
    PlotRange->All]}], "}"}]], "Output",
 CellChangeTimes->{3.4380836694870825`*^9, 3.4380837070808325`*^9, 
  3.4380842289870825`*^9, 3.4380859635563183`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"T", "=", "10"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x1", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ";", 
      RowBox[{"\[Rho]c21x2", "=", 
       RowBox[{"-", "0.3`"}]}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{
        "PlotLabel", "\[Rule]", "\"\<Implicit Normal Correlation\>\""}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}], ";"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestExecution", "[", "T_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"method", "=", "\"\<Directe\>\""}], ",", 
       RowBox[{"zetavmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"zmethod", "=", "\"\<Exact\>\""}], ",", 
       RowBox[{"favmethod", "=", "\"\<Arithmetic\>\""}], ",", 
       RowBox[{"F1", "=", "0.0418`"}], ",", 
       RowBox[{"\[Alpha]1", "=", "0.0435`"}], ",", 
       RowBox[{"\[Beta]1", "=", "0.6`"}], ",", 
       RowBox[{"\[Rho]1", "=", 
        RowBox[{"-", "0.1819`"}]}], ",", 
       RowBox[{"\[Nu]1", "=", "0.3798`"}], ",", 
       RowBox[{"F2", "=", "0.0363`"}], ",", 
       RowBox[{"\[Alpha]2", "=", "0.0671`"}], ",", 
       RowBox[{"\[Beta]2", "=", "0.7`"}], ",", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{"-", "0.1136`"}]}], ",", 
       RowBox[{"\[Nu]2", "=", "0.3797`"}], ",", 
       RowBox[{"\[Rho]s", "=", "0.8`"}], ",", 
       RowBox[{"\[Rho]v", "=", "0.5`"}], ",", "callvalues", ",", 
       "implicitNormalvols", ",", "strikevalues", ",", "k", ",", 
       "implicitcorrelations", ",", "implicitcorrelations2", ",", 
       "implicitcorrelations3", ",", 
       RowBox[{"\[Rho]c12", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c12x1", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"\[Rho]c21x1", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c12x2", "=", "0.3`"}], ",", 
       RowBox[{"\[Rho]c21x2", "=", 
        RowBox[{"-", "0.3`"}]}], ",", 
       RowBox[{"legendrelst", "=", 
        RowBox[{"LegendreCoeffs", "[", "20", "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<money=\>\"", ",", 
        RowBox[{"F1", "-", "F2"}]}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12", ",", "\[Rho]c21"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x1", ",", "\[Rho]c21x1"}], "]"}], ";", 
      RowBox[{"TestCorrelation", "[", 
       RowBox[{
       "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]s", ",", "\[Rho]v", ",", 
        "\[Rho]c12x2", ",", "\[Rho]c21x2"}], "]"}], ";", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"F1", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
             "\[Nu]1", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F1", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"F2", " ", 
          RowBox[{
           RowBox[{"SABROption", "[", 
            RowBox[{
            "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", "\[Rho]2", ",", 
             "\[Nu]2", ",", 
             RowBox[{"{", 
              RowBox[{
              "method", ",", "zmethod", ",", "zetavmethod", ",", 
               "favmethod"}], "}"}], ",", 
             RowBox[{"F2", " ", "1.0001`"}], ",", "T"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
        "}"}]}], ";", 
      RowBox[{"strikevalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"k", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"-", "0.02`"}], ",", "0.02`", ",", "0.001`"}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "legendrelst", 
           ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", 
           "legendrelst", ",", "0"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabr:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12", ",", "\[Rho]c21", ",", "0"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x1", ",", "\[Rho]c21x1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"callvalues", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"BiSABRNormalHestonSpreadOption", "[", 
          RowBox[{
          "F1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", "\[Rho]1", ",", 
           "\[Nu]1", ",", "F2", ",", "\[Alpha]2", ",", "\[Beta]2", ",", 
           "\[Rho]2", ",", "\[Nu]2", ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", "\[Rho]s", ",", 
           "\[Rho]v", ",", "\[Rho]c12x2", ",", "\[Rho]c21x2", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitNormalvols", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitVol", "[", 
          RowBox[{
           RowBox[{"F1", "-", "F2"}], ",", 
           RowBox[{
           "strikevalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "T", ",", 
           RowBox[{
           "callvalues", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "strikevalues", "]"}]}], "}"}]}], "]"}]}], 
      ";", 
      RowBox[{"implicitcorrelations3", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NormalImplicitCorrelation", "[", 
          RowBox[{"\[Sigma]ATMnormal1", ",", "\[Sigma]ATMnormal2", ",", 
           RowBox[{
           "implicitNormalvols", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"1", " ", 
            RowBox[{"Length", "[", "strikevalues", "]"}]}]}], "}"}]}], 
        "]"}]}], ";", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations2"}], "}"}], 
           "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"strikevalues", ",", "implicitcorrelations3"}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<BiSabrHeston:Implicit Normal Correlation T=\>\"", "<>", 
          RowBox[{"ToString", "[", "T", "]"}]}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegend", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x1", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x1", "]"}]}], ",", 
           RowBox[{"\"\<\[Rho]c12=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c12x2", "]"}], "<>", 
            "\"\< \[Rho]c21=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Rho]c21x2", "]"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.`", ",", "1", ",", "0.`"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0.6`", ",", "0"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0", ",", "0.5`", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thickness", "[", "0.01`", "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"0.5`", ",", "0", ",", "1"}], "]"}]}], "}"}]}], 
          "}"}]}]}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.438085992778808*^9, 3.43808599361532*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "2", "]"}]], "Input",
 CellChangeTimes->{3.438086002168825*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754402075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842754558325`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT98278W1tb9dT+9s+6rD0lk/eLPcuu
vLX6qb3Nff/e6XmT9k9/ad+sfPep/ZwjChuKMibuL9PZ9yCY75n9n5UfL/km
TdhvvnryplT7Z/Y75FpfB+7o29+iM9UoqOCZfeVLNUOONT37o+p+5gkufGZv
teVE2b75Xfs5Di1im3Xxmf0vsHUd+38IvPjwgPG5/S5PHibt9rb9+ffklG4a
PreHuK9lfwDvW5nixOdQ9zTtr+LLKpsz4TnU/ob9xQURhvb7n0Ptq9mfyTP3
u8Pb51DzK/av2pKn0yT1Ampeyf7pZ36dvuP2Aqq/YH/F543cykUvoOoz9nOx
v78qOwcmn7D/ftQUge4jMH7A/va7vs+kX7+wZ4CCzwm9OcX8L2Hy9o+vv+VT
M4TxE+zto89v2eX/Ema+PX9Z67R1WTD5AvtZuaG7axpfwtxn/+vppviVk2Hq
K+zXbZATvLDgJcx/9lu5VjRuXAHT32C/bUMEm+3ql7DwsW+PE+qctAJmXov9
tb9i0X+A+qHha39GrsP98RSY+R32ShLSRw60vITFj31B5+olQoUw+3rstap2
ygVFvYTFr33x6XPx7xxg9k+w52/IE/RSfQlLH/Yfu5fd2sUOc88keybz2zxd
L17A0pe9arHKs6/HYfExxf739Na3Rste2AMA+qBZQQ==
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9Z/Zo9x1SfmR/+2dd1p6SyfsTY82t
rXIe2dvc9++dnjdp/8vs/2ovtjyyn3NEYUNRxsT9MzbqLjn795H9n5UfL/km
Tdj/Lj3q0mu3x/Y75FpfB+7o2y8nsv6X84TH9pUv1Qw51vTsv7FdzOv6zcf2
VltOlO2b37W/Jb03ZpnyE/tfYOs69s8VvBO1KfeJ/S5PHibt9rb9E7de3PN7
+xN7iPta9ttVKuxrYnoKdU/Tfqe8X/ruvk+h9jfszwv95Ocx4ynUvpr9NxuU
J7Q8fgo1v2J/SaFa/E+9Z1DzSvYnBVw+sKjqGVR/wX6ZzVduVh17BlWfsX+B
fb5HpdBzqHzC/sttDSaT4mD8gP2nvWeIbF313J4BCi4uW/Li1De4vP3alDtH
Nzu9gOm3f3X5f6Zz3wuY+faPV17ptLkJky+wF2Ipmuql/BLmPvtnMxd9/Jn9
EuZ+e5ky2Zz1m17C/Gf/nvOv4cJvL2H+t5fVs3h01ewVLHzsky+dCzUoegUL
P3t567pJvctfwcLX3jjJ+funq69g4W9fsOhZx74/r2DxYz/FxCjyiPRrWPzZ
c29q/Olt/BoWv/ZF5ybc+uT8Ghb/9ltvPOpt8XsNSx/2ayUCbG8Ev4alH3vh
ju+/d4a8hqUv+x9hb4ruB76Gum+KfXkfc/0T79f2APi5YTA=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9YuwHPD60v7S//bMua0/J5P3xzbz7
dy58aW9z3793et6k/bFKi5h4dr+0n3NEYUNRxsT9Hi6aX69dfmn/Z+XHS75J
E/bzJ/QGsLx5ab9DrvV14I6+/Y/fmF6tY35lX/lSzZBjTc/+U3FG+zSlXtlb
bTlRtm9+1/4pR4Tqnui/sv8Ftq5jf/OFo+EdLq/sd3nyMGm3t+2X28bw/ln4
K3uI+1r22/e8WXUi8xXUPU37L9d3K76ufAW1v2G/hUz7wX/tMPtq9veI8k1Z
MhlmfsX++oubzHPmwMwr2f9783mbSwth+gv2n+pplnNcDFOfsb+stvuJ8AKY
fMJ+3eAPegumw/gB+410WXa5dr6yZ4CCQ4l3LVpL4PL2UdtE10tGwvXbF73y
keUxh5tvH7uTt2gHH9x++7+579kPPHgJc5/9o7cPlrxb+xLmfvvipw8yZMpf
wvxnL+Qr8lDUFhb+Dfby1w+J9THA4qvJXkFZda7koRew8LMXOrikTb/pBSx8
7edPF7LWdXwBC3/7/GkZStH/n8Pix/7mvByBj3uew+LP/pPcLRapquew+LU/
sPyl6nez57D4t89dEC686PMzWPqw/7jw2Eq9Dc9g6cc+jMctfE3OM1j6sg9o
VlFQ13wGdd8U+2VqyUkrnj61BwBnrlNK
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=2\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002`, 1.74},
               {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380842889558325`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "10", "]"}]], "Input",
 CellChangeTimes->{3.43808600846496*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842891902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842892839575`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842893620825`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842894402075`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9660lJnqWPLe//bMua0/J5P0eC07N
LZn03N7mvn/v9LxJ+w9Oy9UK2/Dcfs4RhQ1FGRP3v1H2En5+9rn9n5UfL/km
TdivbdnRLv/6uf0OudbXgTv69jPG8f/+xv7CvvKlmiHHmp79Zgf5JFJUXthb
bTlRtm9+135JmfkbYhxe2P8CW9ex/274qQ1Xo1/Y7/LkYdJub9s/a/EiwcNl
L+wh7mvZz3nW7pz4xBdQ9zTt/5104NbRVS+g9jfsvxBzTn7fYZh9Nft/8Cyu
+nAbZn7F/itndx/2/gwzr2R/y7Sjd/dyvoTqL9j//XnvOWP5l1D1GfufXt72
eKYxTD5hf1PmnSe33WD8gP3+gR4hTyNe2jNAwVW+1/sWZsLl7eXSXkr9rYDr
t7+Qbm/8pA1uvr3NLyFZ18lw++0lVkpu4p/3EuY++3NbpnCaLYepr7C3PfLy
xZp1L2H+s5+357pyzhaY/gb7EsfYp3k7XsLCxz5J0+H25l0w81rsr9y56mC7
+yUsfO2Ps348LrALZn6HfbapVpL59pew+LHnn3Hl3Z5NMPt67BW2al1Zv+Yl
LH7tZ/O+71ZYCrN/gn3H3jANxTkvYenDnu/X3ztHJsLcM8l+warVPfJA/0PT
l/1FNrFk10qY+6bYsyno13hlv7QHAF5kXOw=
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9fU8bhHykntrf/lmXtadk8v67mw79
SPB8am9z3793et6k/Vtn75YqrHhqP+eIwoaijIn7d17lyata/tT+z8qPl3yT
JuyXqH6ztOraU/sdcq2vA3f07U9w4tbOZ31mX/lSzZBjTc9+9bXFQqEmz+yt
tpwo2ze/a7/iQn1hzeRn9r/A1nXsz3i1q+r5xGf2uzx5mLTb2/bXXcxX6Dnw
zB7ivpb9euGXw4TeP4O6p2l/2+4nt0tkn0Ptb9i/54DP8bXez6H21ew3vXe8
bFvlc6j5Ffvby1ZXtC9/DjWvZL/grsASiasw/QX7VXZNFEhgegFVn7E/favd
jWD9F1D5hP23V7PJvoiG8QP2S4S9vcHf8cKeAQrCn9r179kMl7ff8/aG7r17
cP32RSukPyRxvoSZb9/5dIWrufFLmP32B1eF73eNeQlzn33G7mOs5S0w9RX2
4f2H7m5c/RLmP/v7PyTtb1+E6W+wP3VoVvO1by9h4WP/+eusza1Sr2DhZ19z
K/zrSZtXsPC1N31UptQS+woW/vblufNapta8gsWP/ezKrq0PZr6CxZ/9rT1P
Z3ptfQWLX/uWyMCM3edeweLfPmh+8Qr5Z69g6cN+5xdR4czfr2Dpx/5f0X3r
fr7XsPRlXzvr2cd++ddQ902xn7h9tXe+3mt7AGu4Xow=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9+nVhEjObX9nf/lmXtadk8v43MrpL
DXpe2dvc9++dnjdpfw+v8YMXk1/ZzzmisKEoY+L+rGwFvnWzXtn/Wfnxkm/S
hP0qEfGG2Qte2e+Qa30duKNv/8WjLgpcS1/ZV75UM+RY07P/9tRLW4pXvLK3
2nKibN/8rv0ZOz7zTlj1yv4X2LqO/U79l5+5rX5lv8uTh0m7vW1/qV4CRwNQ
HuK+lv1ipkkXlVfA3NO0X0Uj7or0Epj9DfuzHn9uCZ4Hs69m//9I6Tc7psHM
r9hvMXFTuG0vzLyS/XprWX9cbYTpL9j/JXlybE0JTH3G/gwppdN6qTD5hP2Z
k9cFfwiG8QP2h5/iOHjC4ZU9AxScnZrtekQbLm+fyXTv/ycRuH57bdOLcRl/
XsLMt095fSzP6tFLmP329q0NSo3HXsLcZz+J9+OC0JUw9RX2PL1iiy52vYT5
zz5SSfAhXzZMf4N98vmyZWpeL2HhY9/QvTfbUANmXot9jojVNDfWl7Dwtber
bnKvefgCFv72etce2z/f8wIWP/bzvq04P2v6C1j82X//m3FlReELWPzae3Qc
3qfo/QIW//Y1++7NE1F5AUsf9jWvrUz7/zyHpR97r3R3tnlXnsPSl/2hkxPz
fdY8h7pviv3NW1V7lzQ/twcAS4tXnQ==
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=10\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002`, 1.74},
               {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380842975808325`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "20", "]"}]], "Input",
 CellChangeTimes->{3.4380860117845993`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842977995825`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842978933325`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842979558325`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380842980339575`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9JUk/bl2Z9NL+9s+6rD0lk/c7eUpa
1C58aW9z3793et6k/b/+5D59sv6l/ZwjChuKMibuL723/wDHvpf2f1Z+vOSb
NGH/XEXtrqenX9rvkGt9Hbijb79t14kn5Tdf2le+VDPkWNOz/97mReF7nr20
t9pyomzf/K79AdcE/dd/fmn/C2xdx37rrno5X4ZX9rs8eZi029v2z0xZyzSJ
55U9xH0t+0UPFahUSbyCuqdp/40ktjmMKq+g9jfs//njW4mK/iuofTX733yf
s+me5Suo+RX7LVgcQnVcYOaV7J86+148px9Mf8H+f3M77xWGw9Rn7M/4H/42
MQEmn7A//vmt/VczYPyA/W4CPCtPFryyZ4AC5cJWZasKuLz9VoEfN5Xr4frt
V09fu765FW6+fYnDpxNh3XD77bv9tCbPmgB3n73ShvIzPlPh7rd/b7GiK3sm
3H/2m0O8HL/Ogfvf/m755mMv5sPDx17K5UG46yJ4+Nlv2fBrFtcSePjaV3F3
LLBYCjO/w77goPrj80A+NH7sr+e9c724FGZfj/3Fi+GCdkA+NH7tT1zkei++
BGb/BHv1kJQnCUD7oOnDfuF6ER/pBTD3TLK/1fbsnOfcV7D0ZT+j7nv0+5kw
902x/12Tr8A/7ZU9AFsdXzk=
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9tS8/NL1XemF/+2dd1p6SyfsTsxzX
PLJ5YW9z3793et6k/fuXH5h+IOyF/ZwjChuKMibu/8dT9bK94IX9n5UfL/km
Tdg/tzfGwLzrhf0OudbXgTv69h/tZH96ZvEL+8qXaoYca3r2fy/MyHDf+8Le
asuJsn3zu/ZnfgxhWnrthf0vsHUd+9W+Czx4/P6F/S5PHibt9rb9xieOCjFx
vrSHuK9lP3fni96/ii+h7mnab3RnsuoVq5dQ+xv2P753q6c5+CXUvpr9by0Z
QjhzXkLNr9h/5tWRZ0ktMPNK9lvOmdHVOwemv2C/Wc2LmLYtMPUZ+9mOpwZ6
nYHJJ+wPcMk2uPYYxg/YP+FS21S13y/tGaCg0EL+nbnQK5i8/bddGRVsmjB+
gn32nGlOffavYObbd3IUa50OhckX2C8XL7m7I/sVzH32J0LCbwY1wtRX2N/p
yM2dMu0VzH/2MZHb91SshulvsM/Wu3vg1/5XsPCxv/jfyk/0Csy8FvtHGQKS
h5+/goWvfd+i17v//YKZ32E/qal6/yHe17D4se81ObSYU+E1LP7sRXy3vjpr
+BoWv/a8FZEqXM6vYfFvv+CRzJ8dwa9h6cN+n2Kq+9Xk17D0Yx/fry4aVfwa
lr7sKze92+vU9Brqvin2/aXxX7omvLYHAEQIXNI=
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9wirqog21r+1v/6zL2lMyef/2IsNl
qdWv7W3u+/dOz5u0v+aK+ZOdFa/t5xxR2FCUMXH/IvY8k8rS1/Z/Vn685Js0
YX9lfo/fgsLX9jvkWl8H7ujbf2wfq4dO7mv7ypdqhhxrevZrn2+aJ5Xx2t5q
y4myffO79vOX2jpmJr22/wW2rmN/SILATLGY1/a7PHmYtNvb9hstPdWnGPra
HuK+lv27FVb1d/rC3NO0X33hjX4/V5j9Dfvnv1jDVWgDs69m/zXV+wyfjGDm
V+w30lr85ZIGzLyS/a+/X34sKgfTX7Bf80W8w14hmPqM/dcaAp+fZoPJJ+y/
VzpdzPXXKyg/YP8kU4Yknbev7BmgYBPT+uWt9+Hy9tGMQSyhF2H8BHv3DenH
5x16BTPfvkL3Xnr6Zph8gT3bA43KzYtfwdxnX39BYGH7ZJj6Cvv1IcF9L5pe
wfxnX/Od78OtQpj+Bvvv28LzkhNewcLHvuR+0eI2P5h5LfYzJlqKedq8goWv
fa+xl+l6TZj5Hfbma0SD94q9gsWPvXv2lkXlzDD7euyfehSaPnr/Eha/9vdT
vv9guPMSFv/2uRIC264ffwlLH/bHuu/xZ21+CUs/9odz2pt3z3sJS1/2m/lN
M853voS6b4r9tqcp71eUvLQHALidVEo=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=20\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", {1.2100000000000002`, 1.74},
               {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843041589575`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "30", "]"}]], "Input",
 CellChangeTimes->{3.438086015968822*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843044245825`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9n39Iuvzd/9r+9s+6rD0lk/e/D782
fdGx1/Y29/17p+dN2r/po8EP1bOv7eccUdhQlDFx/7Kd05PaLr+2/7Py4yXf
pAn7LxhYXDx087X9DrnW14E7+vazlVRa37r/2r7ypZohx5qe/Ss1Oqadfvra
3mrLibJ987v2t/z/cHXq69f2v8DWdezfxej9xvzja/tdnjxM2u1t+w99fHd6
w7fX9hD3tew/pXIk/f9vmHua9geGi2xRYnwDtb9h/xrjkuWSbG+g9tXsr5be
bv2Y6w3U/Ir9i1g/5NXxv4GaV7J/gnetyythmP6C/f3/5Y+pSsDUZ+x/9UqU
1UAGJp+w/0SsvTSHAowfsP/cYSedtcpv7Bmg4DjDpjQ5dbi8vWWUDmu0Fly/
vcmTSv8kXbj59s+2z55tbAC33/7a3Ut+54zg7rM3vzfhnqEp3P32krURF2PN
4f6zl6po3R9oCfe//bOgX8G81m9g4WNvzbrRZ4INzLwW+6lqetW3bN/Awtd+
oc35I6/tYOZ32O9x/qN0xP4NLH7sLzMbLU52gNnXYz/B43XaKSAfGr/20w6k
Lf7hALN/gv2tLO+F74B8aPqwn8+jvWeNA8w9k+wtxF4lGgP50PRlr+3IJtRs
D3PfFHv5bcdj5gDdAwBdXVVr
        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9tQvfXrj645X97Z91WXtKJu8/MMvp
KSfba3ub+/690/Mm7U/2etphIPzafs4RhQ1FGRP3G5+aZ+Kp8Nr+z8qPl3yT
Juxf+GtfdLDua/sdcq2vA3f07deof5vtZ/XavvKlmiHHmp79DddfnrF0f21v
teVE2b75XfudD0U+EAl5bf8LbF3HfoaOPsb7Ca/td3nyMGm3t+2P1fJpnZ77
2h7ivpb9OXcn7rStgrmnaf/tmwlPL7TB7G/Yf8qtwSNgMsy+mv161cHSu+fD
zK/Y775mRp/AGph5Jfu/admd9t8B01+wn1/R+FP5EZj6jP3XdtvKdFyAySfs
7/11LbL+DowfsH/NKp7NMS9e2zNAwZYDWeryX+Dy9saqH9Ye/Q/Xb79Xhd3U
n/sNzHx726Api3aJvYHZb7/3JOcVNqU3MPfZ6wj1zzPShamvsM/XtzxvY/EG
5j/7ef9CtFWcYfob7D/OOF3w3PcNLHzsVfmmhbVGwMxrsfebEdz7J+kNLHzt
H03/ut87F2Z+h330s64pheVvYPFj/+OF5tqcRph9PfYrp/1aYd39Bha/9uJs
Sap3p8Dsn2A/IyRgv/+8N7D0YX/m1CqRScth7plkb6b/+OiiDW9g6cte/NyC
8oadMPdNsbc63nNF89AbewChbFiK
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT90QKzvwmefWN/+2dd1p6SyfvfsH43
3HDyjb3Nff/e6XmT9hc3HJoudOyN/ZwjChuKMibu33z4+m+LQ2/s/6z8eMk3
acJ+02c7vJT3vbHfIdf6OnBH3/55YVs7L+58Y1/5Us2QY03P/u8Od645b31j
b7XlRNm++V37F8jvyaja8Mb+F9i6jv0mOz70lq5+Y7/Lk4dJu71t//R1jWtM
l72xh7ivZf/s1SKOuxfA3NO0v3zrt7tss2H2N+z/6cOkJTkVZl/N/memyfc/
9cHMr9hf8cX51JQOmHkl+02Tko//b4TpL9gvzzfnkEk1TH3G/p8hiVtNSmDy
CftL7c2XMuTC+AH73dR1Fs1MfWPPAAXXVYKOMsTB5e2zOdz1zcPg+u17Fx1m
s/ODm29vcsS6XMwNbr+9m1T/+oO2cPfZx6w498DBFO5++w3LhW2n6sD9Z887
p+DbfmW4/+0jQ7/aHpKCh4+99cFTTnMF4eFn/+VyimEQBzx87ZeonTJ69O81
LPztvW98zPb7+hoWP/a7lYz/Tn/9GhZ/9u/OnWY88PA1LH7tGyzK+o9ffw2L
f/ugdMFt68++hqUP+5b6iPrKw69h6ce+I2LVO9Wdr2Hpy97O/xbDtnWvoe6b
Yv+yT2iN1pLX9gDMU1r3
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=30\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002`, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843101120825`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TestExecution", "[", "40", "]"}]], "Input",
 CellChangeTimes->{3.438086021488695*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"money=\"\>", "\[InvisibleSpace]", "0.005499999999999998`"}],
  SequenceForm["money=", 0.005499999999999998],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.122838766233639`", ",", "1.1794737833590503`", ",", 
     "0.562149160807629`", ",", "0.1355382895996814`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {2.122838766233639, 1.1794737833590503`, 
   0.562149160807629, 0.1355382895996814}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.9094976369781147`", ",", "1.5293983071001411`", ",", 
     "0.49188807768772186`", ",", "0.06921597823402087`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.9094976369781147`, 
   1.5293983071001411`, 0.49188807768772186`, 0.06921597823402087}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Test Correlation : Eigenvalues=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1.930784021765979`", ",", "1.508111922312278`", ",", 
     "0.47060169289985876`", ",", "0.09050236302188469`"}], "}"}]}],
  SequenceForm[
  "Test Correlation : Eigenvalues=", {1.930784021765979, 1.508111922312278, 
   0.47060169289985876`, 0.09050236302188469}],
  Editable->False]], "Print",
 CellChangeTimes->{3.4380843151902075`*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[{
      {RGBColor[1, 0., 0], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT913dMr9LweGd/+2dd1p6Syfsbnz5e
VOD1zt7mvn/v9LxJ+6tW/T6xxued/ZwjChuKMibuN9ptte6O3zv7Pys/XvJN
mrD/r9FPYYbAd/Y75FpfB+7o21/0bPluseB39pUv1Qw51vTsv+nwPk0h9J29
1ZYTZfvmd+2vO3b2ukz4O/tfYOs69vcH7rrAHfnOfpcnD5N2e9v+U9nHRN5G
vbOHuK9lf2HS4fQDMTD3NO1fUpHW1xoHs79hf7J9gZ9NAsy+mv0aklfyniTC
zK/Yf/v3/e21yTDzSvb/SEr7zJ4K01+wX+reszdNaTD1GfurH20vfJcOk0/Y
H5ChH+iVCeMH7J9/5UzMtKx39gxQELQpIeNSNlzeXvSzsde/HLh+e5fJercl
8+Dm26+3//1NJR9uv73qUq0a+QK4++ynXwv24SyEu98+08PI51Eh3H/2m/8d
TF5VBPe/Pa9VeF1iMTx87KXebO5iL4GHn73bXKnqOSXw8LU/5RPjqlAKD3/7
J3WPH00qhcePvW3G7oAvpfD4s7+iMLnfpQwev/YeWnsXN5fB4x/oX62pG8vg
6cN+5fSU/HNl8PRjn/W4xvFWGTx92S/byCh3tQzmvin2VVdeSO0H8gEdAlq+

        "]]}, 
      {RGBColor[0., 1, 0.], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9vBy+7z1/vbW//bMua0/J5P0PL0YU
uP5/a29z3793et6k/fPcVU9bs7yzn3NEYUNRxsT9Nzn23NThfGf/Z+XHS75J
E/b7if4vkeB7Z79DrvV14I6+/Xv5Fpb8E3pnX/lSzZBjTc/+50ay6++Jv7O3
2nKibN/8rv1iazb83CHzzv4X2LqO/c85AjV6Fd/Z7/LkYdJub9vv7bWEN1rt
nT3EfS37pwSzVitpv4O6p2m//6Vkh8f6MPsb9rMKhOvMNYHZV7M/35ibJ8AS
Zn7F/o3utqt/28LMK9l/tdf8ynwnmP6C/bZqZ/xt3GHqM/Z/awp4esEbJp+w
/wXDnKjYABg/YP8ZRdaShyHv7BmgYNvxhC8xkXB5+0/mzHPPx8L123MuPaBr
mQQ33/6b7MeUmWlw++3tNMv+v8+Cu89+qu6BHTb5cPfbL7p93au+GO4/e4Gf
GXnby+H+tz/49NytJ9Xw8LH/Gqrqxt4ADz/7f58jU+Va4OFrf+qswxvNDnj4
2+/tW9ur2QOPH3vbf72/ZSbA489+UhnHc+Yp8Pi1n2M/j+HedHj827Ne8v+x
ajY8fdgr2hyrzZoPc88k+x7tBgeZxe9g6cu+5xrDh/3LYO6bYv/ZiMUmdNU7
ewDKCVI1
        "]]}, 
      {RGBColor[0, 0, 1], Thickness[0.01], LineBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQXS2yzv1h1ZT9//SXNj3b9M7+9s+6rD0lk/dvmLA5
XHjjO3ub+/690/Mm7V/Rr56ut/6d/ZwjChuKMibun5i69Ij52nf2f1Z+vOSb
NGH/CoGv7fqr39nvkGt9Hbijb/8k9qdnRFe+s698qWbIsaZn/+1Sjc2vlr2z
t9pyomzf/K79LBWGceuWvLP/BbauY3/fcfavCYve2e/y5GHSbm/bf0FJZhHT
gnf2EPe17N8iIjl58lyYe5r29yZs/CE8G2Z/w/5783PYWmbA7KvZn1hf9Onx
VJj5FfvzeEO/Gk+GmVeyP7j9lmfJBJj+gv1KfMd1lvbC1Gfsl+1edudYF0w+
Yf+8q9Nn3myH8QP2n/YQX3q35Z09AxSoLDvjeLkRLm9f9i1i8646uH77swfU
7KZUw823z5K2UU+ogNtvX32Ob4tcKdx99kbrorQuFMLdb2/k9Ot8SR7cf/bf
Th18xZMN97/9x3UxB2akw8PH/k6Q7jSJFHj42UtF62/sSYCHrz2//53QrzHw
8Le3myR0IigSHj/2c9f+81oaCo8/+2/z2BTfBsLj157py/ZuLT94/Ntfr9t2
OtYLnj7s48+uU2h3g6cfezFFz5PLnODpy95ujRzzXjuY+6bYl0Rt4Dpl9c4e
AJEDWGE=
        "]]}},
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotLabel->FormBox[
      "\"BiSabrHeston:Implicit Normal Correlation T=40\"", TraditionalForm],
     PlotRangeClipping->True], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.4195652173913042, -0.0680339887498947}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.4695652173913042, -0.018033988749894703`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {RGBColor[0, 0, 1], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[0., 1, 0.], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=0.3\"\>", \
{1.2100000000000002`, 1.74}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {RGBColor[1, 0., 0], Thickness[0.01], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 2.4}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[Rho]c12=-0.3 \[Rho]c21=-0.3\"\>", \
{1.2100000000000002`, 2.9}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->1.0952380952380953`,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           3.5799999999999996`}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.7304347826086958, 0.8000000000000002}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.4380843202527075`*^9}]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1120, 780},
WindowMargins->{{152, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 11, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "S6.6.1"->{
  Cell[1460, 48, 123, 3, 27, "Input",
   InitializationCell->True,
   CellTags->"S6.6.1"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"S6.6.1", 395953, 10387}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 244, 6, 27, "Input",
 InitializationCell->True],
Cell[792, 28, 196, 4, 27, "Input",
 InitializationCell->True],
Cell[991, 34, 198, 4, 27, "Input",
 InitializationCell->True],
Cell[1192, 40, 265, 6, 27, "Input",
 InitializationCell->True],
Cell[1460, 48, 123, 3, 27, "Input",
 InitializationCell->True,
 CellTags->"S6.6.1"],
Cell[1586, 53, 93, 2, 27, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1704, 59, 123, 2, 27, "Input"],
Cell[1830, 63, 100, 1, 27, "Output"]
}, Open  ]],
Cell[1945, 67, 125, 3, 27, "Input",
 InitializationCell->True],
Cell[2073, 72, 115, 2, 43, "Input"],
Cell[2191, 76, 640, 19, 73, "Input"],
Cell[2834, 97, 5155, 134, 270, "Input",
 InitializationCell->True],
Cell[7992, 233, 361, 12, 52, "Input"],
Cell[8356, 247, 154, 3, 27, "Input"],
Cell[8513, 252, 178, 3, 43, "Input"],
Cell[8694, 257, 3795, 100, 215, "Input",
 InitializationCell->True],
Cell[12492, 359, 406, 13, 75, "Input"],
Cell[12901, 374, 4489, 128, 267, "Input",
 InitializationCell->True],
Cell[17393, 504, 487, 13, 27, "Input",
 InitializationCell->True],
Cell[17883, 519, 794, 23, 125, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[18702, 546, 730, 20, 43, "Input"],
Cell[19435, 568, 193, 4, 27, "Output"]
}, Open  ]],
Cell[19643, 575, 462, 7, 27, "Input"],
Cell[20108, 584, 83, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[20216, 590, 872, 20, 58, "Input"],
Cell[21091, 612, 1879, 36, 39, "Print"],
Cell[22973, 650, 197, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23207, 659, 778, 20, 88, "Input"],
Cell[23988, 681, 4983, 256, 186, 3021, 220, "GraphicsData", "PostScript", \
"Graphics"],
Cell[28974, 939, 134, 4, 27, "Output"]
}, Open  ]],
Cell[29123, 946, 907, 29, 65, "Input"],
Cell[30033, 977, 30, 0, 27, "Input"],
Cell[30066, 979, 1180, 36, 83, "Input"],
Cell[31249, 1017, 567, 17, 59, "Input"],
Cell[31819, 1036, 972, 28, 51, "Input",
 InitializationCell->True],
Cell[32794, 1066, 1023, 30, 68, "Input",
 InitializationCell->True],
Cell[33820, 1098, 26, 0, 27, "Input"],
Cell[CellGroupData[{
Cell[33871, 1102, 719, 18, 58, "Input"],
Cell[34593, 1122, 142, 2, 27, "Output"]
}, Open  ]],
Cell[34750, 1127, 1290, 38, 67, "Input"],
Cell[CellGroupData[{
Cell[36065, 1169, 1032, 28, 73, "Input"],
Cell[37100, 1199, 489, 8, 56, "Message"],
Cell[37592, 1209, 489, 8, 56, "Message"],
Cell[38084, 1219, 489, 8, 56, "Message"],
Cell[38576, 1229, 346, 7, 20, "Message"],
Cell[38925, 1238, 5699, 315, 186, 3946, 283, "GraphicsData", "PostScript", \
"Graphics"],
Cell[44627, 1555, 134, 4, 27, "Output"]
}, Open  ]],
Cell[44776, 1562, 110, 2, 43, "Input"],
Cell[44889, 1566, 1295, 40, 50, InheritFromParent],
Cell[46187, 1608, 109, 2, 43, "Input"],
Cell[46299, 1612, 3816, 120, 88, InheritFromParent],
Cell[50118, 1734, 99, 2, 43, "Input"],
Cell[50220, 1738, 1789, 56, 67, InheritFromParent],
Cell[52012, 1796, 103, 2, 43, "Input"],
Cell[52118, 1800, 1422, 47, 41, InheritFromParent],
Cell[53543, 1849, 118, 2, 43, "Input"],
Cell[53664, 1853, 4215, 137, 74, InheritFromParent],
Cell[57882, 1992, 113, 2, 43, "Input"],
Cell[57998, 1996, 1021, 34, 42, InheritFromParent],
Cell[59022, 2032, 1098, 35, 41, InheritFromParent],
Cell[60123, 2069, 101, 2, 43, "Input"],
Cell[60227, 2073, 2292, 73, 89, InheritFromParent],
Cell[62522, 2148, 4058, 129, 128, InheritFromParent],
Cell[66583, 2279, 1776, 61, 42, InheritFromParent],
Cell[68362, 2342, 114, 2, 43, "Input"],
Cell[68479, 2346, 2908, 66, 298, "Input"],
Cell[71390, 2414, 958, 29, 58, "Input"],
Cell[72351, 2445, 890, 26, 58, "Input"],
Cell[73244, 2473, 890, 26, 58, "Input"],
Cell[74137, 2501, 992, 30, 58, "Input"],
Cell[75132, 2533, 984, 29, 58, "Input"],
Cell[CellGroupData[{
Cell[76141, 2566, 1573, 37, 118, "Input"],
Cell[77717, 2605, 682, 16, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78436, 2626, 262, 7, 27, "Input"],
Cell[78701, 2635, 9249, 291, 265, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87987, 2931, 218, 5, 53, "Input"],
Cell[88208, 2938, 129, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88374, 2945, 79, 2, 27, "Input"],
Cell[88456, 2949, 141, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88634, 2956, 392, 8, 43, "Input"],
Cell[89029, 2966, 126, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89192, 2973, 140, 4, 39, "Input"],
Cell[89335, 2979, 127, 2, 27, "Output"]
}, Open  ]],
Cell[89477, 2984, 282, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[89784, 2995, 180, 6, 27, "Input"],
Cell[89967, 3003, 46, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90050, 3008, 57, 1, 27, "Input"],
Cell[90110, 3011, 46, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90193, 3016, 130, 4, 27, "Input"],
Cell[90326, 3022, 46, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90409, 3027, 211, 7, 27, "Input"],
Cell[90623, 3036, 137, 3, 27, "Output"]
}, Open  ]],
Cell[90775, 3042, 396, 10, 43, "Input"],
Cell[91174, 3054, 1018, 35, 44, InheritFromParent],
Cell[92195, 3091, 1018, 35, 44, InheritFromParent],
Cell[93216, 3128, 1425, 46, 68, InheritFromParent],
Cell[94644, 3176, 1425, 46, 68, InheritFromParent],
Cell[96072, 3224, 1514, 50, 68, InheritFromParent],
Cell[97589, 3276, 165, 3, 43, "Input"],
Cell[97757, 3281, 369, 11, 46, "Input"],
Cell[98129, 3294, 336, 10, 43, "Input"],
Cell[98468, 3306, 1771, 52, 122, "Input"],
Cell[100242, 3360, 5354, 148, 420, "Input",
 InitializationCell->True],
Cell[105599, 3510, 167, 4, 43, "Input"],
Cell[105769, 3516, 4838, 130, 159, "Input"],
Cell[110610, 3648, 247, 7, 27, "Input"],
Cell[CellGroupData[{
Cell[110882, 3659, 1091, 30, 50, "Input"],
Cell[111976, 3691, 252, 6, 53, "Output"]
}, Open  ]],
Cell[112243, 3700, 145, 2, 43, "Input"],
Cell[112391, 3704, 7117, 180, 350, "Input",
 InitializationCell->True],
Cell[119511, 3886, 2868, 75, 109, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[122404, 3965, 1615, 33, 103, "Input"],
Cell[124022, 4000, 46, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124105, 4005, 1628, 33, 103, "Input"],
Cell[125736, 4040, 63, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125836, 4046, 1848, 52, 73, "Input"],
Cell[127687, 4100, 301, 6, 53, "Output"]
}, Open  ]],
Cell[128003, 4109, 7661, 200, 221, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[135689, 4313, 843, 26, 58, "Input"],
Cell[136535, 4341, 4137, 116, 136, "Output"]
}, Open  ]],
Cell[140687, 4460, 6092, 157, 245, "Input",
 InitializationCell->True],
Cell[146782, 4619, 1043, 29, 104, "Input"],
Cell[CellGroupData[{
Cell[147850, 4652, 1353, 41, 60, "Input"],
Cell[149206, 4695, 1084, 34, 59, "Output"]
}, Open  ]],
Cell[150305, 4732, 1644, 47, 90, "Input",
 InitializationCell->True],
Cell[151952, 4781, 3376, 96, 101, "Input",
 InitializationCell->True],
Cell[155331, 4879, 91, 1, 43, "Input"],
Cell[155425, 4882, 306, 7, 43, "Input"],
Cell[155734, 4891, 31548, 703, 1481, "Input",
 InitializationCell->True],
Cell[187285, 5596, 124, 3, 27, "Input",
 InitializationCell->True],
Cell[187412, 5601, 192, 3, 43, "Input"],
Cell[187607, 5606, 7101, 156, 400, "Input",
 InitializationCell->True],
Cell[194711, 5764, 998, 20, 58, "Input",
 InitializationCell->True],
Cell[195712, 5786, 2700, 62, 103, "Input",
 InitializationCell->True],
Cell[198415, 5850, 225, 6, 43, "Input"],
Cell[198643, 5858, 1353, 27, 58, "Input",
 InitializationCell->True],
Cell[199999, 5887, 206, 4, 43, "Input"],
Cell[200208, 5893, 417, 14, 29, "Input"],
Cell[200628, 5909, 1165, 26, 73, "Input",
 InitializationCell->True],
Cell[201796, 5937, 1208, 26, 87, "Input",
 InitializationCell->True],
Cell[203007, 5965, 99, 2, 43, "Input"],
Cell[203109, 5969, 1086, 29, 58, "Input",
 InitializationCell->True],
Cell[204198, 6000, 96, 2, 43, "Input"],
Cell[CellGroupData[{
Cell[204319, 6006, 2236, 44, 313, "Input",
 InitializationCell->True],
Cell[206558, 6052, 324, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206919, 6063, 2221, 43, 313, "Input"],
Cell[209143, 6108, 114, 3, 27, "Output"]
}, Open  ]],
Cell[209272, 6114, 65, 1, 43, "Input"],
Cell[CellGroupData[{
Cell[209362, 6119, 6074, 153, 223, "Input"],
Cell[CellGroupData[{
Cell[215461, 6276, 304, 6, 20, "Print"],
Cell[215768, 6284, 553, 12, 20, "Print"],
Cell[216324, 6298, 499, 11, 20, "Print"],
Cell[216826, 6311, 2099, 38, 66, "Print"]
}, Open  ]],
Cell[218940, 6352, 2329, 47, 135, "Output"]
}, Open  ]],
Cell[221284, 6402, 180, 3, 43, "Input"],
Cell[221467, 6407, 102, 3, 27, "Input"],
Cell[221572, 6412, 6149, 140, 425, "Input",
 InitializationCell->True],
Cell[227724, 6554, 1821, 41, 100, "Input",
 InitializationCell->True],
Cell[229548, 6597, 2205, 48, 121, "Input",
 InitializationCell->True],
Cell[231756, 6647, 2658, 56, 136, "Input",
 InitializationCell->True],
Cell[234417, 6705, 2205, 48, 121, "Input",
 InitializationCell->True],
Cell[236625, 6755, 2335, 51, 136, "Input",
 InitializationCell->True],
Cell[238963, 6808, 3386, 75, 214, "Input",
 InitializationCell->True],
Cell[242352, 6885, 3537, 68, 178, "Input",
 InitializationCell->True],
Cell[245892, 6955, 107, 3, 27, "Input"],
Cell[246002, 6960, 4026, 85, 271, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[250053, 7049, 2557, 49, 328, "Input"],
Cell[252613, 7100, 149, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252799, 7109, 6322, 156, 238, "Input"],
Cell[CellGroupData[{
Cell[259146, 7269, 308, 6, 20, "Print"],
Cell[259457, 7277, 558, 12, 20, "Print"],
Cell[260018, 7291, 1106, 22, 26, "Print"],
Cell[261127, 7315, 504, 11, 20, "Print"],
Cell[261634, 7328, 2102, 38, 66, "Print"]
}, Open  ]],
Cell[263751, 7369, 1202, 23, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264990, 7397, 6322, 156, 238, "Input"],
Cell[CellGroupData[{
Cell[271337, 7557, 252, 5, 20, "Print"],
Cell[271592, 7564, 501, 11, 20, "Print"],
Cell[272096, 7577, 1049, 21, 26, "Print"],
Cell[273148, 7600, 445, 10, 20, "Print"],
Cell[273596, 7612, 2048, 37, 66, "Print"]
}, Open  ]],
Cell[275659, 7652, 1166, 23, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276862, 7680, 12101, 298, 418, "Input"],
Cell[CellGroupData[{
Cell[288988, 7982, 253, 5, 20, "Print"],
Cell[289244, 7989, 501, 11, 20, "Print"],
Cell[289748, 8002, 506, 11, 20, "Print"],
Cell[290257, 8015, 507, 11, 20, "Print"]
}, Open  ]],
Cell[290779, 8029, 5018, 98, 139, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[295834, 8132, 7170, 153, 523, "Input"],
Cell[CellGroupData[{
Cell[303029, 8289, 229, 5, 20, "Print"],
Cell[303261, 8296, 479, 11, 20, "Print"],
Cell[303743, 8309, 1120, 23, 80, "Print"],
Cell[304866, 8334, 1072, 22, 246, "Print"],
Cell[305941, 8358, 287, 6, 20, "Print"],
Cell[306231, 8366, 248, 6, 20, "Print"],
Cell[306482, 8374, 247, 6, 20, "Print"],
Cell[306732, 8382, 496, 12, 26, "Print"]
}, Open  ]],
Cell[307243, 8397, 138, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307418, 8405, 3710, 86, 195, "Input"],
Cell[311131, 8493, 17897, 313, 113, "Output"]
}, Open  ]],
Cell[329043, 8809, 12300, 297, 418, "Input"],
Cell[341346, 9108, 21362, 510, 703, "Input"],
Cell[CellGroupData[{
Cell[362733, 9622, 108, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[362866, 9628, 231, 5, 20, "Print"],
Cell[363100, 9635, 477, 11, 20, "Print"],
Cell[363580, 9648, 487, 11, 20, "Print"],
Cell[364070, 9661, 481, 11, 20, "Print"]
}, Open  ]],
Cell[364566, 9675, 4754, 93, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369357, 9773, 108, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[369490, 9779, 231, 5, 20, "Print"],
Cell[369724, 9786, 477, 11, 20, "Print"],
Cell[370204, 9799, 487, 11, 20, "Print"],
Cell[370694, 9812, 481, 11, 20, "Print"]
}, Open  ]],
Cell[371190, 9826, 4743, 93, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375970, 9924, 111, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[376106, 9930, 231, 5, 20, "Print"],
Cell[376340, 9937, 477, 11, 20, "Print"],
Cell[376820, 9950, 487, 11, 20, "Print"],
Cell[377310, 9963, 481, 11, 20, "Print"]
}, Open  ]],
Cell[377806, 9977, 4727, 93, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382570, 10075, 109, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[382704, 10081, 231, 5, 20, "Print"],
Cell[382938, 10088, 477, 11, 20, "Print"],
Cell[383418, 10101, 487, 11, 20, "Print"],
Cell[383908, 10114, 481, 11, 20, "Print"]
}, Open  ]],
Cell[384404, 10128, 4690, 93, 259, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389131, 10226, 109, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[389265, 10232, 231, 5, 20, "Print"],
Cell[389499, 10239, 477, 11, 20, "Print"],
Cell[389979, 10252, 487, 11, 20, "Print"],
Cell[390469, 10265, 481, 11, 20, "Print"]
}, Open  ]],
Cell[390965, 10279, 4634, 93, 259, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
